parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"FRly":[function(require,module,exports) {
"use strict";exports.byteLength=u,exports.toByteArray=i,exports.fromByteArray=d;for(var r=[],t=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=n.length;o<a;++o)r[o]=n[o],t[n.charCodeAt(o)]=o;function h(r){var t=r.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=r.indexOf("=");return-1===e&&(e=t),[e,e===t?0:4-e%4]}function u(r){var t=h(r),e=t[0],n=t[1];return 3*(e+n)/4-n}function c(r,t,e){return 3*(t+e)/4-e}function i(r){var n,o,a=h(r),u=a[0],i=a[1],f=new e(c(r,u,i)),A=0,d=i>0?u-4:u;for(o=0;o<d;o+=4)n=t[r.charCodeAt(o)]<<18|t[r.charCodeAt(o+1)]<<12|t[r.charCodeAt(o+2)]<<6|t[r.charCodeAt(o+3)],f[A++]=n>>16&255,f[A++]=n>>8&255,f[A++]=255&n;return 2===i&&(n=t[r.charCodeAt(o)]<<2|t[r.charCodeAt(o+1)]>>4,f[A++]=255&n),1===i&&(n=t[r.charCodeAt(o)]<<10|t[r.charCodeAt(o+1)]<<4|t[r.charCodeAt(o+2)]>>2,f[A++]=n>>8&255,f[A++]=255&n),f}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function A(r,t,e){for(var n,o=[],a=t;a<e;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(255&r[a+2]),o.push(f(n));return o.join("")}function d(t){for(var e,n=t.length,o=n%3,a=[],h=0,u=n-o;h<u;h+=16383)a.push(A(t,h,h+16383>u?u:h+16383));return 1===o?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),a.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;
},{}],"Quj6":[function(require,module,exports) {
exports.read=function(a,o,t,r,h){var M,p,w=8*h-r-1,f=(1<<w)-1,e=f>>1,i=-7,N=t?h-1:0,n=t?-1:1,s=a[o+N];for(N+=n,M=s&(1<<-i)-1,s>>=-i,i+=w;i>0;M=256*M+a[o+N],N+=n,i-=8);for(p=M&(1<<-i)-1,M>>=-i,i+=r;i>0;p=256*p+a[o+N],N+=n,i-=8);if(0===M)M=1-e;else{if(M===f)return p?NaN:1/0*(s?-1:1);p+=Math.pow(2,r),M-=e}return(s?-1:1)*p*Math.pow(2,M-r)},exports.write=function(a,o,t,r,h,M){var p,w,f,e=8*M-h-1,i=(1<<e)-1,N=i>>1,n=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,s=r?0:M-1,u=r?1:-1,l=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,p=i):(p=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-p))<1&&(p--,f*=2),(o+=p+N>=1?n/f:n*Math.pow(2,1-N))*f>=2&&(p++,f/=2),p+N>=i?(w=0,p=i):p+N>=1?(w=(o*f-1)*Math.pow(2,h),p+=N):(w=o*Math.pow(2,N-1)*Math.pow(2,h),p=0));h>=8;a[t+s]=255&w,s+=u,w/=256,h-=8);for(p=p<<h|w,e+=h;e>0;a[t+s]=255&p,s+=u,p/=256,e-=8);a[t+s-u]|=128*l};
},{}],"aqZJ":[function(require,module,exports) {
var r={}.toString;module.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)};
},{}],"aMB2":[function(require,module,exports) {

var global = arguments[3];
var t=arguments[3],r=require("base64-js"),e=require("ieee754"),n=require("isarray");function i(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(r){return!1}}function o(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,r){if(o()<r)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=f.prototype:(null===t&&(t=new f(r)),t.length=r),t}function f(t,r,e){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return c(this,t)}return s(this,t,r,e)}function s(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?g(t,r,e,n):"string"==typeof r?l(t,r,e):y(t,r)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function a(t,r,e,n){return h(r),r<=0?u(t,r):void 0!==e?"string"==typeof n?u(t,r).fill(e,n):u(t,r).fill(e):u(t,r)}function c(t,r){if(h(r),t=u(t,r<0?0:0|w(r)),!f.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t}function l(t,r,e){if("string"==typeof e&&""!==e||(e="utf8"),!f.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(r,e),i=(t=u(t,n)).write(r,e);return i!==n&&(t=t.slice(0,i)),t}function p(t,r){var e=r.length<0?0:0|w(r.length);t=u(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t}function g(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");return r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n),f.TYPED_ARRAY_SUPPORT?(t=r).__proto__=f.prototype:t=p(t,r),t}function y(t,r){if(f.isBuffer(r)){var e=0|w(r.length);return 0===(t=u(t,e)).length?t:(r.copy(t,0,0,e),t)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||W(r.length)?u(t,0):p(t,r);if("Buffer"===r.type&&n(r.data))return p(t,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function w(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function d(t){return+t!=t&&(t=0),f.alloc(+t)}function v(t,r){if(f.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return $(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return K(t).length;default:if(n)return $(t).length;r=(""+r).toLowerCase(),n=!0}}function E(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return x(this,r,e);case"utf8":case"utf-8":return Y(this,r,e);case"ascii":return L(this,r,e);case"latin1":case"binary":return D(this,r,e);case"base64":return S(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,r,e){var n=t[r];t[r]=t[e],t[e]=n}function R(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1}else if(e<0){if(!i)return-1;e=0}if("string"==typeof r&&(r=f.from(r,n)),f.isBuffer(r))return 0===r.length?-1:_(t,r,e,n,i);if("number"==typeof r)return r&=255,f.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):_(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer")}function _(t,r,e,n,i){var o,u=1,f=t.length,s=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;u=2,f/=2,s/=2,e/=2}function h(t,r){return 1===u?t[r]:t.readUInt16BE(r*u)}if(i){var a=-1;for(o=e;o<f;o++)if(h(t,o)===h(r,-1===a?0:o-a)){if(-1===a&&(a=o),o-a+1===s)return a*u}else-1!==a&&(o-=o-a),a=-1}else for(e+s>f&&(e=f-s),o=e;o>=0;o--){for(var c=!0,l=0;l<s;l++)if(h(t,o+l)!==h(r,l)){c=!1;break}if(c)return o}return-1}function A(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var u=0;u<n;++u){var f=parseInt(r.substr(2*u,2),16);if(isNaN(f))return u;t[e+u]=f}return u}function m(t,r,e,n){return Q($(r,t.length-e),t,e,n)}function P(t,r,e,n){return Q(G(r),t,e,n)}function T(t,r,e,n){return P(t,r,e,n)}function B(t,r,e,n){return Q(K(r),t,e,n)}function U(t,r,e,n){return Q(H(r,t.length-e),t,e,n)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function Y(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,u,f,s,h=t[i],a=null,c=h>239?4:h>223?3:h>191?2:1;if(i+c<=e)switch(c){case 1:h<128&&(a=h);break;case 2:128==(192&(o=t[i+1]))&&(s=(31&h)<<6|63&o)>127&&(a=s);break;case 3:o=t[i+1],u=t[i+2],128==(192&o)&&128==(192&u)&&(s=(15&h)<<12|(63&o)<<6|63&u)>2047&&(s<55296||s>57343)&&(a=s);break;case 4:o=t[i+1],u=t[i+2],f=t[i+3],128==(192&o)&&128==(192&u)&&128==(192&f)&&(s=(15&h)<<18|(63&o)<<12|(63&u)<<6|63&f)>65535&&s<1114112&&(a=s)}null===a?(a=65533,c=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=c}return O(n)}exports.Buffer=f,exports.SlowBuffer=d,exports.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:i(),exports.kMaxLength=o(),f.poolSize=8192,f._augment=function(t){return t.__proto__=f.prototype,t},f.from=function(t,r,e){return s(null,t,r,e)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(t,r,e){return a(null,t,r,e)},f.allocUnsafe=function(t){return c(null,t)},f.allocUnsafeSlow=function(t){return c(null,t)},f.isBuffer=function(t){return!(null==t||!t._isBuffer)},f.compare=function(t,r){if(!f.isBuffer(t)||!f.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break}return e<n?-1:n<e?1:0},f.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(t,r){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return f.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var i=f.allocUnsafe(r),o=0;for(e=0;e<t.length;++e){var u=t[e];if(!f.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,o),o+=u.length}return i},f.byteLength=v,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)b(this,r,r+1);return this},f.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)b(this,r,r+3),b(this,r+1,r+2);return this},f.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)b(this,r,r+7),b(this,r+1,r+6),b(this,r+2,r+5),b(this,r+3,r+4);return this},f.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Y(this,0,t):E.apply(this,arguments)},f.prototype.equals=function(t){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===f.compare(this,t)},f.prototype.inspect=function(){var t="",r=exports.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},f.prototype.compare=function(t,r,e,n,i){if(!f.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),u=(e>>>=0)-(r>>>=0),s=Math.min(o,u),h=this.slice(n,i),a=t.slice(r,e),c=0;c<s;++c)if(h[c]!==a[c]){o=h[c],u=a[c];break}return o<u?-1:u<o?1:0},f.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e)},f.prototype.indexOf=function(t,r,e){return R(this,t,r,e,!0)},f.prototype.lastIndexOf=function(t,r,e){return R(this,t,r,e,!1)},f.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0)}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,t,r,e);case"utf8":case"utf-8":return m(this,t,r,e);case"ascii":return P(this,t,r,e);case"latin1":case"binary":return T(this,t,r,e);case"base64":return B(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function O(t){var r=t.length;if(r<=I)return String.fromCharCode.apply(String,t);for(var e="",n=0;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=I));return e}function L(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n}function D(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n}function x(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=Z(t[o]);return i}function C(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function M(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length")}function k(t,r,e,n,i,o){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range")}function N(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function z(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255}function F(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function j(t,r,n,i,o){return o||F(t,r,n,4,3.4028234663852886e38,-3.4028234663852886e38),e.write(t,r,n,i,23,4),n+4}function q(t,r,n,i,o){return o||F(t,r,n,8,1.7976931348623157e308,-1.7976931348623157e308),e.write(t,r,n,i,52,8),n+8}f.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),f.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=f.prototype;else{var i=r-t;e=new f(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t]}return e},f.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n},f.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n},f.prototype.readUInt8=function(t,r){return r||M(t,1,this.length),this[t]},f.prototype.readUInt16LE=function(t,r){return r||M(t,2,this.length),this[t]|this[t+1]<<8},f.prototype.readUInt16BE=function(t,r){return r||M(t,2,this.length),this[t]<<8|this[t+1]},f.prototype.readUInt32LE=function(t,r){return r||M(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},f.prototype.readUInt32BE=function(t,r){return r||M(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},f.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n},f.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||M(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o},f.prototype.readInt8=function(t,r){return r||M(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},f.prototype.readInt16LE=function(t,r){r||M(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt16BE=function(t,r){r||M(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e},f.prototype.readInt32LE=function(t,r){return r||M(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},f.prototype.readInt32BE=function(t,r){return r||M(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},f.prototype.readFloatLE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!0,23,4)},f.prototype.readFloatBE=function(t,r){return r||M(t,4,this.length),e.read(this,t,!1,23,4)},f.prototype.readDoubleLE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!0,52,8)},f.prototype.readDoubleBE=function(t,r){return r||M(t,8,this.length),e.read(this,t,!1,52,8)},f.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e},f.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||k(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e},f.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,255,0),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1},f.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):z(this,t,r,!0),r+4},f.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=0,u=1,f=0;for(this[r]=255&t;++o<e&&(u*=256);)t<0&&0===f&&0!==this[r+o-1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);k(this,t,r,e,i-1,-i)}var o=e-1,u=1,f=0;for(this[r+o]=255&t;--o>=0&&(u*=256);)t<0&&0===f&&0!==this[r+o+1]&&(f=1),this[r+o]=(t/u>>0)-f&255;return r+e},f.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,1,127,-128),f.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1},f.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):N(this,t,r,!0),r+2},f.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):N(this,t,r,!1),r+2},f.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):z(this,t,r,!0),r+4},f.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||k(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),f.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):z(this,t,r,!1),r+4},f.prototype.writeFloatLE=function(t,r,e){return j(this,t,r,!0,e)},f.prototype.writeFloatBE=function(t,r,e){return j(this,t,r,!1,e)},f.prototype.writeDoubleLE=function(t,r,e){return q(this,t,r,!0,e)},f.prototype.writeDoubleBE=function(t,r,e){return q(this,t,r,!1,e)},f.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!f.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o},f.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var u=f.isBuffer(t)?t:$(new f(t,n).toString()),s=u.length;for(o=0;o<e-r;++o)this[o+r]=u[o%s]}return this};var V=/[^+\/0-9A-Za-z-_]/g;function X(t){if((t=J(t).replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function J(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function Z(t){return t<16?"0"+t.toString(16):t.toString(16)}function $(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],u=0;u<n;++u){if((e=t.charCodeAt(u))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue}if(u+1===n){(r-=3)>-1&&o.push(239,191,189);continue}i=e;continue}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue}e=65536+(i-55296<<10|e-56320)}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e)}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128)}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return o}function G(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}function H(t,r){for(var e,n,i,o=[],u=0;u<t.length&&!((r-=2)<0);++u)n=(e=t.charCodeAt(u))>>8,i=e%256,o.push(i),o.push(n);return o}function K(t){return r.toByteArray(X(t))}function Q(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i}function W(t){return t!=t}
},{"base64-js":"FRly","ieee754":"Quj6","isarray":"aqZJ","buffer":"aMB2"}],"gvqF":[function(require,module,exports) {
var define;
var global = arguments[3];
var Buffer = require("buffer").Buffer;
var e,t=arguments[3],n=require("buffer").Buffer;function r(){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=i(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}}).apply(this,arguments)}function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}function a(){"use strict";a=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(O){u=function(e,t,n){return e[t]=n}}function d(e,t,n,i){var a=t&&t.prototype instanceof f?t:f,o=Object.create(a.prototype),s=new E(i||[]);return r(o,"_invoke",{value:w(e,n,s)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(O){return{type:"throw",arg:O}}}e.wrap=d;var p={};function f(){}function h(){}function v(){}var m={};u(m,o,function(){return this});var g=Object.getPrototypeOf,b=g&&g(g(x([])));b&&b!==t&&n.call(b,o)&&(m=b);var k=v.prototype=f.prototype=Object.create(m);function y(e){["next","throw","return"].forEach(function(t){u(e,t,function(e){return this._invoke(t,e)})})}function S(e,t){var i;r(this,"_invoke",{value:function(r,a){function o(){return new t(function(i,o){!function r(i,a,o,s){var c=l(e[i],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==L(d)&&n.call(d,"__await")?t.resolve(d.__await).then(function(e){r("next",e,o,s)},function(e){r("throw",e,o,s)}):t.resolve(d).then(function(e){u.value=e,o(u)},function(e){return r("throw",e,o,s)})}s(c.arg)}(r,a,i,o)})}return i=i?i.then(o,o):o()}})}function w(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return R()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=C(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function C(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var i=l(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function x(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:R}}function R(){return{value:void 0,done:!0}}return h.prototype=v,r(k,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:h,configurable:!0}),h.displayName=u(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},y(S.prototype),u(S.prototype,s,function(){return this}),e.AsyncIterator=S,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new S(d(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},y(k),u(k,c,"Generator"),u(k,o,function(){return this}),u(k,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=x,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),P(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function o(e,t){return u(e)||c(e,t)||A(e,t)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}function u(e){if(Array.isArray(e))return e}function d(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){d(a,r,i,o,s,"next",e)}function s(e){d(a,r,i,o,s,"throw",e)}o(void 0)})}}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}function f(e){var t=b();return function(){var n,r=S(e);if(t){var i=S(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){var t="function"==typeof Map?new Map:void 0;return(m=function(e){if(null===e||!k(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return g(e,arguments,S(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)})(e)}function g(e,t,n){return(g=b()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&y(i,n.prototype),i}).apply(null,arguments)}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function k(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){return E(e)||P(e)||A(e)||T()}function T(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function E(e){if(Array.isArray(e))return U(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function O(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function N(e){var t=I(e,"string");return"symbol"===L(t)?t:String(t)}function I(e,t){if("object"!==L(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=A(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function A(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.VideoQuality=exports.VideoPresets43=exports.VideoPresets=exports.VideoPreset=exports.UnsupportedServer=exports.UnexpectedConnectionState=exports.TrackPublication=exports.TrackInvalidError=exports.TrackEvent=exports.Track=exports.ScreenSharePresets=exports.RoomState=exports.RoomEvent=exports.Room=exports.RemoteVideoTrack=exports.RemoteTrackPublication=exports.RemoteTrack=exports.RemoteParticipant=exports.RemoteAudioTrack=exports.PublishDataError=exports.ParticipantEvent=exports.Participant=exports.NegotiationError=exports.MediaDeviceFailure=exports.LogLevel=exports.LocalVideoTrack=exports.LocalTrackPublication=exports.LocalTrack=exports.LocalParticipant=exports.LocalAudioTrack=exports.LivekitError=exports.EngineEvent=exports.DisconnectReason=exports.DefaultReconnectPolicy=exports.DataPacket_Kind=exports.ConnectionState=exports.ConnectionQuality=exports.ConnectionError=exports.ConnectionCheck=exports.AudioPresets=void 0,exports.attachToElement=rs,exports.createLocalAudioTrack=zc,exports.createLocalScreenTracks=Zc,exports.createLocalTracks=qc,exports.createLocalVideoTrack=Gc,exports.detachTrack=is,exports.getEmptyAudioStreamTrack=Ro,exports.getEmptyVideoStreamTrack=xo,exports.isBackupCodec=Is,exports.isBrowserSupported=po,exports.protocolVersion=void 0,exports.setLogExtension=V,exports.setLogLevel=F,exports.supportsAV1=so,exports.supportsAdaptiveStream=ao,exports.supportsDynacast=oo,exports.version=void 0;var M="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function j(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var B,J={exports:{}};!function(e){var t,n;t=M,n=function(){var e=function(){},t="undefined",n=("undefined"==typeof window?"undefined":L(window))!==t&&L(window.navigator)!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function i(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(r){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(t,n){for(var i=0;i<r.length;i++){var a=r[i];this[a]=i<t?e:this.methodFactory(a,t,n)}this.log=this.debug}function s(r,s,c){return function(r){return"debug"===r&&(r="log"),("undefined"==typeof console?"undefined":L(console))!==t&&("trace"===r&&n?a:void 0!==console[r]?i(console,r):void 0!==console.log?i(console,"log"):e)}(r)||function(e,n,r){return function(){("undefined"==typeof console?"undefined":L(console))!==t&&(o.call(this,n,r),this[e].apply(this,arguments))}}.apply(this,arguments)}function c(e,n,i){var a,c=this;n=null==n?"WARN":n;var u="loglevel";function d(){var e;if(("undefined"==typeof window?"undefined":L(window))!==t&&u){try{e=window.localStorage[u]}catch(i){}if(L(e)===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(i){}return void 0===c.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"===L(e)&&(u=void 0),c.name=e,c.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},c.methodFactory=i||s,c.getLevel=function(){return a},c.setLevel=function(n,i){if("string"==typeof n&&void 0!==c.levels[n.toUpperCase()]&&(n=c.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=c.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(a=n,!1!==i&&function(e){var n=(r[e]||"silent").toUpperCase();if(("undefined"==typeof window?"undefined":L(window))!==t&&u){try{return void(window.localStorage[u]=n)}catch(i){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(i){}}}(n),o.call(c,n,e),("undefined"==typeof console?"undefined":L(console))===t&&n<c.levels.SILENT)return"No console available for logging"},c.setDefaultLevel=function(e){n=e,d()||c.setLevel(e,!1)},c.resetLevel=function(){c.setLevel(n,!1),function(){if(("undefined"==typeof window?"undefined":L(window))!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},c.enableAll=function(e){c.setLevel(c.levels.TRACE,e)},c.disableAll=function(e){c.setLevel(c.levels.SILENT,e)};var l=d();null==l&&(l=n),c.setLevel(l,!1)}var u=new c,d={};u.getLogger=function(e){if("symbol"!==L(e)&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new c(e,u.getLevel(),u.methodFactory)),t};var l=("undefined"==typeof window?"undefined":L(window))!==t?window.log:void 0;return u.noConflict=function(){return("undefined"==typeof window?"undefined":L(window))!==t&&window.log===u&&(window.log=l),u},u.getLoggers=function(){return d},u.default=u,u},e.exports?e.exports=n():t.log=n()}(J),exports.LogLevel=B,function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(B||(exports.LogLevel=B={}));var $=J.exports.getLogger("livekit");function F(e){$.setLevel(e)}function V(e){var t=$.methodFactory;$.methodFactory=function(n,r,i){var a=t(n,r,i),o=$.getLevel(),s=r>=o&&r<B.silent;return function(t,n){n?a(t,n):a(t),s&&e(r,t,n)}},$.setLevel($.getLevel())}$.setLevel(B.info);var q=G,W=null;try{W=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(ou){}function G(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function Q(e){return!0===(e&&e.__isLong__)}G.prototype.__isLong__,Object.defineProperty(G.prototype,"__isLong__",{value:!0}),G.isLong=Q;var z={},H={};function Z(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=H[e])?r:(n=Y(e,(0|e)<0?-1:0,!0),i&&(H[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=z[e])?r:(n=Y(e,e<0?-1:0,!1),i&&(z[e]=n),n)}function K(e,t){if(isNaN(e))return t?ue:ce;if(t){if(e<0)return ue;if(e>=ae)return he}else{if(e<=-oe)return ve;if(e+1>=oe)return fe}return e<0?K(-e,t).neg():Y(e%ie|0,e/ie|0,t)}function Y(e,t,n){return new G(e,t,n)}G.fromInt=Z,G.fromNumber=K,G.fromBits=Y;var X=Math.pow;function ee(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return ce;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return ee(e.substring(1),t,n).neg();for(var i=K(X(n,8)),a=ce,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),c=parseInt(e.substring(o,o+s),n);if(s<8){var u=K(X(n,s));a=a.mul(u).add(K(c))}else a=(a=a.mul(i)).add(K(c))}return a.unsigned=t,a}function te(e,t){return"number"==typeof e?K(e,t):"string"==typeof e?ee(e,t):Y(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}G.fromString=ee,G.fromValue=te;var ne=65536,re=1<<24,ie=ne*ne,ae=ie*ie,oe=ae/2,se=Z(re),ce=Z(0);G.ZERO=ce;var ue=Z(0,!0);G.UZERO=ue;var de=Z(1);G.ONE=de;var le=Z(1,!0);G.UONE=le;var pe=Z(-1);G.NEG_ONE=pe;var fe=Y(-1,2147483647,!1);G.MAX_VALUE=fe;var he=Y(-1,-1,!0);G.MAX_UNSIGNED_VALUE=he;var ve=Y(0,-2147483648,!1);G.MIN_VALUE=ve;var me=G.prototype;me.toInt=function(){return this.unsigned?this.low>>>0:this.low},me.toNumber=function(){return this.unsigned?(this.high>>>0)*ie+(this.low>>>0):this.high*ie+(this.low>>>0)},me.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(ve)){var t=K(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=K(X(e,6),this.unsigned),a=this,o="";;){var s=a.div(i),c=(a.sub(s.mul(i)).toInt()>>>0).toString(e);if((a=s).isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},me.getHighBits=function(){return this.high},me.getHighBitsUnsigned=function(){return this.high>>>0},me.getLowBits=function(){return this.low},me.getLowBitsUnsigned=function(){return this.low>>>0},me.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ve)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},me.isZero=function(){return 0===this.high&&0===this.low},me.eqz=me.isZero,me.isNegative=function(){return!this.unsigned&&this.high<0},me.isPositive=function(){return this.unsigned||this.high>=0},me.isOdd=function(){return 1==(1&this.low)},me.isEven=function(){return 0==(1&this.low)},me.equals=function(e){return Q(e)||(e=te(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},me.eq=me.equals,me.notEquals=function(e){return!this.eq(e)},me.neq=me.notEquals,me.ne=me.notEquals,me.lessThan=function(e){return this.comp(e)<0},me.lt=me.lessThan,me.lessThanOrEqual=function(e){return this.comp(e)<=0},me.lte=me.lessThanOrEqual,me.le=me.lessThanOrEqual,me.greaterThan=function(e){return this.comp(e)>0},me.gt=me.greaterThan,me.greaterThanOrEqual=function(e){return this.comp(e)>=0},me.gte=me.greaterThanOrEqual,me.ge=me.greaterThanOrEqual,me.compare=function(e){if(Q(e)||(e=te(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},me.comp=me.compare,me.negate=function(){return!this.unsigned&&this.eq(ve)?ve:this.not().add(de)},me.neg=me.negate,me.add=function(e){Q(e)||(e=te(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=e.high>>>16,o=65535&e.high,s=e.low>>>16,c=0,u=0,d=0,l=0;return d+=(l+=i+(65535&e.low))>>>16,u+=(d+=r+s)>>>16,c+=(u+=n+o)>>>16,c+=t+a,Y((d&=65535)<<16|(l&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},me.subtract=function(e){return Q(e)||(e=te(e)),this.add(e.neg())},me.sub=me.subtract,me.multiply=function(e){if(this.isZero())return ce;if(Q(e)||(e=te(e)),W)return Y(W.mul(this.low,this.high,e.low,e.high),W.get_high(),this.unsigned);if(e.isZero())return ce;if(this.eq(ve))return e.isOdd()?ve:ce;if(e.eq(ve))return this.isOdd()?ve:ce;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(se)&&e.lt(se))return K(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,a=e.high>>>16,o=65535&e.high,s=e.low>>>16,c=65535&e.low,u=0,d=0,l=0,p=0;return l+=(p+=i*c)>>>16,d+=(l+=r*c)>>>16,l&=65535,d+=(l+=i*s)>>>16,u+=(d+=n*c)>>>16,d&=65535,u+=(d+=r*s)>>>16,d&=65535,u+=(d+=i*o)>>>16,u+=t*c+n*s+r*o+i*a,Y((l&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},me.mul=me.multiply,me.divide=function(e){if(Q(e)||(e=te(e)),e.isZero())throw Error("division by zero");var t,n,r;if(W)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?Y((this.unsigned?W.div_u:W.div_s)(this.low,this.high,e.low,e.high),W.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?ue:ce;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ue;if(e.gt(this.shru(1)))return le;r=ue}else{if(this.eq(ve))return e.eq(de)||e.eq(pe)?ve:e.eq(ve)?de:(t=this.shr(1).div(e).shl(1)).eq(ce)?e.isNegative()?de:pe:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(ve))return this.unsigned?ue:ce;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=ce}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),a=i<=48?1:X(2,i-48),o=K(t),s=o.mul(e);s.isNegative()||s.gt(n);)s=(o=K(t-=a,this.unsigned)).mul(e);o.isZero()&&(o=de),r=r.add(o),n=n.sub(s)}return r},me.div=me.divide,me.modulo=function(e){return Q(e)||(e=te(e)),W?Y((this.unsigned?W.rem_u:W.rem_s)(this.low,this.high,e.low,e.high),W.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},me.mod=me.modulo,me.rem=me.modulo,me.not=function(){return Y(~this.low,~this.high,this.unsigned)},me.and=function(e){return Q(e)||(e=te(e)),Y(this.low&e.low,this.high&e.high,this.unsigned)},me.or=function(e){return Q(e)||(e=te(e)),Y(this.low|e.low,this.high|e.high,this.unsigned)},me.xor=function(e){return Q(e)||(e=te(e)),Y(this.low^e.low,this.high^e.high,this.unsigned)},me.shiftLeft=function(e){return Q(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Y(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Y(0,this.low<<e-32,this.unsigned)},me.shl=me.shiftLeft,me.shiftRight=function(e){return Q(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?Y(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Y(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},me.shr=me.shiftRight,me.shiftRightUnsigned=function(e){if(Q(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?Y(this.low>>>e|t<<32-e,t>>>e,this.unsigned):Y(32===e?t:t>>>e-32,0,this.unsigned)},me.shru=me.shiftRightUnsigned,me.shr_u=me.shiftRightUnsigned,me.toSigned=function(){return this.unsigned?Y(this.low,this.high,!1):this},me.toUnsigned=function(){return this.unsigned?this:Y(this.low,this.high,!0)},me.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},me.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},me.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},G.fromBytes=function(e,t,n){return n?G.fromBytesLE(e,t):G.fromBytesBE(e,t)},G.fromBytesLE=function(e,t){return new G(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},G.fromBytesBE=function(e,t){return new G(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var ge,be,ke={exports:{}},ye={},Se={};function we(){if(be)return ge;return be=1,ge=function(e,t){var n=new Array(arguments.length-1),r=0,i=2,a=!0;for(;i<arguments.length;)n[r++]=arguments[i++];return new Promise(function(i,o){n[r]=function(e){if(a)if(a=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(s){a&&(a=!1,o(s))}})}}var Ce,Te,Pe,Ee,xe,Re,Oe,Ne={};function Ie(){return Ce?Ne:(Ce=1,function(e){var t=Ne;t.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var n=new Array(64),r=new Array(123),i=0;i<64;)r[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;t.encode=function(e,t,r){for(var i,a=null,o=[],s=0,c=0;t<r;){var u=e[t++];switch(c){case 0:o[s++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:o[s++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:o[s++]=n[i|u>>6],o[s++]=n[63&u],c=0}s>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),s=0)}return c&&(o[s++]=n[i],o[s++]=61,1===c&&(o[s++]=61)),a?(s&&a.push(String.fromCharCode.apply(String,o.slice(0,s))),a.join("")):String.fromCharCode.apply(String,o.slice(0,s))};t.decode=function(e,t,n){for(var i,a=n,o=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&o>1)break;if(void 0===(c=r[c]))throw Error("invalid encoding");switch(o){case 0:i=c,o=1;break;case 1:t[n++]=i<<2|(48&c)>>4,i=c,o=2;break;case 2:t[n++]=(15&i)<<4|(60&c)>>2,i=c,o=3;break;case 3:t[n++]=(3&i)<<6|c,o=0}}if(1===o)throw Error("invalid encoding");return n-a},t.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}}(),Ne)}function De(){if(Pe)return Te;function e(){this._listeners={}}return Pe=1,Te=e,e.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},e.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},e.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this},Te}function Ae(){if(xe)return Ee;function e(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function a(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:a,e.writeFloatBE=r?a:i,e.readFloatLE=r?o:s,e.readFloatBE=r?s:o}():function(){function a(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>3.4028234663852886e38)e((i<<31|2139095040)>>>0,n,r);else if(t<1.1754943508222875e-38)e((i<<31|Math.round(t/1.401298464324817e-45))>>>0,n,r);else{var a=Math.floor(Math.log(t)/Math.LN2);e((i<<31|a+127<<23|8388607&Math.round(t*Math.pow(2,-a)*8388608))>>>0,n,r)}}function o(e,t,n){var r=e(t,n),i=2*(r>>31)+1,a=r>>>23&255,o=8388607&r;return 255===a?o?NaN:i*(1/0):0===a?1.401298464324817e-45*i*o:i*Math.pow(2,a-150)*(o+8388608)}e.writeFloatLE=a.bind(null,t),e.writeFloatBE=a.bind(null,n),e.readFloatLE=o.bind(null,r),e.readFloatBE=o.bind(null,i)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function a(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:a,e.writeDoubleBE=r?a:i,e.readDoubleLE=r?o:s,e.readDoubleBE=r?s:o}():function(){function a(e,t,n,r,i,a){var o=r<0?1:0;if(o&&(r=-r),0===r)e(0,i,a+t),e(1/r>0?0:2147483648,i,a+n);else if(isNaN(r))e(0,i,a+t),e(2146959360,i,a+n);else if(r>1.7976931348623157e308)e(0,i,a+t),e((o<<31|2146435072)>>>0,i,a+n);else{var s;if(r<2.2250738585072014e-308)e((s=r/5e-324)>>>0,i,a+t),e((o<<31|s/4294967296)>>>0,i,a+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(s=r*Math.pow(2,-c))>>>0,i,a+t),e((o<<31|c+1023<<20|1048576*s&1048575)>>>0,i,a+n)}}}function o(e,t,n,r,i){var a=e(r,i+t),o=e(r,i+n),s=2*(o>>31)+1,c=o>>>20&2047,u=4294967296*(1048575&o)+a;return 2047===c?u?NaN:s*(1/0):0===c?5e-324*s*u:s*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=a.bind(null,t,0,4),e.writeDoubleBE=a.bind(null,n,4,0),e.readDoubleLE=o.bind(null,r,0,4),e.readDoubleBE=o.bind(null,i,4,0)}(),e}function t(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function n(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function r(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function i(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}return xe=1,Ee=e(e)}function Ue(){if(Oe)return Re;return Oe=1,Re=function(e){try{var t=void 0;if(t&&(t.length||Object.keys(t).length))return t}catch(ou){}return null}}var Le,_e,Me,je,Be,Je,$e={};function Fe(){return Le?$e:(Le=1,(e=$e).length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},e.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,a=[],o=0;t<n;)(r=e[t++])<128?a[o++]=r:r>191&&r<224?a[o++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,a[o++]=55296+(r>>10),a[o++]=56320+(1023&r)):a[o++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),o=0);return i?(o&&i.push(String.fromCharCode.apply(String,a.slice(0,o))),i.join("")):String.fromCharCode.apply(String,a.slice(0,o))},e.write=function(e,t,n){for(var r,i,a=n,o=0;o<e.length;++o)(r=e.charCodeAt(o))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(o+1)))?(r=65536+((1023&r)<<10)+(1023&i),++o,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-a},$e);var e}function Ve(){if(Me)return _e;return Me=1,_e=function(e,t,n){var r=n||8192,i=r>>>1,a=null,o=r;return function(n){if(n<1||n>i)return e(n);o+n>r&&(a=e(r),o=0);var s=t.call(a,o,o+=n);return 7&o&&(o=1+(7|o)),s}}}function qe(){if(Be)return je;Be=1,je=t;var e=We();function t(e,t){this.lo=e>>>0,this.hi=t>>>0}var n=t.zero=new t(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var r=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(e){if(0===e)return n;var r=e<0;r&&(e=-e);var i=e>>>0,a=(e-i)/4294967296>>>0;return r&&(a=~a>>>0,i=~i>>>0,++i>4294967295&&(i=0,++a>4294967295&&(a=0))),new t(i,a)},t.from=function(r){if("number"==typeof r)return t.fromNumber(r);if(e.isString(r)){if(!e.Long)return t.fromNumber(parseInt(r,10));r=e.Long.fromString(r)}return r.low||r.high?new t(r.low>>>0,r.high>>>0):n},t.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},t.prototype.toLong=function(t){return e.Long?new e.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var i=String.prototype.charCodeAt;return t.fromHash=function(e){return e===r?n:new t((i.call(e,0)|i.call(e,1)<<8|i.call(e,2)<<16|i.call(e,3)<<24)>>>0,(i.call(e,4)|i.call(e,5)<<8|i.call(e,6)<<16|i.call(e,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},t.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},t.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10},je}function We(){return Je?Se:(Je=1,function(e){var t=Se;function n(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function r(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}t.asPromise=we(),t.base64=Ie(),t.EventEmitter=De(),t.float=Ae(),t.inquire=Ue(),t.utf8=Fe(),t.pool=Ve(),t.LongBits=qe(),t.isNode=Boolean(void 0!==M&&M&&M.process&&M.process.versions&&M.process.versions.node),t.global=t.isNode&&M||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||M,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.isString=function(e){return"string"==typeof e||e instanceof String},t.isObject=function(e){return e&&"object"===L(e)},t.isset=t.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==L(n)||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},t.Buffer=function(){try{var e=t.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(ou){return null}}(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(e){return"number"==typeof e?t.Buffer?t._Buffer_allocUnsafe(e):new t.Array(e):t.Buffer?t._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},t.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(e){return e?t.LongBits.from(e).toHash():t.LongBits.zeroHash},t.longFromHash=function(e,n){var r=t.LongBits.fromHash(e);return t.Long?t.Long.fromBits(r.lo,r.hi,n):r.toNumber(Boolean(n))},t.merge=n,t.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},t.newError=r,t.ProtocolError=r("ProtocolError"),t.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},t.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var e=t.Buffer;e?(t._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},t._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):t._Buffer_from=t._Buffer_allocUnsafe=null}}(),Se)}var Ge,Qe=tt,ze=We(),He=ze.LongBits,Ze=ze.base64,Ke=ze.utf8;function Ye(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function Xe(){}function et(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function tt(){this.len=0,this.head=new Ye(Xe,0,0),this.tail=this.head,this.states=null}var nt=function(){return ze.Buffer?function(){return(tt.create=function(){return new Ge})()}:function(){return new tt}};function rt(e,t,n){t[n]=255&e}function it(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}function at(e,t){this.len=e,this.next=void 0,this.val=t}function ot(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function st(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}tt.create=nt(),tt.alloc=function(e){return new ze.Array(e)},ze.Array!==Array&&(tt.alloc=ze.pool(tt.alloc,ze.Array.prototype.subarray)),tt.prototype._push=function(e,t,n){return this.tail=this.tail.next=new Ye(e,t,n),this.len+=t,this},at.prototype=Object.create(Ye.prototype),at.prototype.fn=it,tt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new at((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},tt.prototype.int32=function(e){return e<0?this._push(ot,10,He.fromNumber(e)):this.uint32(e)},tt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},tt.prototype.uint64=function(e){var t=He.from(e);return this._push(ot,t.length(),t)},tt.prototype.int64=tt.prototype.uint64,tt.prototype.sint64=function(e){var t=He.from(e).zzEncode();return this._push(ot,t.length(),t)},tt.prototype.bool=function(e){return this._push(rt,1,e?1:0)},tt.prototype.fixed32=function(e){return this._push(st,4,e>>>0)},tt.prototype.sfixed32=tt.prototype.fixed32,tt.prototype.fixed64=function(e){var t=He.from(e);return this._push(st,4,t.lo)._push(st,4,t.hi)},tt.prototype.sfixed64=tt.prototype.fixed64,tt.prototype.float=function(e){return this._push(ze.float.writeFloatLE,4,e)},tt.prototype.double=function(e){return this._push(ze.float.writeDoubleLE,8,e)};var ct=ze.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};tt.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(rt,1,0);if(ze.isString(e)){var n=tt.alloc(t=Ze.length(e));Ze.decode(e,n,0),e=n}return this.uint32(t)._push(ct,t,e)},tt.prototype.string=function(e){var t=Ke.length(e);return t?this.uint32(t)._push(Ke.write,t,e):this._push(rt,1,0)},tt.prototype.fork=function(){return this.states=new et(this),this.head=this.tail=new Ye(Xe,0,0),this.len=0,this},tt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ye(Xe,0,0),this.len=0),this},tt.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},tt.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},tt._configure=function(e){Ge=e,tt.create=nt(),Ge._configure()};var ut=pt,dt=Qe;(pt.prototype=Object.create(dt.prototype)).constructor=pt;var lt=We();function pt(){dt.call(this)}function ft(e,t,n){e.length<40?lt.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}pt._configure=function(){pt.alloc=lt._Buffer_allocUnsafe,pt.writeBytesBuffer=lt.Buffer&&lt.Buffer.prototype instanceof Uint8Array&&"set"===lt.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},pt.prototype.bytes=function(e){lt.isString(e)&&(e=lt._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(pt.writeBytesBuffer,t,e),this},pt.prototype.string=function(e){var t=lt.Buffer.byteLength(e);return this.uint32(t),t&&this._push(ft,t,e),this},pt._configure();var ht,vt=yt,mt=We(),gt=mt.LongBits,bt=mt.utf8;function kt(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function yt(e){this.buf=e,this.pos=0,this.len=e.length}var St="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new yt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new yt(e);throw Error("illegal buffer")},wt=function(){return mt.Buffer?function(e){return(yt.create=function(e){return mt.Buffer.isBuffer(e)?new ht(e):St(e)})(e)}:St};function Ct(){var e=new gt(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw kt(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw kt(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function Tt(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function Pt(){if(this.pos+8>this.len)throw kt(this,8);return new gt(Tt(this.buf,this.pos+=4),Tt(this.buf,this.pos+=4))}yt.create=wt(),yt.prototype._slice=mt.Array.prototype.subarray||mt.Array.prototype.slice,yt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,kt(this,10);return e}}(),yt.prototype.int32=function(){return 0|this.uint32()},yt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},yt.prototype.bool=function(){return 0!==this.uint32()},yt.prototype.fixed32=function(){if(this.pos+4>this.len)throw kt(this,4);return Tt(this.buf,this.pos+=4)},yt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw kt(this,4);return 0|Tt(this.buf,this.pos+=4)},yt.prototype.float=function(){if(this.pos+4>this.len)throw kt(this,4);var e=mt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},yt.prototype.double=function(){if(this.pos+8>this.len)throw kt(this,4);var e=mt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},yt.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw kt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},yt.prototype.string=function(){var e=this.bytes();return bt.read(e,0,e.length)},yt.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw kt(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw kt(this)}while(128&this.buf[this.pos++]);return this},yt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},yt._configure=function(e){ht=e,yt.create=wt(),ht._configure();var t=mt.Long?"toLong":"toNumber";mt.merge(yt.prototype,{int64:function(){return Ct.call(this)[t](!1)},uint64:function(){return Ct.call(this)[t](!0)},sint64:function(){return Ct.call(this).zzDecode()[t](!1)},fixed64:function(){return Pt.call(this)[t](!0)},sfixed64:function(){return Pt.call(this)[t](!1)}})};var Et=Ot,xt=vt;(Ot.prototype=Object.create(xt.prototype)).constructor=Ot;var Rt=We();function Ot(e){xt.call(this,e)}Ot._configure=function(){Rt.Buffer&&(Ot.prototype._slice=Rt.Buffer.prototype.slice)},Ot.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},Ot._configure();var Nt={},It=At,Dt=We();function At(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");Dt.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(At.prototype=Object.create(Dt.EventEmitter.prototype)).constructor=At,At.prototype.rpcCall=function e(t,n,r,i,a){if(!i)throw TypeError("request must be specified");var o=this;if(!a)return Dt.asPromise(e,o,t,n,r,i);if(o.rpcImpl)try{return o.rpcImpl(t,n[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(e,n){if(e)return o.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof r))try{n=r[o.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return o.emit("error",e,t),a(e)}return o.emit("data",n,t),a(null,n)}o.end(!0)})}catch(s){return o.emit("error",s,t),void setTimeout(function(){a(s)},0)}else setTimeout(function(){a(Error("already ended"))},0)},At.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(e){e.Service=It}(Nt);var Ut={};!function(e){var t=ye;function n(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}t.build="minimal",t.Writer=Qe,t.BufferWriter=ut,t.Reader=vt,t.BufferReader=Et,t.util=We(),t.rpc=Nt,t.roots=Ut,t.configure=n,n()}(),ke.exports=ye;var Lt,_t,Mt,jt,Bt,Jt,$t,Ft,Vt,qt,Wt=j(ke.exports),Gt=function(){if(void 0!==Gt)return Gt;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw"Unable to locate global object"}();function Qt(e){switch(e){case 0:case"AUDIO":return Lt.AUDIO;case 1:case"VIDEO":return Lt.VIDEO;case 2:case"DATA":return Lt.DATA;case-1:case"UNRECOGNIZED":default:return Lt.UNRECOGNIZED}}function zt(e){switch(e){case Lt.AUDIO:return"AUDIO";case Lt.VIDEO:return"VIDEO";case Lt.DATA:return"DATA";case Lt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function Ht(e){switch(e){case 0:case"UNKNOWN":return _t.UNKNOWN;case 1:case"CAMERA":return _t.CAMERA;case 2:case"MICROPHONE":return _t.MICROPHONE;case 3:case"SCREEN_SHARE":return _t.SCREEN_SHARE;case 4:case"SCREEN_SHARE_AUDIO":return _t.SCREEN_SHARE_AUDIO;case-1:case"UNRECOGNIZED":default:return _t.UNRECOGNIZED}}function Zt(e){switch(e){case _t.UNKNOWN:return"UNKNOWN";case _t.CAMERA:return"CAMERA";case _t.MICROPHONE:return"MICROPHONE";case _t.SCREEN_SHARE:return"SCREEN_SHARE";case _t.SCREEN_SHARE_AUDIO:return"SCREEN_SHARE_AUDIO";case _t.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function Kt(e){switch(e){case 0:case"LOW":return Mt.LOW;case 1:case"MEDIUM":return Mt.MEDIUM;case 2:case"HIGH":return Mt.HIGH;case 3:case"OFF":return Mt.OFF;case-1:case"UNRECOGNIZED":default:return Mt.UNRECOGNIZED}}function Yt(e){switch(e){case Mt.LOW:return"LOW";case Mt.MEDIUM:return"MEDIUM";case Mt.HIGH:return"HIGH";case Mt.OFF:return"OFF";case Mt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function Xt(e){switch(e){case 0:case"POOR":return jt.POOR;case 1:case"GOOD":return jt.GOOD;case 2:case"EXCELLENT":return jt.EXCELLENT;case-1:case"UNRECOGNIZED":default:return jt.UNRECOGNIZED}}function en(e){switch(e){case jt.POOR:return"POOR";case jt.GOOD:return"GOOD";case jt.EXCELLENT:return"EXCELLENT";case jt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function tn(e){switch(e){case 0:case"UNSET":return Bt.UNSET;case 1:case"DISABLED":return Bt.DISABLED;case 2:case"ENABLED":return Bt.ENABLED;case-1:case"UNRECOGNIZED":default:return Bt.UNRECOGNIZED}}function nn(e){switch(e){case Bt.UNSET:return"UNSET";case Bt.DISABLED:return"DISABLED";case Bt.ENABLED:return"ENABLED";case Bt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function rn(e){switch(e){case 0:case"UNKNOWN_REASON":return Jt.UNKNOWN_REASON;case 1:case"CLIENT_INITIATED":return Jt.CLIENT_INITIATED;case 2:case"DUPLICATE_IDENTITY":return Jt.DUPLICATE_IDENTITY;case 3:case"SERVER_SHUTDOWN":return Jt.SERVER_SHUTDOWN;case 4:case"PARTICIPANT_REMOVED":return Jt.PARTICIPANT_REMOVED;case 5:case"ROOM_DELETED":return Jt.ROOM_DELETED;case 6:case"STATE_MISMATCH":return Jt.STATE_MISMATCH;case 7:case"JOIN_FAILURE":return Jt.JOIN_FAILURE;case-1:case"UNRECOGNIZED":default:return Jt.UNRECOGNIZED}}function an(e){switch(e){case Jt.UNKNOWN_REASON:return"UNKNOWN_REASON";case Jt.CLIENT_INITIATED:return"CLIENT_INITIATED";case Jt.DUPLICATE_IDENTITY:return"DUPLICATE_IDENTITY";case Jt.SERVER_SHUTDOWN:return"SERVER_SHUTDOWN";case Jt.PARTICIPANT_REMOVED:return"PARTICIPANT_REMOVED";case Jt.ROOM_DELETED:return"ROOM_DELETED";case Jt.STATE_MISMATCH:return"STATE_MISMATCH";case Jt.JOIN_FAILURE:return"JOIN_FAILURE";case Jt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function on(e){switch(e){case 0:case"JOINING":return $t.JOINING;case 1:case"JOINED":return $t.JOINED;case 2:case"ACTIVE":return $t.ACTIVE;case 3:case"DISCONNECTED":return $t.DISCONNECTED;case-1:case"UNRECOGNIZED":default:return $t.UNRECOGNIZED}}function sn(e){switch(e){case $t.JOINING:return"JOINING";case $t.JOINED:return"JOINED";case $t.ACTIVE:return"ACTIVE";case $t.DISCONNECTED:return"DISCONNECTED";case $t.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function cn(e){switch(e){case 0:case"RELIABLE":return Ft.RELIABLE;case 1:case"LOSSY":return Ft.LOSSY;case-1:case"UNRECOGNIZED":default:return Ft.UNRECOGNIZED}}function un(e){switch(e){case Ft.RELIABLE:return"RELIABLE";case Ft.LOSSY:return"LOSSY";case Ft.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function dn(e){switch(e){case 0:case"Standard":return Vt.Standard;case 1:case"Cloud":return Vt.Cloud;case-1:case"UNRECOGNIZED":default:return Vt.UNRECOGNIZED}}function ln(e){switch(e){case Vt.Standard:return"Standard";case Vt.Cloud:return"Cloud";case Vt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function pn(e){switch(e){case 0:case"UNKNOWN":return qt.UNKNOWN;case 1:case"JS":return qt.JS;case 2:case"SWIFT":return qt.SWIFT;case 3:case"ANDROID":return qt.ANDROID;case 4:case"FLUTTER":return qt.FLUTTER;case 5:case"GO":return qt.GO;case 6:case"UNITY":return qt.UNITY;case-1:case"UNRECOGNIZED":default:return qt.UNRECOGNIZED}}function fn(e){switch(e){case qt.UNKNOWN:return"UNKNOWN";case qt.JS:return"JS";case qt.SWIFT:return"SWIFT";case qt.ANDROID:return"ANDROID";case qt.FLUTTER:return"FLUTTER";case qt.GO:return"GO";case qt.UNITY:return"UNITY";case qt.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function hn(){return{sid:"",name:"",emptyTimeout:0,maxParticipants:0,creationTime:0,turnPassword:"",enabledCodecs:[],metadata:"",numParticipants:0,activeRecording:!1}}Wt.util.Long!==q&&(Wt.util.Long=q,Wt.configure()),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO",e[e.DATA=2]="DATA",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Lt||(Lt={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CAMERA=1]="CAMERA",e[e.MICROPHONE=2]="MICROPHONE",e[e.SCREEN_SHARE=3]="SCREEN_SHARE",e[e.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(_t||(_t={})),exports.VideoQuality=Mt,function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.OFF=3]="OFF",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Mt||(exports.VideoQuality=Mt={})),function(e){e[e.POOR=0]="POOR",e[e.GOOD=1]="GOOD",e[e.EXCELLENT=2]="EXCELLENT",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(jt||(jt={})),function(e){e[e.UNSET=0]="UNSET",e[e.DISABLED=1]="DISABLED",e[e.ENABLED=2]="ENABLED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Bt||(Bt={})),exports.DisconnectReason=Jt,function(e){e[e.UNKNOWN_REASON=0]="UNKNOWN_REASON",e[e.CLIENT_INITIATED=1]="CLIENT_INITIATED",e[e.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",e[e.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",e[e.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",e[e.ROOM_DELETED=5]="ROOM_DELETED",e[e.STATE_MISMATCH=6]="STATE_MISMATCH",e[e.JOIN_FAILURE=7]="JOIN_FAILURE",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Jt||(exports.DisconnectReason=Jt={})),function(e){e[e.JOINING=0]="JOINING",e[e.JOINED=1]="JOINED",e[e.ACTIVE=2]="ACTIVE",e[e.DISCONNECTED=3]="DISCONNECTED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}($t||($t={})),exports.DataPacket_Kind=Ft,function(e){e[e.RELIABLE=0]="RELIABLE",e[e.LOSSY=1]="LOSSY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Ft||(exports.DataPacket_Kind=Ft={})),function(e){e[e.Standard=0]="Standard",e[e.Cloud=1]="Cloud",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(Vt||(Vt={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.JS=1]="JS",e[e.SWIFT=2]="SWIFT",e[e.ANDROID=3]="ANDROID",e[e.FLUTTER=4]="FLUTTER",e[e.GO=5]="GO",e[e.UNITY=6]="UNITY",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(qt||(qt={}));var vn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.sid&&t.uint32(10).string(e.sid),""!==e.name&&t.uint32(18).string(e.name),0!==e.emptyTimeout&&t.uint32(24).uint32(e.emptyTimeout),0!==e.maxParticipants&&t.uint32(32).uint32(e.maxParticipants),0!==e.creationTime&&t.uint32(40).int64(e.creationTime),""!==e.turnPassword&&t.uint32(50).string(e.turnPassword);var n,r=D(e.enabledCodecs);try{for(r.s();!(n=r.n()).done;){var i=n.value;gn.encode(i,t.uint32(58).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return""!==e.metadata&&t.uint32(66).string(e.metadata),0!==e.numParticipants&&t.uint32(72).uint32(e.numParticipants),!0===e.activeRecording&&t.uint32(80).bool(e.activeRecording),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=hn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.sid=n.string();break;case 2:i.name=n.string();break;case 3:i.emptyTimeout=n.uint32();break;case 4:i.maxParticipants=n.uint32();break;case 5:i.creationTime=Kn(n.int64());break;case 6:i.turnPassword=n.string();break;case 7:i.enabledCodecs.push(gn.decode(n,n.uint32()));break;case 8:i.metadata=n.string();break;case 9:i.numParticipants=n.uint32();break;case 10:i.activeRecording=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{sid:Yn(e.sid)?String(e.sid):"",name:Yn(e.name)?String(e.name):"",emptyTimeout:Yn(e.emptyTimeout)?Number(e.emptyTimeout):0,maxParticipants:Yn(e.maxParticipants)?Number(e.maxParticipants):0,creationTime:Yn(e.creationTime)?Number(e.creationTime):0,turnPassword:Yn(e.turnPassword)?String(e.turnPassword):"",enabledCodecs:Array.isArray(null==e?void 0:e.enabledCodecs)?e.enabledCodecs.map(function(e){return gn.fromJSON(e)}):[],metadata:Yn(e.metadata)?String(e.metadata):"",numParticipants:Yn(e.numParticipants)?Number(e.numParticipants):0,activeRecording:!!Yn(e.activeRecording)&&Boolean(e.activeRecording)}},toJSON:function(e){var t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.name&&(t.name=e.name),void 0!==e.emptyTimeout&&(t.emptyTimeout=Math.round(e.emptyTimeout)),void 0!==e.maxParticipants&&(t.maxParticipants=Math.round(e.maxParticipants)),void 0!==e.creationTime&&(t.creationTime=Math.round(e.creationTime)),void 0!==e.turnPassword&&(t.turnPassword=e.turnPassword),e.enabledCodecs?t.enabledCodecs=e.enabledCodecs.map(function(e){return e?gn.toJSON(e):void 0}):t.enabledCodecs=[],void 0!==e.metadata&&(t.metadata=e.metadata),void 0!==e.numParticipants&&(t.numParticipants=Math.round(e.numParticipants)),void 0!==e.activeRecording&&(t.activeRecording=e.activeRecording),t},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l=hn();return l.sid=null!==(t=e.sid)&&void 0!==t?t:"",l.name=null!==(n=e.name)&&void 0!==n?n:"",l.emptyTimeout=null!==(r=e.emptyTimeout)&&void 0!==r?r:0,l.maxParticipants=null!==(i=e.maxParticipants)&&void 0!==i?i:0,l.creationTime=null!==(a=e.creationTime)&&void 0!==a?a:0,l.turnPassword=null!==(o=e.turnPassword)&&void 0!==o?o:"",l.enabledCodecs=(null===(s=e.enabledCodecs)||void 0===s?void 0:s.map(function(e){return gn.fromPartial(e)}))||[],l.metadata=null!==(c=e.metadata)&&void 0!==c?c:"",l.numParticipants=null!==(u=e.numParticipants)&&void 0!==u?u:0,l.activeRecording=null!==(d=e.activeRecording)&&void 0!==d&&d,l}};function mn(){return{mime:"",fmtpLine:""}}var gn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.mime&&t.uint32(10).string(e.mime),""!==e.fmtpLine&&t.uint32(18).string(e.fmtpLine),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=mn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.mime=n.string();break;case 2:i.fmtpLine=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{mime:Yn(e.mime)?String(e.mime):"",fmtpLine:Yn(e.fmtpLine)?String(e.fmtpLine):""}},toJSON:function(e){var t={};return void 0!==e.mime&&(t.mime=e.mime),void 0!==e.fmtpLine&&(t.fmtpLine=e.fmtpLine),t},fromPartial:function(e){var t,n,r=mn();return r.mime=null!==(t=e.mime)&&void 0!==t?t:"",r.fmtpLine=null!==(n=e.fmtpLine)&&void 0!==n?n:"",r}};function bn(){return{canSubscribe:!1,canPublish:!1,canPublishData:!1,hidden:!1,recorder:!1}}var kn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return!0===e.canSubscribe&&t.uint32(8).bool(e.canSubscribe),!0===e.canPublish&&t.uint32(16).bool(e.canPublish),!0===e.canPublishData&&t.uint32(24).bool(e.canPublishData),!0===e.hidden&&t.uint32(56).bool(e.hidden),!0===e.recorder&&t.uint32(64).bool(e.recorder),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=bn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.canSubscribe=n.bool();break;case 2:i.canPublish=n.bool();break;case 3:i.canPublishData=n.bool();break;case 7:i.hidden=n.bool();break;case 8:i.recorder=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{canSubscribe:!!Yn(e.canSubscribe)&&Boolean(e.canSubscribe),canPublish:!!Yn(e.canPublish)&&Boolean(e.canPublish),canPublishData:!!Yn(e.canPublishData)&&Boolean(e.canPublishData),hidden:!!Yn(e.hidden)&&Boolean(e.hidden),recorder:!!Yn(e.recorder)&&Boolean(e.recorder)}},toJSON:function(e){var t={};return void 0!==e.canSubscribe&&(t.canSubscribe=e.canSubscribe),void 0!==e.canPublish&&(t.canPublish=e.canPublish),void 0!==e.canPublishData&&(t.canPublishData=e.canPublishData),void 0!==e.hidden&&(t.hidden=e.hidden),void 0!==e.recorder&&(t.recorder=e.recorder),t},fromPartial:function(e){var t,n,r,i,a,o=bn();return o.canSubscribe=null!==(t=e.canSubscribe)&&void 0!==t&&t,o.canPublish=null!==(n=e.canPublish)&&void 0!==n&&n,o.canPublishData=null!==(r=e.canPublishData)&&void 0!==r&&r,o.hidden=null!==(i=e.hidden)&&void 0!==i&&i,o.recorder=null!==(a=e.recorder)&&void 0!==a&&a,o}};function yn(){return{sid:"",identity:"",state:0,tracks:[],metadata:"",joinedAt:0,name:"",version:0,permission:void 0,region:"",isPublisher:!1}}var Sn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.sid&&t.uint32(10).string(e.sid),""!==e.identity&&t.uint32(18).string(e.identity),0!==e.state&&t.uint32(24).int32(e.state);var n,r=D(e.tracks);try{for(r.s();!(n=r.n()).done;){var i=n.value;Pn.encode(i,t.uint32(34).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return""!==e.metadata&&t.uint32(42).string(e.metadata),0!==e.joinedAt&&t.uint32(48).int64(e.joinedAt),""!==e.name&&t.uint32(74).string(e.name),0!==e.version&&t.uint32(80).uint32(e.version),void 0!==e.permission&&kn.encode(e.permission,t.uint32(90).fork()).ldelim(),""!==e.region&&t.uint32(98).string(e.region),!0===e.isPublisher&&t.uint32(104).bool(e.isPublisher),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=yn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.sid=n.string();break;case 2:i.identity=n.string();break;case 3:i.state=n.int32();break;case 4:i.tracks.push(Pn.decode(n,n.uint32()));break;case 5:i.metadata=n.string();break;case 6:i.joinedAt=Kn(n.int64());break;case 9:i.name=n.string();break;case 10:i.version=n.uint32();break;case 11:i.permission=kn.decode(n,n.uint32());break;case 12:i.region=n.string();break;case 13:i.isPublisher=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{sid:Yn(e.sid)?String(e.sid):"",identity:Yn(e.identity)?String(e.identity):"",state:Yn(e.state)?on(e.state):0,tracks:Array.isArray(null==e?void 0:e.tracks)?e.tracks.map(function(e){return Pn.fromJSON(e)}):[],metadata:Yn(e.metadata)?String(e.metadata):"",joinedAt:Yn(e.joinedAt)?Number(e.joinedAt):0,name:Yn(e.name)?String(e.name):"",version:Yn(e.version)?Number(e.version):0,permission:Yn(e.permission)?kn.fromJSON(e.permission):void 0,region:Yn(e.region)?String(e.region):"",isPublisher:!!Yn(e.isPublisher)&&Boolean(e.isPublisher)}},toJSON:function(e){var t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.identity&&(t.identity=e.identity),void 0!==e.state&&(t.state=sn(e.state)),e.tracks?t.tracks=e.tracks.map(function(e){return e?Pn.toJSON(e):void 0}):t.tracks=[],void 0!==e.metadata&&(t.metadata=e.metadata),void 0!==e.joinedAt&&(t.joinedAt=Math.round(e.joinedAt)),void 0!==e.name&&(t.name=e.name),void 0!==e.version&&(t.version=Math.round(e.version)),void 0!==e.permission&&(t.permission=e.permission?kn.toJSON(e.permission):void 0),void 0!==e.region&&(t.region=e.region),void 0!==e.isPublisher&&(t.isPublisher=e.isPublisher),t},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l=yn();return l.sid=null!==(t=e.sid)&&void 0!==t?t:"",l.identity=null!==(n=e.identity)&&void 0!==n?n:"",l.state=null!==(r=e.state)&&void 0!==r?r:0,l.tracks=(null===(i=e.tracks)||void 0===i?void 0:i.map(function(e){return Pn.fromPartial(e)}))||[],l.metadata=null!==(a=e.metadata)&&void 0!==a?a:"",l.joinedAt=null!==(o=e.joinedAt)&&void 0!==o?o:0,l.name=null!==(s=e.name)&&void 0!==s?s:"",l.version=null!==(c=e.version)&&void 0!==c?c:0,l.permission=void 0!==e.permission&&null!==e.permission?kn.fromPartial(e.permission):void 0,l.region=null!==(u=e.region)&&void 0!==u?u:"",l.isPublisher=null!==(d=e.isPublisher)&&void 0!==d&&d,l}};function wn(){return{mimeType:"",mid:"",cid:"",layers:[]}}var Cn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.mimeType&&t.uint32(10).string(e.mimeType),""!==e.mid&&t.uint32(18).string(e.mid),""!==e.cid&&t.uint32(26).string(e.cid);var n,r=D(e.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;xn.encode(i,t.uint32(34).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=wn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.mimeType=n.string();break;case 2:i.mid=n.string();break;case 3:i.cid=n.string();break;case 4:i.layers.push(xn.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{mimeType:Yn(e.mimeType)?String(e.mimeType):"",mid:Yn(e.mid)?String(e.mid):"",cid:Yn(e.cid)?String(e.cid):"",layers:Array.isArray(null==e?void 0:e.layers)?e.layers.map(function(e){return xn.fromJSON(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.mimeType&&(t.mimeType=e.mimeType),void 0!==e.mid&&(t.mid=e.mid),void 0!==e.cid&&(t.cid=e.cid),e.layers?t.layers=e.layers.map(function(e){return e?xn.toJSON(e):void 0}):t.layers=[],t},fromPartial:function(e){var t,n,r,i,a=wn();return a.mimeType=null!==(t=e.mimeType)&&void 0!==t?t:"",a.mid=null!==(n=e.mid)&&void 0!==n?n:"",a.cid=null!==(r=e.cid)&&void 0!==r?r:"",a.layers=(null===(i=e.layers)||void 0===i?void 0:i.map(function(e){return xn.fromPartial(e)}))||[],a}};function Tn(){return{sid:"",type:0,name:"",muted:!1,width:0,height:0,simulcast:!1,disableDtx:!1,source:0,layers:[],mimeType:"",mid:"",codecs:[]}}var Pn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.sid&&t.uint32(10).string(e.sid),0!==e.type&&t.uint32(16).int32(e.type),""!==e.name&&t.uint32(26).string(e.name),!0===e.muted&&t.uint32(32).bool(e.muted),0!==e.width&&t.uint32(40).uint32(e.width),0!==e.height&&t.uint32(48).uint32(e.height),!0===e.simulcast&&t.uint32(56).bool(e.simulcast),!0===e.disableDtx&&t.uint32(64).bool(e.disableDtx),0!==e.source&&t.uint32(72).int32(e.source);var n,r=D(e.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;xn.encode(i,t.uint32(82).fork()).ldelim()}}catch(c){r.e(c)}finally{r.f()}""!==e.mimeType&&t.uint32(90).string(e.mimeType),""!==e.mid&&t.uint32(98).string(e.mid);var a,o=D(e.codecs);try{for(o.s();!(a=o.n()).done;){var s=a.value;Cn.encode(s,t.uint32(106).fork()).ldelim()}}catch(c){o.e(c)}finally{o.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Tn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.sid=n.string();break;case 2:i.type=n.int32();break;case 3:i.name=n.string();break;case 4:i.muted=n.bool();break;case 5:i.width=n.uint32();break;case 6:i.height=n.uint32();break;case 7:i.simulcast=n.bool();break;case 8:i.disableDtx=n.bool();break;case 9:i.source=n.int32();break;case 10:i.layers.push(xn.decode(n,n.uint32()));break;case 11:i.mimeType=n.string();break;case 12:i.mid=n.string();break;case 13:i.codecs.push(Cn.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{sid:Yn(e.sid)?String(e.sid):"",type:Yn(e.type)?Qt(e.type):0,name:Yn(e.name)?String(e.name):"",muted:!!Yn(e.muted)&&Boolean(e.muted),width:Yn(e.width)?Number(e.width):0,height:Yn(e.height)?Number(e.height):0,simulcast:!!Yn(e.simulcast)&&Boolean(e.simulcast),disableDtx:!!Yn(e.disableDtx)&&Boolean(e.disableDtx),source:Yn(e.source)?Ht(e.source):0,layers:Array.isArray(null==e?void 0:e.layers)?e.layers.map(function(e){return xn.fromJSON(e)}):[],mimeType:Yn(e.mimeType)?String(e.mimeType):"",mid:Yn(e.mid)?String(e.mid):"",codecs:Array.isArray(null==e?void 0:e.codecs)?e.codecs.map(function(e){return Cn.fromJSON(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.type&&(t.type=zt(e.type)),void 0!==e.name&&(t.name=e.name),void 0!==e.muted&&(t.muted=e.muted),void 0!==e.width&&(t.width=Math.round(e.width)),void 0!==e.height&&(t.height=Math.round(e.height)),void 0!==e.simulcast&&(t.simulcast=e.simulcast),void 0!==e.disableDtx&&(t.disableDtx=e.disableDtx),void 0!==e.source&&(t.source=Zt(e.source)),e.layers?t.layers=e.layers.map(function(e){return e?xn.toJSON(e):void 0}):t.layers=[],void 0!==e.mimeType&&(t.mimeType=e.mimeType),void 0!==e.mid&&(t.mid=e.mid),e.codecs?t.codecs=e.codecs.map(function(e){return e?Cn.toJSON(e):void 0}):t.codecs=[],t},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h=Tn();return h.sid=null!==(t=e.sid)&&void 0!==t?t:"",h.type=null!==(n=e.type)&&void 0!==n?n:0,h.name=null!==(r=e.name)&&void 0!==r?r:"",h.muted=null!==(i=e.muted)&&void 0!==i&&i,h.width=null!==(a=e.width)&&void 0!==a?a:0,h.height=null!==(o=e.height)&&void 0!==o?o:0,h.simulcast=null!==(s=e.simulcast)&&void 0!==s&&s,h.disableDtx=null!==(c=e.disableDtx)&&void 0!==c&&c,h.source=null!==(u=e.source)&&void 0!==u?u:0,h.layers=(null===(d=e.layers)||void 0===d?void 0:d.map(function(e){return xn.fromPartial(e)}))||[],h.mimeType=null!==(l=e.mimeType)&&void 0!==l?l:"",h.mid=null!==(p=e.mid)&&void 0!==p?p:"",h.codecs=(null===(f=e.codecs)||void 0===f?void 0:f.map(function(e){return Cn.fromPartial(e)}))||[],h}};function En(){return{quality:0,width:0,height:0,bitrate:0,ssrc:0}}var xn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return 0!==e.quality&&t.uint32(8).int32(e.quality),0!==e.width&&t.uint32(16).uint32(e.width),0!==e.height&&t.uint32(24).uint32(e.height),0!==e.bitrate&&t.uint32(32).uint32(e.bitrate),0!==e.ssrc&&t.uint32(40).uint32(e.ssrc),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=En();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.quality=n.int32();break;case 2:i.width=n.uint32();break;case 3:i.height=n.uint32();break;case 4:i.bitrate=n.uint32();break;case 5:i.ssrc=n.uint32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{quality:Yn(e.quality)?Kt(e.quality):0,width:Yn(e.width)?Number(e.width):0,height:Yn(e.height)?Number(e.height):0,bitrate:Yn(e.bitrate)?Number(e.bitrate):0,ssrc:Yn(e.ssrc)?Number(e.ssrc):0}},toJSON:function(e){var t={};return void 0!==e.quality&&(t.quality=Yt(e.quality)),void 0!==e.width&&(t.width=Math.round(e.width)),void 0!==e.height&&(t.height=Math.round(e.height)),void 0!==e.bitrate&&(t.bitrate=Math.round(e.bitrate)),void 0!==e.ssrc&&(t.ssrc=Math.round(e.ssrc)),t},fromPartial:function(e){var t,n,r,i,a,o=En();return o.quality=null!==(t=e.quality)&&void 0!==t?t:0,o.width=null!==(n=e.width)&&void 0!==n?n:0,o.height=null!==(r=e.height)&&void 0!==r?r:0,o.bitrate=null!==(i=e.bitrate)&&void 0!==i?i:0,o.ssrc=null!==(a=e.ssrc)&&void 0!==a?a:0,o}};function Rn(){return{kind:0,value:void 0}}var On={encode:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return 0!==e.kind&&r.uint32(8).int32(e.kind),"user"===(null===(t=e.value)||void 0===t?void 0:t.$case)&&Ln.encode(e.value.user,r.uint32(18).fork()).ldelim(),"speaker"===(null===(n=e.value)||void 0===n?void 0:n.$case)&&In.encode(e.value.speaker,r.uint32(26).fork()).ldelim(),r},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Rn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.kind=n.int32();break;case 2:i.value={$case:"user",user:Ln.decode(n,n.uint32())};break;case 3:i.value={$case:"speaker",speaker:In.decode(n,n.uint32())};break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{kind:Yn(e.kind)?cn(e.kind):0,value:Yn(e.user)?{$case:"user",user:Ln.fromJSON(e.user)}:Yn(e.speaker)?{$case:"speaker",speaker:In.fromJSON(e.speaker)}:void 0}},toJSON:function(e){var t,n,r,i,a,o,s={};return void 0!==e.kind&&(s.kind=un(e.kind)),"user"===(null===(t=e.value)||void 0===t?void 0:t.$case)&&(s.user=(null===(n=e.value)||void 0===n?void 0:n.user)?Ln.toJSON(null===(r=e.value)||void 0===r?void 0:r.user):void 0),"speaker"===(null===(i=e.value)||void 0===i?void 0:i.$case)&&(s.speaker=(null===(a=e.value)||void 0===a?void 0:a.speaker)?In.toJSON(null===(o=e.value)||void 0===o?void 0:o.speaker):void 0),s},fromPartial:function(e){var t,n,r,i,a,o,s,c=Rn();return c.kind=null!==(t=e.kind)&&void 0!==t?t:0,"user"===(null===(n=e.value)||void 0===n?void 0:n.$case)&&void 0!==(null===(r=e.value)||void 0===r?void 0:r.user)&&null!==(null===(i=e.value)||void 0===i?void 0:i.user)&&(c.value={$case:"user",user:Ln.fromPartial(e.value.user)}),"speaker"===(null===(a=e.value)||void 0===a?void 0:a.$case)&&void 0!==(null===(o=e.value)||void 0===o?void 0:o.speaker)&&null!==(null===(s=e.value)||void 0===s?void 0:s.speaker)&&(c.value={$case:"speaker",speaker:In.fromPartial(e.value.speaker)}),c}};function Nn(){return{speakers:[]}}var In={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.speakers);try{for(r.s();!(t=r.n()).done;){var i=t.value;An.encode(i,n.uint32(10).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Nn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.speakers.push(An.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{speakers:Array.isArray(null==e?void 0:e.speakers)?e.speakers.map(function(e){return An.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.speakers?t.speakers=e.speakers.map(function(e){return e?An.toJSON(e):void 0}):t.speakers=[],t},fromPartial:function(e){var t,n=Nn();return n.speakers=(null===(t=e.speakers)||void 0===t?void 0:t.map(function(e){return An.fromPartial(e)}))||[],n}};function Dn(){return{sid:"",level:0,active:!1}}var An={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.sid&&t.uint32(10).string(e.sid),0!==e.level&&t.uint32(21).float(e.level),!0===e.active&&t.uint32(24).bool(e.active),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Dn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.sid=n.string();break;case 2:i.level=n.float();break;case 3:i.active=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{sid:Yn(e.sid)?String(e.sid):"",level:Yn(e.level)?Number(e.level):0,active:!!Yn(e.active)&&Boolean(e.active)}},toJSON:function(e){var t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.level&&(t.level=e.level),void 0!==e.active&&(t.active=e.active),t},fromPartial:function(e){var t,n,r,i=Dn();return i.sid=null!==(t=e.sid)&&void 0!==t?t:"",i.level=null!==(n=e.level)&&void 0!==n?n:0,i.active=null!==(r=e.active)&&void 0!==r&&r,i}};function Un(){return{participantSid:"",payload:new Uint8Array,destinationSids:[]}}var Ln={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.payload.length&&t.uint32(18).bytes(e.payload);var n,r=D(e.destinationSids);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.uint32(26).string(i)}}catch(a){r.e(a)}finally{r.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Un();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participantSid=n.string();break;case 2:i.payload=n.bytes();break;case 3:i.destinationSids.push(n.string());break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participantSid:Yn(e.participantSid)?String(e.participantSid):"",payload:Yn(e.payload)?Hn(e.payload):new Uint8Array,destinationSids:Array.isArray(null==e?void 0:e.destinationSids)?e.destinationSids.map(function(e){return String(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.payload&&(t.payload=Zn(void 0!==e.payload?e.payload:new Uint8Array)),e.destinationSids?t.destinationSids=e.destinationSids.map(function(e){return e}):t.destinationSids=[],t},fromPartial:function(e){var t,n,r,i=Un();return i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.payload=null!==(n=e.payload)&&void 0!==n?n:new Uint8Array,i.destinationSids=(null===(r=e.destinationSids)||void 0===r?void 0:r.map(function(e){return e}))||[],i}};function _n(){return{participantSid:"",trackSids:[]}}var Mn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.participantSid&&t.uint32(10).string(e.participantSid);var n,r=D(e.trackSids);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.uint32(18).string(i)}}catch(a){r.e(a)}finally{r.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=_n();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participantSid=n.string();break;case 2:i.trackSids.push(n.string());break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participantSid:Yn(e.participantSid)?String(e.participantSid):"",trackSids:Array.isArray(null==e?void 0:e.trackSids)?e.trackSids.map(function(e){return String(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),e.trackSids?t.trackSids=e.trackSids.map(function(e){return e}):t.trackSids=[],t},fromPartial:function(e){var t,n,r=_n();return r.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",r.trackSids=(null===(n=e.trackSids)||void 0===n?void 0:n.map(function(e){return e}))||[],r}};function jn(){return{edition:0,version:"",protocol:0,region:"",nodeId:"",debugInfo:""}}var Bn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return 0!==e.edition&&t.uint32(8).int32(e.edition),""!==e.version&&t.uint32(18).string(e.version),0!==e.protocol&&t.uint32(24).int32(e.protocol),""!==e.region&&t.uint32(34).string(e.region),""!==e.nodeId&&t.uint32(42).string(e.nodeId),""!==e.debugInfo&&t.uint32(50).string(e.debugInfo),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=jn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.edition=n.int32();break;case 2:i.version=n.string();break;case 3:i.protocol=n.int32();break;case 4:i.region=n.string();break;case 5:i.nodeId=n.string();break;case 6:i.debugInfo=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{edition:Yn(e.edition)?dn(e.edition):0,version:Yn(e.version)?String(e.version):"",protocol:Yn(e.protocol)?Number(e.protocol):0,region:Yn(e.region)?String(e.region):"",nodeId:Yn(e.nodeId)?String(e.nodeId):"",debugInfo:Yn(e.debugInfo)?String(e.debugInfo):""}},toJSON:function(e){var t={};return void 0!==e.edition&&(t.edition=ln(e.edition)),void 0!==e.version&&(t.version=e.version),void 0!==e.protocol&&(t.protocol=Math.round(e.protocol)),void 0!==e.region&&(t.region=e.region),void 0!==e.nodeId&&(t.nodeId=e.nodeId),void 0!==e.debugInfo&&(t.debugInfo=e.debugInfo),t},fromPartial:function(e){var t,n,r,i,a,o,s=jn();return s.edition=null!==(t=e.edition)&&void 0!==t?t:0,s.version=null!==(n=e.version)&&void 0!==n?n:"",s.protocol=null!==(r=e.protocol)&&void 0!==r?r:0,s.region=null!==(i=e.region)&&void 0!==i?i:"",s.nodeId=null!==(a=e.nodeId)&&void 0!==a?a:"",s.debugInfo=null!==(o=e.debugInfo)&&void 0!==o?o:"",s}};function Jn(){return{sdk:0,version:"",protocol:0,os:"",osVersion:"",deviceModel:"",browser:"",browserVersion:"",address:"",network:""}}var $n={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return 0!==e.sdk&&t.uint32(8).int32(e.sdk),""!==e.version&&t.uint32(18).string(e.version),0!==e.protocol&&t.uint32(24).int32(e.protocol),""!==e.os&&t.uint32(34).string(e.os),""!==e.osVersion&&t.uint32(42).string(e.osVersion),""!==e.deviceModel&&t.uint32(50).string(e.deviceModel),""!==e.browser&&t.uint32(58).string(e.browser),""!==e.browserVersion&&t.uint32(66).string(e.browserVersion),""!==e.address&&t.uint32(74).string(e.address),""!==e.network&&t.uint32(82).string(e.network),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Jn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.sdk=n.int32();break;case 2:i.version=n.string();break;case 3:i.protocol=n.int32();break;case 4:i.os=n.string();break;case 5:i.osVersion=n.string();break;case 6:i.deviceModel=n.string();break;case 7:i.browser=n.string();break;case 8:i.browserVersion=n.string();break;case 9:i.address=n.string();break;case 10:i.network=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{sdk:Yn(e.sdk)?pn(e.sdk):0,version:Yn(e.version)?String(e.version):"",protocol:Yn(e.protocol)?Number(e.protocol):0,os:Yn(e.os)?String(e.os):"",osVersion:Yn(e.osVersion)?String(e.osVersion):"",deviceModel:Yn(e.deviceModel)?String(e.deviceModel):"",browser:Yn(e.browser)?String(e.browser):"",browserVersion:Yn(e.browserVersion)?String(e.browserVersion):"",address:Yn(e.address)?String(e.address):"",network:Yn(e.network)?String(e.network):""}},toJSON:function(e){var t={};return void 0!==e.sdk&&(t.sdk=fn(e.sdk)),void 0!==e.version&&(t.version=e.version),void 0!==e.protocol&&(t.protocol=Math.round(e.protocol)),void 0!==e.os&&(t.os=e.os),void 0!==e.osVersion&&(t.osVersion=e.osVersion),void 0!==e.deviceModel&&(t.deviceModel=e.deviceModel),void 0!==e.browser&&(t.browser=e.browser),void 0!==e.browserVersion&&(t.browserVersion=e.browserVersion),void 0!==e.address&&(t.address=e.address),void 0!==e.network&&(t.network=e.network),t},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l=Jn();return l.sdk=null!==(t=e.sdk)&&void 0!==t?t:0,l.version=null!==(n=e.version)&&void 0!==n?n:"",l.protocol=null!==(r=e.protocol)&&void 0!==r?r:0,l.os=null!==(i=e.os)&&void 0!==i?i:"",l.osVersion=null!==(a=e.osVersion)&&void 0!==a?a:"",l.deviceModel=null!==(o=e.deviceModel)&&void 0!==o?o:"",l.browser=null!==(s=e.browser)&&void 0!==s?s:"",l.browserVersion=null!==(c=e.browserVersion)&&void 0!==c?c:"",l.address=null!==(u=e.address)&&void 0!==u?u:"",l.network=null!==(d=e.network)&&void 0!==d?d:"",l}};function Fn(){return{video:void 0,screen:void 0,resumeConnection:0,disabledCodecs:void 0,forceRelay:0}}var Vn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return void 0!==e.video&&Wn.encode(e.video,t.uint32(10).fork()).ldelim(),void 0!==e.screen&&Wn.encode(e.screen,t.uint32(18).fork()).ldelim(),0!==e.resumeConnection&&t.uint32(24).int32(e.resumeConnection),void 0!==e.disabledCodecs&&Qn.encode(e.disabledCodecs,t.uint32(34).fork()).ldelim(),0!==e.forceRelay&&t.uint32(40).int32(e.forceRelay),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Fn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.video=Wn.decode(n,n.uint32());break;case 2:i.screen=Wn.decode(n,n.uint32());break;case 3:i.resumeConnection=n.int32();break;case 4:i.disabledCodecs=Qn.decode(n,n.uint32());break;case 5:i.forceRelay=n.int32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{video:Yn(e.video)?Wn.fromJSON(e.video):void 0,screen:Yn(e.screen)?Wn.fromJSON(e.screen):void 0,resumeConnection:Yn(e.resumeConnection)?tn(e.resumeConnection):0,disabledCodecs:Yn(e.disabledCodecs)?Qn.fromJSON(e.disabledCodecs):void 0,forceRelay:Yn(e.forceRelay)?tn(e.forceRelay):0}},toJSON:function(e){var t={};return void 0!==e.video&&(t.video=e.video?Wn.toJSON(e.video):void 0),void 0!==e.screen&&(t.screen=e.screen?Wn.toJSON(e.screen):void 0),void 0!==e.resumeConnection&&(t.resumeConnection=nn(e.resumeConnection)),void 0!==e.disabledCodecs&&(t.disabledCodecs=e.disabledCodecs?Qn.toJSON(e.disabledCodecs):void 0),void 0!==e.forceRelay&&(t.forceRelay=nn(e.forceRelay)),t},fromPartial:function(e){var t,n,r=Fn();return r.video=void 0!==e.video&&null!==e.video?Wn.fromPartial(e.video):void 0,r.screen=void 0!==e.screen&&null!==e.screen?Wn.fromPartial(e.screen):void 0,r.resumeConnection=null!==(t=e.resumeConnection)&&void 0!==t?t:0,r.disabledCodecs=void 0!==e.disabledCodecs&&null!==e.disabledCodecs?Qn.fromPartial(e.disabledCodecs):void 0,r.forceRelay=null!==(n=e.forceRelay)&&void 0!==n?n:0,r}};function qn(){return{hardwareEncoder:0}}var Wn={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return 0!==e.hardwareEncoder&&t.uint32(8).int32(e.hardwareEncoder),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=qn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.hardwareEncoder=n.int32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{hardwareEncoder:Yn(e.hardwareEncoder)?tn(e.hardwareEncoder):0}},toJSON:function(e){var t={};return void 0!==e.hardwareEncoder&&(t.hardwareEncoder=nn(e.hardwareEncoder)),t},fromPartial:function(e){var t,n=qn();return n.hardwareEncoder=null!==(t=e.hardwareEncoder)&&void 0!==t?t:0,n}};function Gn(){return{codecs:[]}}var Qn={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.codecs);try{for(r.s();!(t=r.n()).done;){var i=t.value;gn.encode(i,n.uint32(10).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Gn();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.codecs.push(gn.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{codecs:Array.isArray(null==e?void 0:e.codecs)?e.codecs.map(function(e){return gn.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.codecs?t.codecs=e.codecs.map(function(e){return e?gn.toJSON(e):void 0}):t.codecs=[],t},fromPartial:function(e){var t,n=Gn();return n.codecs=(null===(t=e.codecs)||void 0===t?void 0:t.map(function(e){return gn.fromPartial(e)}))||[],n}},zn=function(){if(void 0!==zn)return zn;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw"Unable to locate global object"}();function Hn(e){if(zn.Buffer)return Uint8Array.from(zn.Buffer.from(e,"base64"));for(var t=zn.atob(e),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t.charCodeAt(r);return n}function Zn(e){if(zn.Buffer)return zn.Buffer.from(e).toString("base64");var t=[];return e.forEach(function(e){t.push(String.fromCharCode(e))}),zn.btoa(t.join(""))}function Kn(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new zn.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}function Yn(e){return null!=e}Wt.util.Long!==q&&(Wt.util.Long=q,Wt.configure());var Xn=7e3,er=[0,300,1200,2700,4800,Xn,Xn,Xn,Xn,Xn],tr=function(){function e(t){x(this,e),this._retryDelays=void 0!==t?C(t):er}return O(e,[{key:"nextRetryDelayInMs",value:function(e){if(e.retryCount>=this._retryDelays.length)return null;var t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}}]),e}();function nr(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new rr(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function rr(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(rr=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new rr(e)}function ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(n),!0).forEach(function(t){or(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function or(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}exports.DefaultReconnectPolicy=tr;var sr=!0,cr=!0;function ur(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function dr(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var a=function(e){var t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,a),i.apply(this,[e,a])};var a=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);var r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function lr(e){return"boolean"!=typeof e?new Error("Argument type: "+L(e)+". Please use a boolean."):(sr=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function pr(e){return"boolean"!=typeof e?new Error("Argument type: "+L(e)+". Please use a boolean."):(cr=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function fr(){if("object"===("undefined"==typeof window?"undefined":L(window))){if(sr)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function hr(e,t){cr&&console.warn(e+" is deprecated, please use "+t+" instead.")}function vr(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=ur(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=ur(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=ur(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function mr(e){return"[object Object]"===Object.prototype.toString.call(e)}function gr(e){return mr(e)?Object.keys(e).reduce(function(t,n){var r=mr(e[n]),i=r?gr(e[n]):e[n],a=r&&!Object.keys(i).length;return void 0===i||a?t:Object.assign(t,w({},n,i))},{}):e}function br(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(function(r){r.endsWith("Id")?br(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(function(t){br(e,e.get(t),n)})}))}function kr(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var a=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){e.forEach(function(n){n.type===r&&n.trackId===t.id&&br(e,n,i)})}),i}var yr=fr;function Sr(e,t){var n=e&&e.navigator;if(n.mediaDevices){var r=function(e){if("object"!==L(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===L(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[i("min",n)]=r.ideal,t.optional.push(a),(a={})[i("max",n)]=r.ideal,t.optional.push(a)):(a[i("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===L(e.audio)){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===L(e.video)){var o=e.video.facingMode;o=o&&("object"===L(o)?o:{ideal:o});var s,c=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||c))if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?s=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(s=["front"]),s)return n.mediaDevices.enumerateDevices().then(function(t){var n=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return s.some(function(t){return e.label.toLowerCase().includes(t)})});return!n&&t.length&&s.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=o.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),yr("chrome: "+JSON.stringify(e)),i(e)});e.video=r(e.video)}return yr("chrome: "+JSON.stringify(e)),i(e)},a=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,function(e){n.webkitGetUserMedia(e,t,function(e){r&&r(a(e))})})}.bind(n),n.mediaDevices.getUserMedia){var o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return i(e,function(e){return o(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(a(e))})})}}}}function wr(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function Cr(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Tr(e){if("object"!==L(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)dr(e,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.track.id}):{track:r.track};var a=new Event("track");a.track=r.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],n.dispatchEvent(a)}),t.stream.getTracks().forEach(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.id}):{track:r};var a=new Event("track");a.track=r,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],n.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}}function Pr(e){if("object"===L(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"===L(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=o.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Er(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],a=n[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){return t.apply(this,[function(e){i(s(o(e)))},r])}return new Promise(function(n,r){t.apply(e,[function(e){n(s(o(e)))},r])}).then(i,a)}}}function xr(e){if("object"===L(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return kr(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),dr(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return kr(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,a=arguments[0];return this.getSenders().forEach(function(e){e.track===a&&(t?r=!0:t=e)}),this.getReceivers().forEach(function(e){return e.track===a&&(n?r=!0:n=e),e.track===a}),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function Rr(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===r.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]}),i.apply(this,arguments)}}function Or(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Rr(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}r.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var a=this._streams[n.id];if(a)a.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var o=new e.MediaStream([t]);this._streams[n.id]=o,this._reverseStreams[o.id]=n,this.addStream(o)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=w({},t,function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=s(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then(function(t){return s(e,t)})});e.RTCPeerConnection.prototype[t]=r[t]});var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],n=t.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})),a.apply(this,arguments)):a.apply(this,arguments);var e,t,n};var o=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=o.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach(function(r){n._streams[r].getTracks().find(function(t){return e.track===t})&&(t=n._streams[r])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}}function Nr(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=w({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]})}function Ir(e,t){dr(e,"negotiationneeded",function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var Dr=Object.freeze({__proto__:null,shimMediaStream:Cr,shimOnTrack:Tr,shimGetSendersWithDtmf:Pr,shimGetStats:Er,shimSenderReceiverGetStats:xr,shimAddTrackRemoveTrackWithNative:Rr,shimAddTrackRemoveTrack:Or,shimPeerConnection:Nr,fixNegotiationNeeded:Ir,shimGetUserMedia:Sr,shimGetDisplayMedia:wr});function Ar(e,t){var n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){hr("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===L(e)&&"object"===L(e.audio)&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},r&&r.prototype.getSettings){var o=r.prototype.getSettings;r.prototype.getSettings=function(){var e=o.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===L(e)&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function Ur(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function Lr(e){"object"===L(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function _r(e,t){if("object"===L(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=w({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]});var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],a=e[1],o=e[2];return r.apply(this,[i||null]).then(function(e){if(t.version<53&&!a)try{e.forEach(function(e){e.type=n[e.type]||e.type})}catch(ou){if("TypeError"!==ou.name)throw ou;e.forEach(function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(a,o)}}}function Mr(e){if("object"===L(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function jr(e){if("object"===L(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n}),dr(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function Br(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;hr("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)})})}function Jr(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function $r(e){if("object"===L(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach(function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});var r=t.apply(this,arguments);if(n){var i=r.sender,a=i.getParameters();"encodings"in a&&(1!==a.encodings.length||0!==Object.keys(a.encodings[0]).length)||(a.encodings=e.sendEncodings,i.sendEncodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(a).then(function(){delete i.sendEncodings}).catch(function(){delete i.sendEncodings})))}return r})}}function Fr(e){if("object"===L(e)&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function Vr(e){if("object"===L(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(n,e)}).finally(function(){n.setParametersPromises=[]}):t.apply(this,arguments)}}}function qr(e){if("object"===L(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(function(){return t.apply(n,e)}).finally(function(){n.setParametersPromises=[]}):t.apply(this,arguments)}}}var Wr=Object.freeze({__proto__:null,shimOnTrack:Lr,shimPeerConnection:_r,shimSenderGetStats:Mr,shimReceiverGetStats:jr,shimRemoveStream:Br,shimRTCDataChannel:Jr,shimAddTransceiver:$r,shimGetParameters:Fr,shimCreateOffer:Vr,shimCreateAnswer:qr,shimGetUserMedia:Ar,shimGetDisplayMedia:Ur});function Gr(e){if("object"===L(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(function(r){return t.call(n,r,e)}),e.getVideoTracks().forEach(function(r){return t.call(n,r,e)})},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i&&i.forEach(function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach(function(e){r.includes(e.track)&&t.removeTrack(e)})}})}}function Qr(e){if("object"===L(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}})}),t.apply(e,arguments)}}}function zr(e){if("object"===L(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}}function Hr(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(Zr(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function Zr(e){return e&&void 0!==e.video?Object.assign({},e,{video:gr(e.video)}):e}function Kr(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],i=0;i<e.iceServers.length;i++){var a=e.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(hr("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,r.push(a)):r.push(e.iceServers[i])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function Yr(e){"object"===L(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function Xr(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function ei(e){"object"!==L(e)||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var ti=Object.freeze({__proto__:null,shimLocalStreamsAPI:Gr,shimRemoteStreamsAPI:Qr,shimCallbacksAPI:zr,shimGetUserMedia:Hr,shimConstraints:Zr,shimRTCIceServerUrls:Kr,shimTrackEventTransceiver:Yr,shimCreateOfferLegacy:Xr,shimAudioContext:ei}),ni={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},t.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(function(e){return 0===e.indexOf(n)})},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation);var n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===L(e.keyParams)?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var a=r[i],o=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(o){var s=t.parseRtpMap(o),c=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(s.parameters=c.length?t.parseFmtp(c[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach(function(e){n.headerExtensions.push(t.parseExtmap(e))}),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)});var i=0;return n.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(function(e){r+=t.writeExtmap(e)}),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=s.length>0&&s[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),a&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:o?"red+ulpfec":"red"},r.push(t))}}),0===r.length&&c&&r.push({ssrc:c});var d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,r.forEach(function(e){e.maxBitrate=d})),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var a=t.matchPrefix(e,"a=rtcp-mux");return n.mux=a.length>0,n},t.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map(function(e){return t.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var a=t.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};var o=t.matchPrefix(e,"a=sctpmap:");if(o.length>0){var s=o[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}(ni);var ri=ni.exports,ii=_({__proto__:null,default:ri},[ni.exports]);function ai(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===L(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),r=ri.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,dr(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}}function oi(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e,r;(this._sctp=null,"chrome"===t.browser&&t.version>=76)&&("plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}));if(function(e){if(!e||!e.sdp)return!1;var t=ri.splitSections(e.sdp);return t.shift(),t.some(function(e){var t=ri.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var i,a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),o=(e=a,r=65536,"firefox"===t.browser&&(r=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),r),s=function(e,n){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var i=ri.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r}(arguments[0],a);i=0===o&&0===s?Number.POSITIVE_INFINITY:0===o||0===s?Math.max(o,s):Math.min(o,s);var c={};Object.defineProperty(c,"maxMessageSize",{get:function(){return i}}),this._sctp=c}return n.apply(this,arguments)}}}function si(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},dr(e,"datachannel",function(e){return n(e.channel,e.target),e})}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}function ci(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}}function ui(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71||"safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var r=t.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return n.apply(this,arguments)}}}function di(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function li(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!==L(t)||t.type&&t.sdp)return n.apply(this,arguments);if(!(t={type:t.type,sdp:t.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}return t.sdp||"offer"!==t.type&&"answer"!==t.type?n.apply(this,[t]):("offer"===t.type?this.createOffer:this.createAnswer).apply(this).then(function(t){return n.apply(e,[t])})})}}var pi,fi,hi,vi=Object.freeze({__proto__:null,shimRTCIceCandidate:ai,shimMaxMessageSize:oi,shimSendThrowTypeError:si,shimConnectionState:ci,removeExtmapAllowMixed:ui,shimAddIceCandidateNullOrEmpty:di,shimParameterlessSetLocalDescription:li});function mi(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},n=fr,r=vr(e),i={browserDetails:r,commonShim:vi,extractVersion:ur,disableLog:lr,disableWarnings:pr,sdp:ii};switch(r.browser){case"chrome":if(!Dr||!Nr||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=Dr,di(e,r),li(e),Sr(e,r),Cr(e),Nr(e,r),Tr(e),Or(e,r),Pr(e),Er(e),xr(e),Ir(e,r),ai(e),ci(e),oi(e,r),si(e),ui(e,r);break;case"firefox":if(!Wr||!_r||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=Wr,di(e,r),li(e),Ar(e,r),_r(e,r),Lr(e),Br(e),Mr(e),jr(e),Jr(e),$r(e),Fr(e),Vr(e),qr(e),ai(e),ci(e),oi(e,r),si(e);break;case"safari":if(!ti||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=ti,di(e,r),li(e),Kr(e),Xr(e),zr(e),Gr(e),Qr(e),Yr(e),Hr(e),ei(e),ai(e),oi(e,r),si(e),ui(e,r);break;default:n("Unsupported browser!")}return i}function gi(e){switch(e){case 0:case"PUBLISHER":return pi.PUBLISHER;case 1:case"SUBSCRIBER":return pi.SUBSCRIBER;case-1:case"UNRECOGNIZED":default:return pi.UNRECOGNIZED}}function bi(e){switch(e){case pi.PUBLISHER:return"PUBLISHER";case pi.SUBSCRIBER:return"SUBSCRIBER";case pi.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function ki(e){switch(e){case 0:case"ACTIVE":return fi.ACTIVE;case 1:case"PAUSED":return fi.PAUSED;case-1:case"UNRECOGNIZED":default:return fi.UNRECOGNIZED}}function yi(e){switch(e){case fi.ACTIVE:return"ACTIVE";case fi.PAUSED:return"PAUSED";case fi.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function Si(e){switch(e){case 0:case"UDP":return hi.UDP;case 1:case"TCP":return hi.TCP;case 2:case"TLS":return hi.TLS;case-1:case"UNRECOGNIZED":default:return hi.UNRECOGNIZED}}function wi(e){switch(e){case hi.UDP:return"UDP";case hi.TCP:return"TCP";case hi.TLS:return"TLS";case hi.UNRECOGNIZED:default:return"UNRECOGNIZED"}}function Ci(){return{message:void 0}}mi({window:"undefined"==typeof window?void 0:window}),function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(pi||(pi={})),function(e){e[e.ACTIVE=0]="ACTIVE",e[e.PAUSED=1]="PAUSED",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(fi||(fi={})),function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.TLS=2]="TLS",e[e.UNRECOGNIZED=-1]="UNRECOGNIZED"}(hi||(hi={}));var Ti={encode:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return"offer"===(null===(t=e.message)||void 0===t?void 0:t.$case)&&Fi.encode(e.message.offer,h.uint32(10).fork()).ldelim(),"answer"===(null===(n=e.message)||void 0===n?void 0:n.$case)&&Fi.encode(e.message.answer,h.uint32(18).fork()).ldelim(),"trickle"===(null===(r=e.message)||void 0===r?void 0:r.$case)&&Di.encode(e.message.trickle,h.uint32(26).fork()).ldelim(),"addTrack"===(null===(i=e.message)||void 0===i?void 0:i.$case)&&Ni.encode(e.message.addTrack,h.uint32(34).fork()).ldelim(),"mute"===(null===(a=e.message)||void 0===a?void 0:a.$case)&&Ui.encode(e.message.mute,h.uint32(42).fork()).ldelim(),"subscription"===(null===(o=e.message)||void 0===o?void 0:o.$case)&&Gi.encode(e.message.subscription,h.uint32(50).fork()).ldelim(),"trackSetting"===(null===(s=e.message)||void 0===s?void 0:s.$case)&&zi.encode(e.message.trackSetting,h.uint32(58).fork()).ldelim(),"leave"===(null===(c=e.message)||void 0===c?void 0:c.$case)&&Zi.encode(e.message.leave,h.uint32(66).fork()).ldelim(),"updateLayers"===(null===(u=e.message)||void 0===u?void 0:u.$case)&&Yi.encode(e.message.updateLayers,h.uint32(82).fork()).ldelim(),"subscriptionPermission"===(null===(d=e.message)||void 0===d?void 0:d.$case)&&wa.encode(e.message.subscriptionPermission,h.uint32(90).fork()).ldelim(),"syncState"===(null===(l=e.message)||void 0===l?void 0:l.$case)&&Ea.encode(e.message.syncState,h.uint32(98).fork()).ldelim(),"simulate"===(null===(p=e.message)||void 0===p?void 0:p.$case)&&Na.encode(e.message.simulate,h.uint32(106).fork()).ldelim(),"ping"===(null===(f=e.message)||void 0===f?void 0:f.$case)&&h.uint32(112).int64(e.message.ping),h},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Ci();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.message={$case:"offer",offer:Fi.decode(n,n.uint32())};break;case 2:i.message={$case:"answer",answer:Fi.decode(n,n.uint32())};break;case 3:i.message={$case:"trickle",trickle:Di.decode(n,n.uint32())};break;case 4:i.message={$case:"addTrack",addTrack:Ni.decode(n,n.uint32())};break;case 5:i.message={$case:"mute",mute:Ui.decode(n,n.uint32())};break;case 6:i.message={$case:"subscription",subscription:Gi.decode(n,n.uint32())};break;case 7:i.message={$case:"trackSetting",trackSetting:zi.decode(n,n.uint32())};break;case 8:i.message={$case:"leave",leave:Zi.decode(n,n.uint32())};break;case 10:i.message={$case:"updateLayers",updateLayers:Yi.decode(n,n.uint32())};break;case 11:i.message={$case:"subscriptionPermission",subscriptionPermission:wa.decode(n,n.uint32())};break;case 12:i.message={$case:"syncState",syncState:Ea.decode(n,n.uint32())};break;case 13:i.message={$case:"simulate",simulate:Na.decode(n,n.uint32())};break;case 14:i.message={$case:"ping",ping:Da(n.int64())};break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{message:Aa(e.offer)?{$case:"offer",offer:Fi.fromJSON(e.offer)}:Aa(e.answer)?{$case:"answer",answer:Fi.fromJSON(e.answer)}:Aa(e.trickle)?{$case:"trickle",trickle:Di.fromJSON(e.trickle)}:Aa(e.addTrack)?{$case:"addTrack",addTrack:Ni.fromJSON(e.addTrack)}:Aa(e.mute)?{$case:"mute",mute:Ui.fromJSON(e.mute)}:Aa(e.subscription)?{$case:"subscription",subscription:Gi.fromJSON(e.subscription)}:Aa(e.trackSetting)?{$case:"trackSetting",trackSetting:zi.fromJSON(e.trackSetting)}:Aa(e.leave)?{$case:"leave",leave:Zi.fromJSON(e.leave)}:Aa(e.updateLayers)?{$case:"updateLayers",updateLayers:Yi.fromJSON(e.updateLayers)}:Aa(e.subscriptionPermission)?{$case:"subscriptionPermission",subscriptionPermission:wa.fromJSON(e.subscriptionPermission)}:Aa(e.syncState)?{$case:"syncState",syncState:Ea.fromJSON(e.syncState)}:Aa(e.simulate)?{$case:"simulate",simulate:Na.fromJSON(e.simulate)}:Aa(e.ping)?{$case:"ping",ping:Number(e.ping)}:void 0}},toJSON:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h,v,m,g,b,k,y,S,w,C,T,P,E,x,R,O,N,I,D,A,U,L,_,M,j,B={};return"offer"===(null===(t=e.message)||void 0===t?void 0:t.$case)&&(B.offer=(null===(n=e.message)||void 0===n?void 0:n.offer)?Fi.toJSON(null===(r=e.message)||void 0===r?void 0:r.offer):void 0),"answer"===(null===(i=e.message)||void 0===i?void 0:i.$case)&&(B.answer=(null===(a=e.message)||void 0===a?void 0:a.answer)?Fi.toJSON(null===(o=e.message)||void 0===o?void 0:o.answer):void 0),"trickle"===(null===(s=e.message)||void 0===s?void 0:s.$case)&&(B.trickle=(null===(c=e.message)||void 0===c?void 0:c.trickle)?Di.toJSON(null===(u=e.message)||void 0===u?void 0:u.trickle):void 0),"addTrack"===(null===(d=e.message)||void 0===d?void 0:d.$case)&&(B.addTrack=(null===(l=e.message)||void 0===l?void 0:l.addTrack)?Ni.toJSON(null===(p=e.message)||void 0===p?void 0:p.addTrack):void 0),"mute"===(null===(f=e.message)||void 0===f?void 0:f.$case)&&(B.mute=(null===(h=e.message)||void 0===h?void 0:h.mute)?Ui.toJSON(null===(v=e.message)||void 0===v?void 0:v.mute):void 0),"subscription"===(null===(m=e.message)||void 0===m?void 0:m.$case)&&(B.subscription=(null===(g=e.message)||void 0===g?void 0:g.subscription)?Gi.toJSON(null===(b=e.message)||void 0===b?void 0:b.subscription):void 0),"trackSetting"===(null===(k=e.message)||void 0===k?void 0:k.$case)&&(B.trackSetting=(null===(y=e.message)||void 0===y?void 0:y.trackSetting)?zi.toJSON(null===(S=e.message)||void 0===S?void 0:S.trackSetting):void 0),"leave"===(null===(w=e.message)||void 0===w?void 0:w.$case)&&(B.leave=(null===(C=e.message)||void 0===C?void 0:C.leave)?Zi.toJSON(null===(T=e.message)||void 0===T?void 0:T.leave):void 0),"updateLayers"===(null===(P=e.message)||void 0===P?void 0:P.$case)&&(B.updateLayers=(null===(E=e.message)||void 0===E?void 0:E.updateLayers)?Yi.toJSON(null===(x=e.message)||void 0===x?void 0:x.updateLayers):void 0),"subscriptionPermission"===(null===(R=e.message)||void 0===R?void 0:R.$case)&&(B.subscriptionPermission=(null===(O=e.message)||void 0===O?void 0:O.subscriptionPermission)?wa.toJSON(null===(N=e.message)||void 0===N?void 0:N.subscriptionPermission):void 0),"syncState"===(null===(I=e.message)||void 0===I?void 0:I.$case)&&(B.syncState=(null===(D=e.message)||void 0===D?void 0:D.syncState)?Ea.toJSON(null===(A=e.message)||void 0===A?void 0:A.syncState):void 0),"simulate"===(null===(U=e.message)||void 0===U?void 0:U.$case)&&(B.simulate=(null===(L=e.message)||void 0===L?void 0:L.simulate)?Na.toJSON(null===(_=e.message)||void 0===_?void 0:_.simulate):void 0),"ping"===(null===(M=e.message)||void 0===M?void 0:M.$case)&&(B.ping=Math.round(null===(j=e.message)||void 0===j?void 0:j.ping)),B},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h,v,m,g,b,k,y,S,w,C,T,P,E,x,R,O,N,I,D,A,U,L,_,M,j,B,J=Ci();return"offer"===(null===(t=e.message)||void 0===t?void 0:t.$case)&&void 0!==(null===(n=e.message)||void 0===n?void 0:n.offer)&&null!==(null===(r=e.message)||void 0===r?void 0:r.offer)&&(J.message={$case:"offer",offer:Fi.fromPartial(e.message.offer)}),"answer"===(null===(i=e.message)||void 0===i?void 0:i.$case)&&void 0!==(null===(a=e.message)||void 0===a?void 0:a.answer)&&null!==(null===(o=e.message)||void 0===o?void 0:o.answer)&&(J.message={$case:"answer",answer:Fi.fromPartial(e.message.answer)}),"trickle"===(null===(s=e.message)||void 0===s?void 0:s.$case)&&void 0!==(null===(c=e.message)||void 0===c?void 0:c.trickle)&&null!==(null===(u=e.message)||void 0===u?void 0:u.trickle)&&(J.message={$case:"trickle",trickle:Di.fromPartial(e.message.trickle)}),"addTrack"===(null===(d=e.message)||void 0===d?void 0:d.$case)&&void 0!==(null===(l=e.message)||void 0===l?void 0:l.addTrack)&&null!==(null===(p=e.message)||void 0===p?void 0:p.addTrack)&&(J.message={$case:"addTrack",addTrack:Ni.fromPartial(e.message.addTrack)}),"mute"===(null===(f=e.message)||void 0===f?void 0:f.$case)&&void 0!==(null===(h=e.message)||void 0===h?void 0:h.mute)&&null!==(null===(v=e.message)||void 0===v?void 0:v.mute)&&(J.message={$case:"mute",mute:Ui.fromPartial(e.message.mute)}),"subscription"===(null===(m=e.message)||void 0===m?void 0:m.$case)&&void 0!==(null===(g=e.message)||void 0===g?void 0:g.subscription)&&null!==(null===(b=e.message)||void 0===b?void 0:b.subscription)&&(J.message={$case:"subscription",subscription:Gi.fromPartial(e.message.subscription)}),"trackSetting"===(null===(k=e.message)||void 0===k?void 0:k.$case)&&void 0!==(null===(y=e.message)||void 0===y?void 0:y.trackSetting)&&null!==(null===(S=e.message)||void 0===S?void 0:S.trackSetting)&&(J.message={$case:"trackSetting",trackSetting:zi.fromPartial(e.message.trackSetting)}),"leave"===(null===(w=e.message)||void 0===w?void 0:w.$case)&&void 0!==(null===(C=e.message)||void 0===C?void 0:C.leave)&&null!==(null===(T=e.message)||void 0===T?void 0:T.leave)&&(J.message={$case:"leave",leave:Zi.fromPartial(e.message.leave)}),"updateLayers"===(null===(P=e.message)||void 0===P?void 0:P.$case)&&void 0!==(null===(E=e.message)||void 0===E?void 0:E.updateLayers)&&null!==(null===(x=e.message)||void 0===x?void 0:x.updateLayers)&&(J.message={$case:"updateLayers",updateLayers:Yi.fromPartial(e.message.updateLayers)}),"subscriptionPermission"===(null===(R=e.message)||void 0===R?void 0:R.$case)&&void 0!==(null===(O=e.message)||void 0===O?void 0:O.subscriptionPermission)&&null!==(null===(N=e.message)||void 0===N?void 0:N.subscriptionPermission)&&(J.message={$case:"subscriptionPermission",subscriptionPermission:wa.fromPartial(e.message.subscriptionPermission)}),"syncState"===(null===(I=e.message)||void 0===I?void 0:I.$case)&&void 0!==(null===(D=e.message)||void 0===D?void 0:D.syncState)&&null!==(null===(A=e.message)||void 0===A?void 0:A.syncState)&&(J.message={$case:"syncState",syncState:Ea.fromPartial(e.message.syncState)}),"simulate"===(null===(U=e.message)||void 0===U?void 0:U.$case)&&void 0!==(null===(L=e.message)||void 0===L?void 0:L.simulate)&&null!==(null===(_=e.message)||void 0===_?void 0:_.simulate)&&(J.message={$case:"simulate",simulate:Na.fromPartial(e.message.simulate)}),"ping"===(null===(M=e.message)||void 0===M?void 0:M.$case)&&void 0!==(null===(j=e.message)||void 0===j?void 0:j.ping)&&null!==(null===(B=e.message)||void 0===B?void 0:B.ping)&&(J.message={$case:"ping",ping:e.message.ping}),J}};function Pi(){return{message:void 0}}var Ei={encode:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h,v,m,g,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return"join"===(null===(t=e.message)||void 0===t?void 0:t.$case)&&_i.encode(e.message.join,b.uint32(10).fork()).ldelim(),"answer"===(null===(n=e.message)||void 0===n?void 0:n.$case)&&Fi.encode(e.message.answer,b.uint32(18).fork()).ldelim(),"offer"===(null===(r=e.message)||void 0===r?void 0:r.$case)&&Fi.encode(e.message.offer,b.uint32(26).fork()).ldelim(),"trickle"===(null===(i=e.message)||void 0===i?void 0:i.$case)&&Di.encode(e.message.trickle,b.uint32(34).fork()).ldelim(),"update"===(null===(a=e.message)||void 0===a?void 0:a.$case)&&qi.encode(e.message.update,b.uint32(42).fork()).ldelim(),"trackPublished"===(null===(o=e.message)||void 0===o?void 0:o.$case)&&ji.encode(e.message.trackPublished,b.uint32(50).fork()).ldelim(),"leave"===(null===(s=e.message)||void 0===s?void 0:s.$case)&&Zi.encode(e.message.leave,b.uint32(66).fork()).ldelim(),"mute"===(null===(c=e.message)||void 0===c?void 0:c.$case)&&Ui.encode(e.message.mute,b.uint32(74).fork()).ldelim(),"speakersChanged"===(null===(u=e.message)||void 0===u?void 0:u.$case)&&na.encode(e.message.speakersChanged,b.uint32(82).fork()).ldelim(),"roomUpdate"===(null===(d=e.message)||void 0===d?void 0:d.$case)&&ia.encode(e.message.roomUpdate,b.uint32(90).fork()).ldelim(),"connectionQuality"===(null===(l=e.message)||void 0===l?void 0:l.$case)&&ca.encode(e.message.connectionQuality,b.uint32(98).fork()).ldelim(),"streamStateUpdate"===(null===(p=e.message)||void 0===p?void 0:p.$case)&&pa.encode(e.message.streamStateUpdate,b.uint32(106).fork()).ldelim(),"subscribedQualityUpdate"===(null===(f=e.message)||void 0===f?void 0:f.$case)&&ba.encode(e.message.subscribedQualityUpdate,b.uint32(114).fork()).ldelim(),"subscriptionPermissionUpdate"===(null===(h=e.message)||void 0===h?void 0:h.$case)&&Ta.encode(e.message.subscriptionPermissionUpdate,b.uint32(122).fork()).ldelim(),"refreshToken"===(null===(v=e.message)||void 0===v?void 0:v.$case)&&b.uint32(130).string(e.message.refreshToken),"trackUnpublished"===(null===(m=e.message)||void 0===m?void 0:m.$case)&&Ji.encode(e.message.trackUnpublished,b.uint32(138).fork()).ldelim(),"pong"===(null===(g=e.message)||void 0===g?void 0:g.$case)&&b.uint32(144).int64(e.message.pong),b},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Pi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.message={$case:"join",join:_i.decode(n,n.uint32())};break;case 2:i.message={$case:"answer",answer:Fi.decode(n,n.uint32())};break;case 3:i.message={$case:"offer",offer:Fi.decode(n,n.uint32())};break;case 4:i.message={$case:"trickle",trickle:Di.decode(n,n.uint32())};break;case 5:i.message={$case:"update",update:qi.decode(n,n.uint32())};break;case 6:i.message={$case:"trackPublished",trackPublished:ji.decode(n,n.uint32())};break;case 8:i.message={$case:"leave",leave:Zi.decode(n,n.uint32())};break;case 9:i.message={$case:"mute",mute:Ui.decode(n,n.uint32())};break;case 10:i.message={$case:"speakersChanged",speakersChanged:na.decode(n,n.uint32())};break;case 11:i.message={$case:"roomUpdate",roomUpdate:ia.decode(n,n.uint32())};break;case 12:i.message={$case:"connectionQuality",connectionQuality:ca.decode(n,n.uint32())};break;case 13:i.message={$case:"streamStateUpdate",streamStateUpdate:pa.decode(n,n.uint32())};break;case 14:i.message={$case:"subscribedQualityUpdate",subscribedQualityUpdate:ba.decode(n,n.uint32())};break;case 15:i.message={$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:Ta.decode(n,n.uint32())};break;case 16:i.message={$case:"refreshToken",refreshToken:n.string()};break;case 17:i.message={$case:"trackUnpublished",trackUnpublished:Ji.decode(n,n.uint32())};break;case 18:i.message={$case:"pong",pong:Da(n.int64())};break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{message:Aa(e.join)?{$case:"join",join:_i.fromJSON(e.join)}:Aa(e.answer)?{$case:"answer",answer:Fi.fromJSON(e.answer)}:Aa(e.offer)?{$case:"offer",offer:Fi.fromJSON(e.offer)}:Aa(e.trickle)?{$case:"trickle",trickle:Di.fromJSON(e.trickle)}:Aa(e.update)?{$case:"update",update:qi.fromJSON(e.update)}:Aa(e.trackPublished)?{$case:"trackPublished",trackPublished:ji.fromJSON(e.trackPublished)}:Aa(e.leave)?{$case:"leave",leave:Zi.fromJSON(e.leave)}:Aa(e.mute)?{$case:"mute",mute:Ui.fromJSON(e.mute)}:Aa(e.speakersChanged)?{$case:"speakersChanged",speakersChanged:na.fromJSON(e.speakersChanged)}:Aa(e.roomUpdate)?{$case:"roomUpdate",roomUpdate:ia.fromJSON(e.roomUpdate)}:Aa(e.connectionQuality)?{$case:"connectionQuality",connectionQuality:ca.fromJSON(e.connectionQuality)}:Aa(e.streamStateUpdate)?{$case:"streamStateUpdate",streamStateUpdate:pa.fromJSON(e.streamStateUpdate)}:Aa(e.subscribedQualityUpdate)?{$case:"subscribedQualityUpdate",subscribedQualityUpdate:ba.fromJSON(e.subscribedQualityUpdate)}:Aa(e.subscriptionPermissionUpdate)?{$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:Ta.fromJSON(e.subscriptionPermissionUpdate)}:Aa(e.refreshToken)?{$case:"refreshToken",refreshToken:String(e.refreshToken)}:Aa(e.trackUnpublished)?{$case:"trackUnpublished",trackUnpublished:Ji.fromJSON(e.trackUnpublished)}:Aa(e.pong)?{$case:"pong",pong:Number(e.pong)}:void 0}},toJSON:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h,v,m,g,b,k,y,S,w,C,T,P,E,x,R,O,N,I,D,A,U,L,_,M,j,B,J,$,F,V,q,W,G,Q,z,H,Z={};return"join"===(null===(t=e.message)||void 0===t?void 0:t.$case)&&(Z.join=(null===(n=e.message)||void 0===n?void 0:n.join)?_i.toJSON(null===(r=e.message)||void 0===r?void 0:r.join):void 0),"answer"===(null===(i=e.message)||void 0===i?void 0:i.$case)&&(Z.answer=(null===(a=e.message)||void 0===a?void 0:a.answer)?Fi.toJSON(null===(o=e.message)||void 0===o?void 0:o.answer):void 0),"offer"===(null===(s=e.message)||void 0===s?void 0:s.$case)&&(Z.offer=(null===(c=e.message)||void 0===c?void 0:c.offer)?Fi.toJSON(null===(u=e.message)||void 0===u?void 0:u.offer):void 0),"trickle"===(null===(d=e.message)||void 0===d?void 0:d.$case)&&(Z.trickle=(null===(l=e.message)||void 0===l?void 0:l.trickle)?Di.toJSON(null===(p=e.message)||void 0===p?void 0:p.trickle):void 0),"update"===(null===(f=e.message)||void 0===f?void 0:f.$case)&&(Z.update=(null===(h=e.message)||void 0===h?void 0:h.update)?qi.toJSON(null===(v=e.message)||void 0===v?void 0:v.update):void 0),"trackPublished"===(null===(m=e.message)||void 0===m?void 0:m.$case)&&(Z.trackPublished=(null===(g=e.message)||void 0===g?void 0:g.trackPublished)?ji.toJSON(null===(b=e.message)||void 0===b?void 0:b.trackPublished):void 0),"leave"===(null===(k=e.message)||void 0===k?void 0:k.$case)&&(Z.leave=(null===(y=e.message)||void 0===y?void 0:y.leave)?Zi.toJSON(null===(S=e.message)||void 0===S?void 0:S.leave):void 0),"mute"===(null===(w=e.message)||void 0===w?void 0:w.$case)&&(Z.mute=(null===(C=e.message)||void 0===C?void 0:C.mute)?Ui.toJSON(null===(T=e.message)||void 0===T?void 0:T.mute):void 0),"speakersChanged"===(null===(P=e.message)||void 0===P?void 0:P.$case)&&(Z.speakersChanged=(null===(E=e.message)||void 0===E?void 0:E.speakersChanged)?na.toJSON(null===(x=e.message)||void 0===x?void 0:x.speakersChanged):void 0),"roomUpdate"===(null===(R=e.message)||void 0===R?void 0:R.$case)&&(Z.roomUpdate=(null===(O=e.message)||void 0===O?void 0:O.roomUpdate)?ia.toJSON(null===(N=e.message)||void 0===N?void 0:N.roomUpdate):void 0),"connectionQuality"===(null===(I=e.message)||void 0===I?void 0:I.$case)&&(Z.connectionQuality=(null===(D=e.message)||void 0===D?void 0:D.connectionQuality)?ca.toJSON(null===(A=e.message)||void 0===A?void 0:A.connectionQuality):void 0),"streamStateUpdate"===(null===(U=e.message)||void 0===U?void 0:U.$case)&&(Z.streamStateUpdate=(null===(L=e.message)||void 0===L?void 0:L.streamStateUpdate)?pa.toJSON(null===(_=e.message)||void 0===_?void 0:_.streamStateUpdate):void 0),"subscribedQualityUpdate"===(null===(M=e.message)||void 0===M?void 0:M.$case)&&(Z.subscribedQualityUpdate=(null===(j=e.message)||void 0===j?void 0:j.subscribedQualityUpdate)?ba.toJSON(null===(B=e.message)||void 0===B?void 0:B.subscribedQualityUpdate):void 0),"subscriptionPermissionUpdate"===(null===(J=e.message)||void 0===J?void 0:J.$case)&&(Z.subscriptionPermissionUpdate=(null===($=e.message)||void 0===$?void 0:$.subscriptionPermissionUpdate)?Ta.toJSON(null===(F=e.message)||void 0===F?void 0:F.subscriptionPermissionUpdate):void 0),"refreshToken"===(null===(V=e.message)||void 0===V?void 0:V.$case)&&(Z.refreshToken=null===(q=e.message)||void 0===q?void 0:q.refreshToken),"trackUnpublished"===(null===(W=e.message)||void 0===W?void 0:W.$case)&&(Z.trackUnpublished=(null===(G=e.message)||void 0===G?void 0:G.trackUnpublished)?Ji.toJSON(null===(Q=e.message)||void 0===Q?void 0:Q.trackUnpublished):void 0),"pong"===(null===(z=e.message)||void 0===z?void 0:z.$case)&&(Z.pong=Math.round(null===(H=e.message)||void 0===H?void 0:H.pong)),Z},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h,v,m,g,b,k,y,S,w,C,T,P,E,x,R,O,N,I,D,A,U,L,_,M,j,B,J,$,F,V,q,W,G,Q,z,H,Z,K,Y=Pi();return"join"===(null===(t=e.message)||void 0===t?void 0:t.$case)&&void 0!==(null===(n=e.message)||void 0===n?void 0:n.join)&&null!==(null===(r=e.message)||void 0===r?void 0:r.join)&&(Y.message={$case:"join",join:_i.fromPartial(e.message.join)}),"answer"===(null===(i=e.message)||void 0===i?void 0:i.$case)&&void 0!==(null===(a=e.message)||void 0===a?void 0:a.answer)&&null!==(null===(o=e.message)||void 0===o?void 0:o.answer)&&(Y.message={$case:"answer",answer:Fi.fromPartial(e.message.answer)}),"offer"===(null===(s=e.message)||void 0===s?void 0:s.$case)&&void 0!==(null===(c=e.message)||void 0===c?void 0:c.offer)&&null!==(null===(u=e.message)||void 0===u?void 0:u.offer)&&(Y.message={$case:"offer",offer:Fi.fromPartial(e.message.offer)}),"trickle"===(null===(d=e.message)||void 0===d?void 0:d.$case)&&void 0!==(null===(l=e.message)||void 0===l?void 0:l.trickle)&&null!==(null===(p=e.message)||void 0===p?void 0:p.trickle)&&(Y.message={$case:"trickle",trickle:Di.fromPartial(e.message.trickle)}),"update"===(null===(f=e.message)||void 0===f?void 0:f.$case)&&void 0!==(null===(h=e.message)||void 0===h?void 0:h.update)&&null!==(null===(v=e.message)||void 0===v?void 0:v.update)&&(Y.message={$case:"update",update:qi.fromPartial(e.message.update)}),"trackPublished"===(null===(m=e.message)||void 0===m?void 0:m.$case)&&void 0!==(null===(g=e.message)||void 0===g?void 0:g.trackPublished)&&null!==(null===(b=e.message)||void 0===b?void 0:b.trackPublished)&&(Y.message={$case:"trackPublished",trackPublished:ji.fromPartial(e.message.trackPublished)}),"leave"===(null===(k=e.message)||void 0===k?void 0:k.$case)&&void 0!==(null===(y=e.message)||void 0===y?void 0:y.leave)&&null!==(null===(S=e.message)||void 0===S?void 0:S.leave)&&(Y.message={$case:"leave",leave:Zi.fromPartial(e.message.leave)}),"mute"===(null===(w=e.message)||void 0===w?void 0:w.$case)&&void 0!==(null===(C=e.message)||void 0===C?void 0:C.mute)&&null!==(null===(T=e.message)||void 0===T?void 0:T.mute)&&(Y.message={$case:"mute",mute:Ui.fromPartial(e.message.mute)}),"speakersChanged"===(null===(P=e.message)||void 0===P?void 0:P.$case)&&void 0!==(null===(E=e.message)||void 0===E?void 0:E.speakersChanged)&&null!==(null===(x=e.message)||void 0===x?void 0:x.speakersChanged)&&(Y.message={$case:"speakersChanged",speakersChanged:na.fromPartial(e.message.speakersChanged)}),"roomUpdate"===(null===(R=e.message)||void 0===R?void 0:R.$case)&&void 0!==(null===(O=e.message)||void 0===O?void 0:O.roomUpdate)&&null!==(null===(N=e.message)||void 0===N?void 0:N.roomUpdate)&&(Y.message={$case:"roomUpdate",roomUpdate:ia.fromPartial(e.message.roomUpdate)}),"connectionQuality"===(null===(I=e.message)||void 0===I?void 0:I.$case)&&void 0!==(null===(D=e.message)||void 0===D?void 0:D.connectionQuality)&&null!==(null===(A=e.message)||void 0===A?void 0:A.connectionQuality)&&(Y.message={$case:"connectionQuality",connectionQuality:ca.fromPartial(e.message.connectionQuality)}),"streamStateUpdate"===(null===(U=e.message)||void 0===U?void 0:U.$case)&&void 0!==(null===(L=e.message)||void 0===L?void 0:L.streamStateUpdate)&&null!==(null===(_=e.message)||void 0===_?void 0:_.streamStateUpdate)&&(Y.message={$case:"streamStateUpdate",streamStateUpdate:pa.fromPartial(e.message.streamStateUpdate)}),"subscribedQualityUpdate"===(null===(M=e.message)||void 0===M?void 0:M.$case)&&void 0!==(null===(j=e.message)||void 0===j?void 0:j.subscribedQualityUpdate)&&null!==(null===(B=e.message)||void 0===B?void 0:B.subscribedQualityUpdate)&&(Y.message={$case:"subscribedQualityUpdate",subscribedQualityUpdate:ba.fromPartial(e.message.subscribedQualityUpdate)}),"subscriptionPermissionUpdate"===(null===(J=e.message)||void 0===J?void 0:J.$case)&&void 0!==(null===($=e.message)||void 0===$?void 0:$.subscriptionPermissionUpdate)&&null!==(null===(F=e.message)||void 0===F?void 0:F.subscriptionPermissionUpdate)&&(Y.message={$case:"subscriptionPermissionUpdate",subscriptionPermissionUpdate:Ta.fromPartial(e.message.subscriptionPermissionUpdate)}),"refreshToken"===(null===(V=e.message)||void 0===V?void 0:V.$case)&&void 0!==(null===(q=e.message)||void 0===q?void 0:q.refreshToken)&&null!==(null===(W=e.message)||void 0===W?void 0:W.refreshToken)&&(Y.message={$case:"refreshToken",refreshToken:e.message.refreshToken}),"trackUnpublished"===(null===(G=e.message)||void 0===G?void 0:G.$case)&&void 0!==(null===(Q=e.message)||void 0===Q?void 0:Q.trackUnpublished)&&null!==(null===(z=e.message)||void 0===z?void 0:z.trackUnpublished)&&(Y.message={$case:"trackUnpublished",trackUnpublished:Ji.fromPartial(e.message.trackUnpublished)}),"pong"===(null===(H=e.message)||void 0===H?void 0:H.$case)&&void 0!==(null===(Z=e.message)||void 0===Z?void 0:Z.pong)&&null!==(null===(K=e.message)||void 0===K?void 0:K.pong)&&(Y.message={$case:"pong",pong:e.message.pong}),Y}};function xi(){return{codec:"",cid:"",enableSimulcastLayers:!1}}var Ri={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.codec&&t.uint32(10).string(e.codec),""!==e.cid&&t.uint32(18).string(e.cid),!0===e.enableSimulcastLayers&&t.uint32(24).bool(e.enableSimulcastLayers),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=xi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.codec=n.string();break;case 2:i.cid=n.string();break;case 3:i.enableSimulcastLayers=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{codec:Aa(e.codec)?String(e.codec):"",cid:Aa(e.cid)?String(e.cid):"",enableSimulcastLayers:!!Aa(e.enableSimulcastLayers)&&Boolean(e.enableSimulcastLayers)}},toJSON:function(e){var t={};return void 0!==e.codec&&(t.codec=e.codec),void 0!==e.cid&&(t.cid=e.cid),void 0!==e.enableSimulcastLayers&&(t.enableSimulcastLayers=e.enableSimulcastLayers),t},fromPartial:function(e){var t,n,r,i=xi();return i.codec=null!==(t=e.codec)&&void 0!==t?t:"",i.cid=null!==(n=e.cid)&&void 0!==n?n:"",i.enableSimulcastLayers=null!==(r=e.enableSimulcastLayers)&&void 0!==r&&r,i}};function Oi(){return{cid:"",name:"",type:0,width:0,height:0,muted:!1,disableDtx:!1,source:0,layers:[],simulcastCodecs:[],sid:"",stereo:!1,disableRed:!1}}var Ni={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.cid&&t.uint32(10).string(e.cid),""!==e.name&&t.uint32(18).string(e.name),0!==e.type&&t.uint32(24).int32(e.type),0!==e.width&&t.uint32(32).uint32(e.width),0!==e.height&&t.uint32(40).uint32(e.height),!0===e.muted&&t.uint32(48).bool(e.muted),!0===e.disableDtx&&t.uint32(56).bool(e.disableDtx),0!==e.source&&t.uint32(64).int32(e.source);var n,r=D(e.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;xn.encode(i,t.uint32(74).fork()).ldelim()}}catch(c){r.e(c)}finally{r.f()}var a,o=D(e.simulcastCodecs);try{for(o.s();!(a=o.n()).done;){var s=a.value;Ri.encode(s,t.uint32(82).fork()).ldelim()}}catch(c){o.e(c)}finally{o.f()}return""!==e.sid&&t.uint32(90).string(e.sid),!0===e.stereo&&t.uint32(96).bool(e.stereo),!0===e.disableRed&&t.uint32(104).bool(e.disableRed),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Oi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.cid=n.string();break;case 2:i.name=n.string();break;case 3:i.type=n.int32();break;case 4:i.width=n.uint32();break;case 5:i.height=n.uint32();break;case 6:i.muted=n.bool();break;case 7:i.disableDtx=n.bool();break;case 8:i.source=n.int32();break;case 9:i.layers.push(xn.decode(n,n.uint32()));break;case 10:i.simulcastCodecs.push(Ri.decode(n,n.uint32()));break;case 11:i.sid=n.string();break;case 12:i.stereo=n.bool();break;case 13:i.disableRed=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{cid:Aa(e.cid)?String(e.cid):"",name:Aa(e.name)?String(e.name):"",type:Aa(e.type)?Qt(e.type):0,width:Aa(e.width)?Number(e.width):0,height:Aa(e.height)?Number(e.height):0,muted:!!Aa(e.muted)&&Boolean(e.muted),disableDtx:!!Aa(e.disableDtx)&&Boolean(e.disableDtx),source:Aa(e.source)?Ht(e.source):0,layers:Array.isArray(null==e?void 0:e.layers)?e.layers.map(function(e){return xn.fromJSON(e)}):[],simulcastCodecs:Array.isArray(null==e?void 0:e.simulcastCodecs)?e.simulcastCodecs.map(function(e){return Ri.fromJSON(e)}):[],sid:Aa(e.sid)?String(e.sid):"",stereo:!!Aa(e.stereo)&&Boolean(e.stereo),disableRed:!!Aa(e.disableRed)&&Boolean(e.disableRed)}},toJSON:function(e){var t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.name&&(t.name=e.name),void 0!==e.type&&(t.type=zt(e.type)),void 0!==e.width&&(t.width=Math.round(e.width)),void 0!==e.height&&(t.height=Math.round(e.height)),void 0!==e.muted&&(t.muted=e.muted),void 0!==e.disableDtx&&(t.disableDtx=e.disableDtx),void 0!==e.source&&(t.source=Zt(e.source)),e.layers?t.layers=e.layers.map(function(e){return e?xn.toJSON(e):void 0}):t.layers=[],e.simulcastCodecs?t.simulcastCodecs=e.simulcastCodecs.map(function(e){return e?Ri.toJSON(e):void 0}):t.simulcastCodecs=[],void 0!==e.sid&&(t.sid=e.sid),void 0!==e.stereo&&(t.stereo=e.stereo),void 0!==e.disableRed&&(t.disableRed=e.disableRed),t},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h=Oi();return h.cid=null!==(t=e.cid)&&void 0!==t?t:"",h.name=null!==(n=e.name)&&void 0!==n?n:"",h.type=null!==(r=e.type)&&void 0!==r?r:0,h.width=null!==(i=e.width)&&void 0!==i?i:0,h.height=null!==(a=e.height)&&void 0!==a?a:0,h.muted=null!==(o=e.muted)&&void 0!==o&&o,h.disableDtx=null!==(s=e.disableDtx)&&void 0!==s&&s,h.source=null!==(c=e.source)&&void 0!==c?c:0,h.layers=(null===(u=e.layers)||void 0===u?void 0:u.map(function(e){return xn.fromPartial(e)}))||[],h.simulcastCodecs=(null===(d=e.simulcastCodecs)||void 0===d?void 0:d.map(function(e){return Ri.fromPartial(e)}))||[],h.sid=null!==(l=e.sid)&&void 0!==l?l:"",h.stereo=null!==(p=e.stereo)&&void 0!==p&&p,h.disableRed=null!==(f=e.disableRed)&&void 0!==f&&f,h}};function Ii(){return{candidateInit:"",target:0}}var Di={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.candidateInit&&t.uint32(10).string(e.candidateInit),0!==e.target&&t.uint32(16).int32(e.target),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Ii();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.candidateInit=n.string();break;case 2:i.target=n.int32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{candidateInit:Aa(e.candidateInit)?String(e.candidateInit):"",target:Aa(e.target)?gi(e.target):0}},toJSON:function(e){var t={};return void 0!==e.candidateInit&&(t.candidateInit=e.candidateInit),void 0!==e.target&&(t.target=bi(e.target)),t},fromPartial:function(e){var t,n,r=Ii();return r.candidateInit=null!==(t=e.candidateInit)&&void 0!==t?t:"",r.target=null!==(n=e.target)&&void 0!==n?n:0,r}};function Ai(){return{sid:"",muted:!1}}var Ui={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.sid&&t.uint32(10).string(e.sid),!0===e.muted&&t.uint32(16).bool(e.muted),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Ai();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.sid=n.string();break;case 2:i.muted=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{sid:Aa(e.sid)?String(e.sid):"",muted:!!Aa(e.muted)&&Boolean(e.muted)}},toJSON:function(e){var t={};return void 0!==e.sid&&(t.sid=e.sid),void 0!==e.muted&&(t.muted=e.muted),t},fromPartial:function(e){var t,n,r=Ai();return r.sid=null!==(t=e.sid)&&void 0!==t?t:"",r.muted=null!==(n=e.muted)&&void 0!==n&&n,r}};function Li(){return{room:void 0,participant:void 0,otherParticipants:[],serverVersion:"",iceServers:[],subscriberPrimary:!1,alternativeUrl:"",clientConfiguration:void 0,serverRegion:"",pingTimeout:0,pingInterval:0,serverInfo:void 0}}var _i={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();void 0!==e.room&&vn.encode(e.room,t.uint32(10).fork()).ldelim(),void 0!==e.participant&&Sn.encode(e.participant,t.uint32(18).fork()).ldelim();var n,r=D(e.otherParticipants);try{for(r.s();!(n=r.n()).done;){var i=n.value;Sn.encode(i,t.uint32(26).fork()).ldelim()}}catch(c){r.e(c)}finally{r.f()}""!==e.serverVersion&&t.uint32(34).string(e.serverVersion);var a,o=D(e.iceServers);try{for(o.s();!(a=o.n()).done;){var s=a.value;ea.encode(s,t.uint32(42).fork()).ldelim()}}catch(c){o.e(c)}finally{o.f()}return!0===e.subscriberPrimary&&t.uint32(48).bool(e.subscriberPrimary),""!==e.alternativeUrl&&t.uint32(58).string(e.alternativeUrl),void 0!==e.clientConfiguration&&Vn.encode(e.clientConfiguration,t.uint32(66).fork()).ldelim(),""!==e.serverRegion&&t.uint32(74).string(e.serverRegion),0!==e.pingTimeout&&t.uint32(80).int32(e.pingTimeout),0!==e.pingInterval&&t.uint32(88).int32(e.pingInterval),void 0!==e.serverInfo&&Bn.encode(e.serverInfo,t.uint32(98).fork()).ldelim(),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Li();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.room=vn.decode(n,n.uint32());break;case 2:i.participant=Sn.decode(n,n.uint32());break;case 3:i.otherParticipants.push(Sn.decode(n,n.uint32()));break;case 4:i.serverVersion=n.string();break;case 5:i.iceServers.push(ea.decode(n,n.uint32()));break;case 6:i.subscriberPrimary=n.bool();break;case 7:i.alternativeUrl=n.string();break;case 8:i.clientConfiguration=Vn.decode(n,n.uint32());break;case 9:i.serverRegion=n.string();break;case 10:i.pingTimeout=n.int32();break;case 11:i.pingInterval=n.int32();break;case 12:i.serverInfo=Bn.decode(n,n.uint32());break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{room:Aa(e.room)?vn.fromJSON(e.room):void 0,participant:Aa(e.participant)?Sn.fromJSON(e.participant):void 0,otherParticipants:Array.isArray(null==e?void 0:e.otherParticipants)?e.otherParticipants.map(function(e){return Sn.fromJSON(e)}):[],serverVersion:Aa(e.serverVersion)?String(e.serverVersion):"",iceServers:Array.isArray(null==e?void 0:e.iceServers)?e.iceServers.map(function(e){return ea.fromJSON(e)}):[],subscriberPrimary:!!Aa(e.subscriberPrimary)&&Boolean(e.subscriberPrimary),alternativeUrl:Aa(e.alternativeUrl)?String(e.alternativeUrl):"",clientConfiguration:Aa(e.clientConfiguration)?Vn.fromJSON(e.clientConfiguration):void 0,serverRegion:Aa(e.serverRegion)?String(e.serverRegion):"",pingTimeout:Aa(e.pingTimeout)?Number(e.pingTimeout):0,pingInterval:Aa(e.pingInterval)?Number(e.pingInterval):0,serverInfo:Aa(e.serverInfo)?Bn.fromJSON(e.serverInfo):void 0}},toJSON:function(e){var t={};return void 0!==e.room&&(t.room=e.room?vn.toJSON(e.room):void 0),void 0!==e.participant&&(t.participant=e.participant?Sn.toJSON(e.participant):void 0),e.otherParticipants?t.otherParticipants=e.otherParticipants.map(function(e){return e?Sn.toJSON(e):void 0}):t.otherParticipants=[],void 0!==e.serverVersion&&(t.serverVersion=e.serverVersion),e.iceServers?t.iceServers=e.iceServers.map(function(e){return e?ea.toJSON(e):void 0}):t.iceServers=[],void 0!==e.subscriberPrimary&&(t.subscriberPrimary=e.subscriberPrimary),void 0!==e.alternativeUrl&&(t.alternativeUrl=e.alternativeUrl),void 0!==e.clientConfiguration&&(t.clientConfiguration=e.clientConfiguration?Vn.toJSON(e.clientConfiguration):void 0),void 0!==e.serverRegion&&(t.serverRegion=e.serverRegion),void 0!==e.pingTimeout&&(t.pingTimeout=Math.round(e.pingTimeout)),void 0!==e.pingInterval&&(t.pingInterval=Math.round(e.pingInterval)),void 0!==e.serverInfo&&(t.serverInfo=e.serverInfo?Bn.toJSON(e.serverInfo):void 0),t},fromPartial:function(e){var t,n,r,i,a,o,s,c,u=Li();return u.room=void 0!==e.room&&null!==e.room?vn.fromPartial(e.room):void 0,u.participant=void 0!==e.participant&&null!==e.participant?Sn.fromPartial(e.participant):void 0,u.otherParticipants=(null===(t=e.otherParticipants)||void 0===t?void 0:t.map(function(e){return Sn.fromPartial(e)}))||[],u.serverVersion=null!==(n=e.serverVersion)&&void 0!==n?n:"",u.iceServers=(null===(r=e.iceServers)||void 0===r?void 0:r.map(function(e){return ea.fromPartial(e)}))||[],u.subscriberPrimary=null!==(i=e.subscriberPrimary)&&void 0!==i&&i,u.alternativeUrl=null!==(a=e.alternativeUrl)&&void 0!==a?a:"",u.clientConfiguration=void 0!==e.clientConfiguration&&null!==e.clientConfiguration?Vn.fromPartial(e.clientConfiguration):void 0,u.serverRegion=null!==(o=e.serverRegion)&&void 0!==o?o:"",u.pingTimeout=null!==(s=e.pingTimeout)&&void 0!==s?s:0,u.pingInterval=null!==(c=e.pingInterval)&&void 0!==c?c:0,u.serverInfo=void 0!==e.serverInfo&&null!==e.serverInfo?Bn.fromPartial(e.serverInfo):void 0,u}};function Mi(){return{cid:"",track:void 0}}var ji={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.cid&&t.uint32(10).string(e.cid),void 0!==e.track&&Pn.encode(e.track,t.uint32(18).fork()).ldelim(),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Mi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.cid=n.string();break;case 2:i.track=Pn.decode(n,n.uint32());break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{cid:Aa(e.cid)?String(e.cid):"",track:Aa(e.track)?Pn.fromJSON(e.track):void 0}},toJSON:function(e){var t={};return void 0!==e.cid&&(t.cid=e.cid),void 0!==e.track&&(t.track=e.track?Pn.toJSON(e.track):void 0),t},fromPartial:function(e){var t,n=Mi();return n.cid=null!==(t=e.cid)&&void 0!==t?t:"",n.track=void 0!==e.track&&null!==e.track?Pn.fromPartial(e.track):void 0,n}};function Bi(){return{trackSid:""}}var Ji={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.trackSid&&t.uint32(10).string(e.trackSid),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Bi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.trackSid=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{trackSid:Aa(e.trackSid)?String(e.trackSid):""}},toJSON:function(e){var t={};return void 0!==e.trackSid&&(t.trackSid=e.trackSid),t},fromPartial:function(e){var t,n=Bi();return n.trackSid=null!==(t=e.trackSid)&&void 0!==t?t:"",n}};function $i(){return{type:"",sdp:""}}var Fi={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.type&&t.uint32(10).string(e.type),""!==e.sdp&&t.uint32(18).string(e.sdp),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=$i();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.type=n.string();break;case 2:i.sdp=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{type:Aa(e.type)?String(e.type):"",sdp:Aa(e.sdp)?String(e.sdp):""}},toJSON:function(e){var t={};return void 0!==e.type&&(t.type=e.type),void 0!==e.sdp&&(t.sdp=e.sdp),t},fromPartial:function(e){var t,n,r=$i();return r.type=null!==(t=e.type)&&void 0!==t?t:"",r.sdp=null!==(n=e.sdp)&&void 0!==n?n:"",r}};function Vi(){return{participants:[]}}var qi={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.participants);try{for(r.s();!(t=r.n()).done;){var i=t.value;Sn.encode(i,n.uint32(10).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Vi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participants.push(Sn.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participants:Array.isArray(null==e?void 0:e.participants)?e.participants.map(function(e){return Sn.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.participants?t.participants=e.participants.map(function(e){return e?Sn.toJSON(e):void 0}):t.participants=[],t},fromPartial:function(e){var t,n=Vi();return n.participants=(null===(t=e.participants)||void 0===t?void 0:t.map(function(e){return Sn.fromPartial(e)}))||[],n}};function Wi(){return{trackSids:[],subscribe:!1,participantTracks:[]}}var Gi={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.trackSids);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.uint32(10).string(i)}}catch(c){r.e(c)}finally{r.f()}!0===e.subscribe&&n.uint32(16).bool(e.subscribe);var a,o=D(e.participantTracks);try{for(o.s();!(a=o.n()).done;){var s=a.value;Mn.encode(s,n.uint32(26).fork()).ldelim()}}catch(c){o.e(c)}finally{o.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Wi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.trackSids.push(n.string());break;case 2:i.subscribe=n.bool();break;case 3:i.participantTracks.push(Mn.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{trackSids:Array.isArray(null==e?void 0:e.trackSids)?e.trackSids.map(function(e){return String(e)}):[],subscribe:!!Aa(e.subscribe)&&Boolean(e.subscribe),participantTracks:Array.isArray(null==e?void 0:e.participantTracks)?e.participantTracks.map(function(e){return Mn.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.trackSids?t.trackSids=e.trackSids.map(function(e){return e}):t.trackSids=[],void 0!==e.subscribe&&(t.subscribe=e.subscribe),e.participantTracks?t.participantTracks=e.participantTracks.map(function(e){return e?Mn.toJSON(e):void 0}):t.participantTracks=[],t},fromPartial:function(e){var t,n,r,i=Wi();return i.trackSids=(null===(t=e.trackSids)||void 0===t?void 0:t.map(function(e){return e}))||[],i.subscribe=null!==(n=e.subscribe)&&void 0!==n&&n,i.participantTracks=(null===(r=e.participantTracks)||void 0===r?void 0:r.map(function(e){return Mn.fromPartial(e)}))||[],i}};function Qi(){return{trackSids:[],disabled:!1,quality:0,width:0,height:0,fps:0}}var zi={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.trackSids);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.uint32(10).string(i)}}catch(a){r.e(a)}finally{r.f()}return!0===e.disabled&&n.uint32(24).bool(e.disabled),0!==e.quality&&n.uint32(32).int32(e.quality),0!==e.width&&n.uint32(40).uint32(e.width),0!==e.height&&n.uint32(48).uint32(e.height),0!==e.fps&&n.uint32(56).uint32(e.fps),n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Qi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.trackSids.push(n.string());break;case 3:i.disabled=n.bool();break;case 4:i.quality=n.int32();break;case 5:i.width=n.uint32();break;case 6:i.height=n.uint32();break;case 7:i.fps=n.uint32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{trackSids:Array.isArray(null==e?void 0:e.trackSids)?e.trackSids.map(function(e){return String(e)}):[],disabled:!!Aa(e.disabled)&&Boolean(e.disabled),quality:Aa(e.quality)?Kt(e.quality):0,width:Aa(e.width)?Number(e.width):0,height:Aa(e.height)?Number(e.height):0,fps:Aa(e.fps)?Number(e.fps):0}},toJSON:function(e){var t={};return e.trackSids?t.trackSids=e.trackSids.map(function(e){return e}):t.trackSids=[],void 0!==e.disabled&&(t.disabled=e.disabled),void 0!==e.quality&&(t.quality=Yt(e.quality)),void 0!==e.width&&(t.width=Math.round(e.width)),void 0!==e.height&&(t.height=Math.round(e.height)),void 0!==e.fps&&(t.fps=Math.round(e.fps)),t},fromPartial:function(e){var t,n,r,i,a,o,s=Qi();return s.trackSids=(null===(t=e.trackSids)||void 0===t?void 0:t.map(function(e){return e}))||[],s.disabled=null!==(n=e.disabled)&&void 0!==n&&n,s.quality=null!==(r=e.quality)&&void 0!==r?r:0,s.width=null!==(i=e.width)&&void 0!==i?i:0,s.height=null!==(a=e.height)&&void 0!==a?a:0,s.fps=null!==(o=e.fps)&&void 0!==o?o:0,s}};function Hi(){return{canReconnect:!1,reason:0}}var Zi={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return!0===e.canReconnect&&t.uint32(8).bool(e.canReconnect),0!==e.reason&&t.uint32(16).int32(e.reason),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Hi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.canReconnect=n.bool();break;case 2:i.reason=n.int32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{canReconnect:!!Aa(e.canReconnect)&&Boolean(e.canReconnect),reason:Aa(e.reason)?rn(e.reason):0}},toJSON:function(e){var t={};return void 0!==e.canReconnect&&(t.canReconnect=e.canReconnect),void 0!==e.reason&&(t.reason=an(e.reason)),t},fromPartial:function(e){var t,n,r=Hi();return r.canReconnect=null!==(t=e.canReconnect)&&void 0!==t&&t,r.reason=null!==(n=e.reason)&&void 0!==n?n:0,r}};function Ki(){return{trackSid:"",layers:[]}}var Yi={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.trackSid&&t.uint32(10).string(e.trackSid);var n,r=D(e.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;xn.encode(i,t.uint32(18).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Ki();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.trackSid=n.string();break;case 2:i.layers.push(xn.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{trackSid:Aa(e.trackSid)?String(e.trackSid):"",layers:Array.isArray(null==e?void 0:e.layers)?e.layers.map(function(e){return xn.fromJSON(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.trackSid&&(t.trackSid=e.trackSid),e.layers?t.layers=e.layers.map(function(e){return e?xn.toJSON(e):void 0}):t.layers=[],t},fromPartial:function(e){var t,n,r=Ki();return r.trackSid=null!==(t=e.trackSid)&&void 0!==t?t:"",r.layers=(null===(n=e.layers)||void 0===n?void 0:n.map(function(e){return xn.fromPartial(e)}))||[],r}};function Xi(){return{urls:[],username:"",credential:""}}var ea={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.urls);try{for(r.s();!(t=r.n()).done;){var i=t.value;n.uint32(10).string(i)}}catch(a){r.e(a)}finally{r.f()}return""!==e.username&&n.uint32(18).string(e.username),""!==e.credential&&n.uint32(26).string(e.credential),n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Xi();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.urls.push(n.string());break;case 2:i.username=n.string();break;case 3:i.credential=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{urls:Array.isArray(null==e?void 0:e.urls)?e.urls.map(function(e){return String(e)}):[],username:Aa(e.username)?String(e.username):"",credential:Aa(e.credential)?String(e.credential):""}},toJSON:function(e){var t={};return e.urls?t.urls=e.urls.map(function(e){return e}):t.urls=[],void 0!==e.username&&(t.username=e.username),void 0!==e.credential&&(t.credential=e.credential),t},fromPartial:function(e){var t,n,r,i=Xi();return i.urls=(null===(t=e.urls)||void 0===t?void 0:t.map(function(e){return e}))||[],i.username=null!==(n=e.username)&&void 0!==n?n:"",i.credential=null!==(r=e.credential)&&void 0!==r?r:"",i}};function ta(){return{speakers:[]}}var na={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.speakers);try{for(r.s();!(t=r.n()).done;){var i=t.value;An.encode(i,n.uint32(10).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=ta();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.speakers.push(An.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{speakers:Array.isArray(null==e?void 0:e.speakers)?e.speakers.map(function(e){return An.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.speakers?t.speakers=e.speakers.map(function(e){return e?An.toJSON(e):void 0}):t.speakers=[],t},fromPartial:function(e){var t,n=ta();return n.speakers=(null===(t=e.speakers)||void 0===t?void 0:t.map(function(e){return An.fromPartial(e)}))||[],n}};function ra(){return{room:void 0}}var ia={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return void 0!==e.room&&vn.encode(e.room,t.uint32(10).fork()).ldelim(),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=ra();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.room=vn.decode(n,n.uint32());break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{room:Aa(e.room)?vn.fromJSON(e.room):void 0}},toJSON:function(e){var t={};return void 0!==e.room&&(t.room=e.room?vn.toJSON(e.room):void 0),t},fromPartial:function(e){var t=ra();return t.room=void 0!==e.room&&null!==e.room?vn.fromPartial(e.room):void 0,t}};function aa(){return{participantSid:"",quality:0,score:0}}var oa={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.participantSid&&t.uint32(10).string(e.participantSid),0!==e.quality&&t.uint32(16).int32(e.quality),0!==e.score&&t.uint32(29).float(e.score),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=aa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participantSid=n.string();break;case 2:i.quality=n.int32();break;case 3:i.score=n.float();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participantSid:Aa(e.participantSid)?String(e.participantSid):"",quality:Aa(e.quality)?Xt(e.quality):0,score:Aa(e.score)?Number(e.score):0}},toJSON:function(e){var t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.quality&&(t.quality=en(e.quality)),void 0!==e.score&&(t.score=e.score),t},fromPartial:function(e){var t,n,r,i=aa();return i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.quality=null!==(n=e.quality)&&void 0!==n?n:0,i.score=null!==(r=e.score)&&void 0!==r?r:0,i}};function sa(){return{updates:[]}}var ca={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.updates);try{for(r.s();!(t=r.n()).done;){var i=t.value;oa.encode(i,n.uint32(10).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=sa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.updates.push(oa.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{updates:Array.isArray(null==e?void 0:e.updates)?e.updates.map(function(e){return oa.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.updates?t.updates=e.updates.map(function(e){return e?oa.toJSON(e):void 0}):t.updates=[],t},fromPartial:function(e){var t,n=sa();return n.updates=(null===(t=e.updates)||void 0===t?void 0:t.map(function(e){return oa.fromPartial(e)}))||[],n}};function ua(){return{participantSid:"",trackSid:"",state:0}}var da={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.participantSid&&t.uint32(10).string(e.participantSid),""!==e.trackSid&&t.uint32(18).string(e.trackSid),0!==e.state&&t.uint32(24).int32(e.state),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=ua();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participantSid=n.string();break;case 2:i.trackSid=n.string();break;case 3:i.state=n.int32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participantSid:Aa(e.participantSid)?String(e.participantSid):"",trackSid:Aa(e.trackSid)?String(e.trackSid):"",state:Aa(e.state)?ki(e.state):0}},toJSON:function(e){var t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.trackSid&&(t.trackSid=e.trackSid),void 0!==e.state&&(t.state=yi(e.state)),t},fromPartial:function(e){var t,n,r,i=ua();return i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.trackSid=null!==(n=e.trackSid)&&void 0!==n?n:"",i.state=null!==(r=e.state)&&void 0!==r?r:0,i}};function la(){return{streamStates:[]}}var pa={encode:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create(),r=D(e.streamStates);try{for(r.s();!(t=r.n()).done;){var i=t.value;da.encode(i,n.uint32(10).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return n},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=la();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.streamStates.push(da.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{streamStates:Array.isArray(null==e?void 0:e.streamStates)?e.streamStates.map(function(e){return da.fromJSON(e)}):[]}},toJSON:function(e){var t={};return e.streamStates?t.streamStates=e.streamStates.map(function(e){return e?da.toJSON(e):void 0}):t.streamStates=[],t},fromPartial:function(e){var t,n=la();return n.streamStates=(null===(t=e.streamStates)||void 0===t?void 0:t.map(function(e){return da.fromPartial(e)}))||[],n}};function fa(){return{quality:0,enabled:!1}}var ha={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return 0!==e.quality&&t.uint32(8).int32(e.quality),!0===e.enabled&&t.uint32(16).bool(e.enabled),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=fa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.quality=n.int32();break;case 2:i.enabled=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{quality:Aa(e.quality)?Kt(e.quality):0,enabled:!!Aa(e.enabled)&&Boolean(e.enabled)}},toJSON:function(e){var t={};return void 0!==e.quality&&(t.quality=Yt(e.quality)),void 0!==e.enabled&&(t.enabled=e.enabled),t},fromPartial:function(e){var t,n,r=fa();return r.quality=null!==(t=e.quality)&&void 0!==t?t:0,r.enabled=null!==(n=e.enabled)&&void 0!==n&&n,r}};function va(){return{codec:"",qualities:[]}}var ma={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.codec&&t.uint32(10).string(e.codec);var n,r=D(e.qualities);try{for(r.s();!(n=r.n()).done;){var i=n.value;ha.encode(i,t.uint32(18).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=va();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.codec=n.string();break;case 2:i.qualities.push(ha.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{codec:Aa(e.codec)?String(e.codec):"",qualities:Array.isArray(null==e?void 0:e.qualities)?e.qualities.map(function(e){return ha.fromJSON(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.codec&&(t.codec=e.codec),e.qualities?t.qualities=e.qualities.map(function(e){return e?ha.toJSON(e):void 0}):t.qualities=[],t},fromPartial:function(e){var t,n,r=va();return r.codec=null!==(t=e.codec)&&void 0!==t?t:"",r.qualities=(null===(n=e.qualities)||void 0===n?void 0:n.map(function(e){return ha.fromPartial(e)}))||[],r}};function ga(){return{trackSid:"",subscribedQualities:[],subscribedCodecs:[]}}var ba={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.trackSid&&t.uint32(10).string(e.trackSid);var n,r=D(e.subscribedQualities);try{for(r.s();!(n=r.n()).done;){var i=n.value;ha.encode(i,t.uint32(18).fork()).ldelim()}}catch(c){r.e(c)}finally{r.f()}var a,o=D(e.subscribedCodecs);try{for(o.s();!(a=o.n()).done;){var s=a.value;ma.encode(s,t.uint32(26).fork()).ldelim()}}catch(c){o.e(c)}finally{o.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=ga();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.trackSid=n.string();break;case 2:i.subscribedQualities.push(ha.decode(n,n.uint32()));break;case 3:i.subscribedCodecs.push(ma.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{trackSid:Aa(e.trackSid)?String(e.trackSid):"",subscribedQualities:Array.isArray(null==e?void 0:e.subscribedQualities)?e.subscribedQualities.map(function(e){return ha.fromJSON(e)}):[],subscribedCodecs:Array.isArray(null==e?void 0:e.subscribedCodecs)?e.subscribedCodecs.map(function(e){return ma.fromJSON(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.trackSid&&(t.trackSid=e.trackSid),e.subscribedQualities?t.subscribedQualities=e.subscribedQualities.map(function(e){return e?ha.toJSON(e):void 0}):t.subscribedQualities=[],e.subscribedCodecs?t.subscribedCodecs=e.subscribedCodecs.map(function(e){return e?ma.toJSON(e):void 0}):t.subscribedCodecs=[],t},fromPartial:function(e){var t,n,r,i=ga();return i.trackSid=null!==(t=e.trackSid)&&void 0!==t?t:"",i.subscribedQualities=(null===(n=e.subscribedQualities)||void 0===n?void 0:n.map(function(e){return ha.fromPartial(e)}))||[],i.subscribedCodecs=(null===(r=e.subscribedCodecs)||void 0===r?void 0:r.map(function(e){return ma.fromPartial(e)}))||[],i}};function ka(){return{participantSid:"",allTracks:!1,trackSids:[],participantIdentity:""}}var ya={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();""!==e.participantSid&&t.uint32(10).string(e.participantSid),!0===e.allTracks&&t.uint32(16).bool(e.allTracks);var n,r=D(e.trackSids);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.uint32(26).string(i)}}catch(a){r.e(a)}finally{r.f()}return""!==e.participantIdentity&&t.uint32(34).string(e.participantIdentity),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=ka();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participantSid=n.string();break;case 2:i.allTracks=n.bool();break;case 3:i.trackSids.push(n.string());break;case 4:i.participantIdentity=n.string();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participantSid:Aa(e.participantSid)?String(e.participantSid):"",allTracks:!!Aa(e.allTracks)&&Boolean(e.allTracks),trackSids:Array.isArray(null==e?void 0:e.trackSids)?e.trackSids.map(function(e){return String(e)}):[],participantIdentity:Aa(e.participantIdentity)?String(e.participantIdentity):""}},toJSON:function(e){var t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.allTracks&&(t.allTracks=e.allTracks),e.trackSids?t.trackSids=e.trackSids.map(function(e){return e}):t.trackSids=[],void 0!==e.participantIdentity&&(t.participantIdentity=e.participantIdentity),t},fromPartial:function(e){var t,n,r,i,a=ka();return a.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",a.allTracks=null!==(n=e.allTracks)&&void 0!==n&&n,a.trackSids=(null===(r=e.trackSids)||void 0===r?void 0:r.map(function(e){return e}))||[],a.participantIdentity=null!==(i=e.participantIdentity)&&void 0!==i?i:"",a}};function Sa(){return{allParticipants:!1,trackPermissions:[]}}var wa={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();!0===e.allParticipants&&t.uint32(8).bool(e.allParticipants);var n,r=D(e.trackPermissions);try{for(r.s();!(n=r.n()).done;){var i=n.value;ya.encode(i,t.uint32(18).fork()).ldelim()}}catch(a){r.e(a)}finally{r.f()}return t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Sa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.allParticipants=n.bool();break;case 2:i.trackPermissions.push(ya.decode(n,n.uint32()));break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{allParticipants:!!Aa(e.allParticipants)&&Boolean(e.allParticipants),trackPermissions:Array.isArray(null==e?void 0:e.trackPermissions)?e.trackPermissions.map(function(e){return ya.fromJSON(e)}):[]}},toJSON:function(e){var t={};return void 0!==e.allParticipants&&(t.allParticipants=e.allParticipants),e.trackPermissions?t.trackPermissions=e.trackPermissions.map(function(e){return e?ya.toJSON(e):void 0}):t.trackPermissions=[],t},fromPartial:function(e){var t,n,r=Sa();return r.allParticipants=null!==(t=e.allParticipants)&&void 0!==t&&t,r.trackPermissions=(null===(n=e.trackPermissions)||void 0===n?void 0:n.map(function(e){return ya.fromPartial(e)}))||[],r}};function Ca(){return{participantSid:"",trackSid:"",allowed:!1}}var Ta={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.participantSid&&t.uint32(10).string(e.participantSid),""!==e.trackSid&&t.uint32(18).string(e.trackSid),!0===e.allowed&&t.uint32(24).bool(e.allowed),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Ca();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.participantSid=n.string();break;case 2:i.trackSid=n.string();break;case 3:i.allowed=n.bool();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{participantSid:Aa(e.participantSid)?String(e.participantSid):"",trackSid:Aa(e.trackSid)?String(e.trackSid):"",allowed:!!Aa(e.allowed)&&Boolean(e.allowed)}},toJSON:function(e){var t={};return void 0!==e.participantSid&&(t.participantSid=e.participantSid),void 0!==e.trackSid&&(t.trackSid=e.trackSid),void 0!==e.allowed&&(t.allowed=e.allowed),t},fromPartial:function(e){var t,n,r,i=Ca();return i.participantSid=null!==(t=e.participantSid)&&void 0!==t?t:"",i.trackSid=null!==(n=e.trackSid)&&void 0!==n?n:"",i.allowed=null!==(r=e.allowed)&&void 0!==r&&r,i}};function Pa(){return{answer:void 0,subscription:void 0,publishTracks:[],dataChannels:[],offer:void 0}}var Ea={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();void 0!==e.answer&&Fi.encode(e.answer,t.uint32(10).fork()).ldelim(),void 0!==e.subscription&&Gi.encode(e.subscription,t.uint32(18).fork()).ldelim();var n,r=D(e.publishTracks);try{for(r.s();!(n=r.n()).done;){var i=n.value;ji.encode(i,t.uint32(26).fork()).ldelim()}}catch(c){r.e(c)}finally{r.f()}var a,o=D(e.dataChannels);try{for(o.s();!(a=o.n()).done;){var s=a.value;Ra.encode(s,t.uint32(34).fork()).ldelim()}}catch(c){o.e(c)}finally{o.f()}return void 0!==e.offer&&Fi.encode(e.offer,t.uint32(42).fork()).ldelim(),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Pa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.answer=Fi.decode(n,n.uint32());break;case 2:i.subscription=Gi.decode(n,n.uint32());break;case 3:i.publishTracks.push(ji.decode(n,n.uint32()));break;case 4:i.dataChannels.push(Ra.decode(n,n.uint32()));break;case 5:i.offer=Fi.decode(n,n.uint32());break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{answer:Aa(e.answer)?Fi.fromJSON(e.answer):void 0,subscription:Aa(e.subscription)?Gi.fromJSON(e.subscription):void 0,publishTracks:Array.isArray(null==e?void 0:e.publishTracks)?e.publishTracks.map(function(e){return ji.fromJSON(e)}):[],dataChannels:Array.isArray(null==e?void 0:e.dataChannels)?e.dataChannels.map(function(e){return Ra.fromJSON(e)}):[],offer:Aa(e.offer)?Fi.fromJSON(e.offer):void 0}},toJSON:function(e){var t={};return void 0!==e.answer&&(t.answer=e.answer?Fi.toJSON(e.answer):void 0),void 0!==e.subscription&&(t.subscription=e.subscription?Gi.toJSON(e.subscription):void 0),e.publishTracks?t.publishTracks=e.publishTracks.map(function(e){return e?ji.toJSON(e):void 0}):t.publishTracks=[],e.dataChannels?t.dataChannels=e.dataChannels.map(function(e){return e?Ra.toJSON(e):void 0}):t.dataChannels=[],void 0!==e.offer&&(t.offer=e.offer?Fi.toJSON(e.offer):void 0),t},fromPartial:function(e){var t,n,r=Pa();return r.answer=void 0!==e.answer&&null!==e.answer?Fi.fromPartial(e.answer):void 0,r.subscription=void 0!==e.subscription&&null!==e.subscription?Gi.fromPartial(e.subscription):void 0,r.publishTracks=(null===(t=e.publishTracks)||void 0===t?void 0:t.map(function(e){return ji.fromPartial(e)}))||[],r.dataChannels=(null===(n=e.dataChannels)||void 0===n?void 0:n.map(function(e){return Ra.fromPartial(e)}))||[],r.offer=void 0!==e.offer&&null!==e.offer?Fi.fromPartial(e.offer):void 0,r}};function xa(){return{label:"",id:0,target:0}}var Ra={encode:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return""!==e.label&&t.uint32(10).string(e.label),0!==e.id&&t.uint32(16).uint32(e.id),0!==e.target&&t.uint32(24).int32(e.target),t},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=xa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.label=n.string();break;case 2:i.id=n.uint32();break;case 3:i.target=n.int32();break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{label:Aa(e.label)?String(e.label):"",id:Aa(e.id)?Number(e.id):0,target:Aa(e.target)?gi(e.target):0}},toJSON:function(e){var t={};return void 0!==e.label&&(t.label=e.label),void 0!==e.id&&(t.id=Math.round(e.id)),void 0!==e.target&&(t.target=bi(e.target)),t},fromPartial:function(e){var t,n,r,i=xa();return i.label=null!==(t=e.label)&&void 0!==t?t:"",i.id=null!==(n=e.id)&&void 0!==n?n:0,i.target=null!==(r=e.target)&&void 0!==r?r:0,i}};function Oa(){return{scenario:void 0}}var Na={encode:function(e){var t,n,r,i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wt.Writer.create();return"speakerUpdate"===(null===(t=e.scenario)||void 0===t?void 0:t.$case)&&o.uint32(8).int32(e.scenario.speakerUpdate),"nodeFailure"===(null===(n=e.scenario)||void 0===n?void 0:n.$case)&&o.uint32(16).bool(e.scenario.nodeFailure),"migration"===(null===(r=e.scenario)||void 0===r?void 0:r.$case)&&o.uint32(24).bool(e.scenario.migration),"serverLeave"===(null===(i=e.scenario)||void 0===i?void 0:i.$case)&&o.uint32(32).bool(e.scenario.serverLeave),"switchCandidateProtocol"===(null===(a=e.scenario)||void 0===a?void 0:a.$case)&&o.uint32(40).int32(e.scenario.switchCandidateProtocol),o},decode:function(e,t){for(var n=e instanceof Wt.Reader?e:new Wt.Reader(e),r=void 0===t?n.len:n.pos+t,i=Oa();n.pos<r;){var a=n.uint32();switch(a>>>3){case 1:i.scenario={$case:"speakerUpdate",speakerUpdate:n.int32()};break;case 2:i.scenario={$case:"nodeFailure",nodeFailure:n.bool()};break;case 3:i.scenario={$case:"migration",migration:n.bool()};break;case 4:i.scenario={$case:"serverLeave",serverLeave:n.bool()};break;case 5:i.scenario={$case:"switchCandidateProtocol",switchCandidateProtocol:n.int32()};break;default:n.skipType(7&a)}}return i},fromJSON:function(e){return{scenario:Aa(e.speakerUpdate)?{$case:"speakerUpdate",speakerUpdate:Number(e.speakerUpdate)}:Aa(e.nodeFailure)?{$case:"nodeFailure",nodeFailure:Boolean(e.nodeFailure)}:Aa(e.migration)?{$case:"migration",migration:Boolean(e.migration)}:Aa(e.serverLeave)?{$case:"serverLeave",serverLeave:Boolean(e.serverLeave)}:Aa(e.switchCandidateProtocol)?{$case:"switchCandidateProtocol",switchCandidateProtocol:Si(e.switchCandidateProtocol)}:void 0}},toJSON:function(e){var t,n,r,i,a,o,s,c,u,d,l,p={};return"speakerUpdate"===(null===(t=e.scenario)||void 0===t?void 0:t.$case)&&(p.speakerUpdate=Math.round(null===(n=e.scenario)||void 0===n?void 0:n.speakerUpdate)),"nodeFailure"===(null===(r=e.scenario)||void 0===r?void 0:r.$case)&&(p.nodeFailure=null===(i=e.scenario)||void 0===i?void 0:i.nodeFailure),"migration"===(null===(a=e.scenario)||void 0===a?void 0:a.$case)&&(p.migration=null===(o=e.scenario)||void 0===o?void 0:o.migration),"serverLeave"===(null===(s=e.scenario)||void 0===s?void 0:s.$case)&&(p.serverLeave=null===(c=e.scenario)||void 0===c?void 0:c.serverLeave),"switchCandidateProtocol"===(null===(u=e.scenario)||void 0===u?void 0:u.$case)&&(p.switchCandidateProtocol=void 0!==(null===(d=e.scenario)||void 0===d?void 0:d.switchCandidateProtocol)?wi(null===(l=e.scenario)||void 0===l?void 0:l.switchCandidateProtocol):void 0),p},fromPartial:function(e){var t,n,r,i,a,o,s,c,u,d,l,p,f,h,v,m=Oa();return"speakerUpdate"===(null===(t=e.scenario)||void 0===t?void 0:t.$case)&&void 0!==(null===(n=e.scenario)||void 0===n?void 0:n.speakerUpdate)&&null!==(null===(r=e.scenario)||void 0===r?void 0:r.speakerUpdate)&&(m.scenario={$case:"speakerUpdate",speakerUpdate:e.scenario.speakerUpdate}),"nodeFailure"===(null===(i=e.scenario)||void 0===i?void 0:i.$case)&&void 0!==(null===(a=e.scenario)||void 0===a?void 0:a.nodeFailure)&&null!==(null===(o=e.scenario)||void 0===o?void 0:o.nodeFailure)&&(m.scenario={$case:"nodeFailure",nodeFailure:e.scenario.nodeFailure}),"migration"===(null===(s=e.scenario)||void 0===s?void 0:s.$case)&&void 0!==(null===(c=e.scenario)||void 0===c?void 0:c.migration)&&null!==(null===(u=e.scenario)||void 0===u?void 0:u.migration)&&(m.scenario={$case:"migration",migration:e.scenario.migration}),"serverLeave"===(null===(d=e.scenario)||void 0===d?void 0:d.$case)&&void 0!==(null===(l=e.scenario)||void 0===l?void 0:l.serverLeave)&&null!==(null===(p=e.scenario)||void 0===p?void 0:p.serverLeave)&&(m.scenario={$case:"serverLeave",serverLeave:e.scenario.serverLeave}),"switchCandidateProtocol"===(null===(f=e.scenario)||void 0===f?void 0:f.$case)&&void 0!==(null===(h=e.scenario)||void 0===h?void 0:h.switchCandidateProtocol)&&null!==(null===(v=e.scenario)||void 0===v?void 0:v.switchCandidateProtocol)&&(m.scenario={$case:"switchCandidateProtocol",switchCandidateProtocol:e.scenario.switchCandidateProtocol}),m}},Ia=function(){if(void 0!==Ia)return Ia;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw"Unable to locate global object"}();function Da(e){if(e.gt(Number.MAX_SAFE_INTEGER))throw new Ia.Error("Value is larger than Number.MAX_SAFE_INTEGER");return e.toNumber()}function Aa(e){return null!=e}Wt.util.Long!==q&&(Wt.util.Long=q,Wt.configure());var Ua=function(e){p(n,m(Error));var t=f(n);function n(e,r){var i;return x(this,n),(i=t.call(this,r||"an error has occured")).code=e,i}return O(n)}();exports.LivekitError=Ua;var La=function(e){p(n,Ua);var t=f(n);function n(e,r,i){var a;return x(this,n),(a=t.call(this,1,e)).status=i,a.reason=r,a}return O(n)}();exports.ConnectionError=La;var _a=function(e){p(n,Ua);var t=f(n);function n(e){return x(this,n),t.call(this,20,null!=e?e:"track is invalid")}return O(n)}();exports.TrackInvalidError=_a;var Ma=function(e){p(n,Ua);var t=f(n);function n(e){return x(this,n),t.call(this,10,null!=e?e:"unsupported server")}return O(n)}();exports.UnsupportedServer=Ma;var ja=function(e){p(n,Ua);var t=f(n);function n(e){return x(this,n),t.call(this,12,null!=e?e:"unexpected connection state")}return O(n)}();exports.UnexpectedConnectionState=ja;var Ba=function(e){p(n,Ua);var t=f(n);function n(e){return x(this,n),t.call(this,13,null!=e?e:"unable to negotiate")}return O(n)}();exports.NegotiationError=Ba;var Ja,$a,Fa,Va,qa,Wa=function(e){p(n,Ua);var t=f(n);function n(e){return x(this,n),t.call(this,13,null!=e?e:"unable to publish data")}return O(n)}();exports.PublishDataError=Wa,exports.MediaDeviceFailure=Ja,function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(Ja||(exports.MediaDeviceFailure=Ja={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(Ja||(exports.MediaDeviceFailure=Ja={})),exports.RoomEvent=$a,function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.StateChanged="connectionStateChanged",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged"}($a||(exports.RoomEvent=$a={})),exports.ParticipantEvent=Fa,function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.ParticipantMetadataChanged="participantMetadataChanged",e.DataReceived="dataReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged"}(Fa||(exports.ParticipantEvent=Fa={})),exports.EngineEvent=Va,function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived"}(Va||(exports.EngineEvent=Va={})),exports.TrackEvent=qa,function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged"}(qa||(exports.TrackEvent=qa={}));var Ga=2e3;function Qa(e,t){return t?("bytesReceived"in e?(n=e.bytesReceived,r=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,r=t.bytesSent),void 0===n||void 0===r||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-r)*1e3/(e.timestamp-t.timestamp)):0;var n,r}var za={exports:{}};!function(e,t){!function(n,r){var i="model",a="name",o="type",s="vendor",c="version",u="mobile",d="tablet",l="smarttv",p=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},f=function(e,t){return"string"===L(e)&&-1!==h(t).indexOf(h(e))},h=function(e){return e.toLowerCase()},v=function(e,t){if("string"===L(e))return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),"undefined"===L(t)?e:e.substring(0,255)},m=function(e,t){for(var n,r,i,a,o,s,c=0;c<t.length&&!o;){var u=t[c],d=t[c+1];for(n=r=0;n<u.length&&!o;)if(o=u[n++].exec(e))for(i=0;i<d.length;i++)s=o[++r],"object"===L(a=d[i])&&a.length>0?2===a.length?"function"==L(a[1])?this[a[0]]=a[1].call(this,s):this[a[0]]=a[1]:3===a.length?"function"!==L(a[1])||a[1].exec&&a[1].test?this[a[0]]=s?s.replace(a[1],a[2]):void 0:this[a[0]]=s?a[1].call(this,s,a[2]):void 0:4===a.length&&(this[a[0]]=s?a[3].call(this,s.replace(a[1],a[2])):void 0):this[a]=s||void 0;c+=2}},g=function(e,t){for(var n in t)if("object"===L(t[n])&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(f(t[n][r],e))return"?"===n?void 0:n}else if(f(t[n],e))return"?"===n?void 0:n;return e},b={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},k={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[c,[a,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[c,[a,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[a,c],[/opios[\/ ]+([\w\.]+)/i],[c,[a,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[c,[a,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[a,c],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[c,[a,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[c,[a,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[c,[a,"WeChat"]],[/konqueror\/([\w\.]+)/i],[c,[a,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[c,[a,"IE"]],[/yabrowser\/([\w\.]+)/i],[c,[a,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[a,/(.+)/,"$1 Secure Browser"],c],[/\bfocus\/([\w\.]+)/i],[c,[a,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[c,[a,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[c,[a,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[c,[a,"Dolphin"]],[/coast\/([\w\.]+)/i],[c,[a,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[c,[a,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[c,[a,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[a,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[a,/(.+)/,"$1 Browser"],c],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],c],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[a,c],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[a],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[a,"Facebook"],c],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[a,c],[/\bgsa\/([\w\.]+) .*safari\//i],[c,[a,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[c,[a,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[a,"Chrome WebView"],c],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[c,[a,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[a,c],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[c,[a,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[c,a],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[a,[c,g,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[a,c],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[a,"Netscape"],c],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[c,[a,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[a,c]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",h]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows (ce|mobile); ppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[["architecture",/ower/,"",h]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",h]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[i,[s,"Samsung"],[o,d]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[i,[s,"Samsung"],[o,u]],[/\((ip(?:hone|od)[\w ]*);/i],[i,[s,"Apple"],[o,u]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[i,[s,"Apple"],[o,d]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[i,[s,"Huawei"],[o,d]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[i,[s,"Huawei"],[o,u]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[i,/_/g," "],[s,"Xiaomi"],[o,u]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[i,/_/g," "],[s,"Xiaomi"],[o,d]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[i,[s,"OPPO"],[o,u]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[i,[s,"Vivo"],[o,u]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[i,[s,"Realme"],[o,u]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[i,[s,"Motorola"],[o,u]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[i,[s,"Motorola"],[o,d]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[i,[s,"LG"],[o,d]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[i,[s,"LG"],[o,u]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[i,[s,"Lenovo"],[o,d]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[i,/_/g," "],[s,"Nokia"],[o,u]],[/(pixel c)\b/i],[i,[s,"Google"],[o,d]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[i,[s,"Google"],[o,u]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[s,"Sony"],[o,u]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[i,"Xperia Tablet"],[s,"Sony"],[o,d]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[i,[s,"OnePlus"],[o,u]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[i,[s,"Amazon"],[o,d]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[i,/(.+)/g,"Fire Phone $1"],[s,"Amazon"],[o,u]],[/(playbook);[-\w\),; ]+(rim)/i],[i,s,[o,d]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[i,[s,"BlackBerry"],[o,u]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[i,[s,"ASUS"],[o,d]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[i,[s,"ASUS"],[o,u]],[/(nexus 9)/i],[i,[s,"HTC"],[o,d]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[s,[i,/_/g," "],[o,u]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[i,[s,"Acer"],[o,d]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[i,[s,"Meizu"],[o,u]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[i,[s,"Sharp"],[o,u]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[s,i,[o,u]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[s,i,[o,d]],[/(surface duo)/i],[i,[s,"Microsoft"],[o,d]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[i,[s,"Fairphone"],[o,u]],[/(u304aa)/i],[i,[s,"AT&T"],[o,u]],[/\bsie-(\w*)/i],[i,[s,"Siemens"],[o,u]],[/\b(rct\w+) b/i],[i,[s,"RCA"],[o,d]],[/\b(venue[\d ]{2,7}) b/i],[i,[s,"Dell"],[o,d]],[/\b(q(?:mv|ta)\w+) b/i],[i,[s,"Verizon"],[o,d]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[i,[s,"Barnes & Noble"],[o,d]],[/\b(tm\d{3}\w+) b/i],[i,[s,"NuVision"],[o,d]],[/\b(k88) b/i],[i,[s,"ZTE"],[o,d]],[/\b(nx\d{3}j) b/i],[i,[s,"ZTE"],[o,u]],[/\b(gen\d{3}) b.+49h/i],[i,[s,"Swiss"],[o,u]],[/\b(zur\d{3}) b/i],[i,[s,"Swiss"],[o,d]],[/\b((zeki)?tb.*\b) b/i],[i,[s,"Zeki"],[o,d]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[s,"Dragon Touch"],i,[o,d]],[/\b(ns-?\w{0,9}) b/i],[i,[s,"Insignia"],[o,d]],[/\b((nxa|next)-?\w{0,9}) b/i],[i,[s,"NextBook"],[o,d]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[s,"Voice"],i,[o,u]],[/\b(lvtel\-)?(v1[12]) b/i],[[s,"LvTel"],i,[o,u]],[/\b(ph-1) /i],[i,[s,"Essential"],[o,u]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[i,[s,"Envizen"],[o,d]],[/\b(trio[-\w\. ]+) b/i],[i,[s,"MachSpeed"],[o,d]],[/\btu_(1491) b/i],[i,[s,"Rotor"],[o,d]],[/(shield[\w ]+) b/i],[i,[s,"Nvidia"],[o,d]],[/(sprint) (\w+)/i],[s,i,[o,u]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[s,"Microsoft"],[o,u]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[i,[s,"Zebra"],[o,d]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[i,[s,"Zebra"],[o,u]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[s,i,[o,"console"]],[/droid.+; (shield) bui/i],[i,[s,"Nvidia"],[o,"console"]],[/(playstation [345portablevi]+)/i],[i,[s,"Sony"],[o,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[i,[s,"Microsoft"],[o,"console"]],[/smart-tv.+(samsung)/i],[s,[o,l]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[s,"Samsung"],[o,l]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[s,"LG"],[o,l]],[/(apple) ?tv/i],[s,[i,"Apple TV"],[o,l]],[/crkey/i],[[i,"Chromecast"],[s,"Google"],[o,l]],[/droid.+aft(\w)( bui|\))/i],[i,[s,"Amazon"],[o,l]],[/\(dtv[\);].+(aquos)/i],[i,[s,"Sharp"],[o,l]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[s,v],[i,v],[o,l]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[o,l]],[/((pebble))app/i],[s,i,[o,"wearable"]],[/droid.+; (glass) \d/i],[i,[s,"Google"],[o,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[i,[s,"Zebra"],[o,"wearable"]],[/(quest( 2)?)/i],[i,[s,"Facebook"],[o,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[s,[o,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[i,[o,u]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[i,[o,d]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[o,d]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[o,u]],[/(android[-\w\. ]{0,9});.+buil/i],[i,[s,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[c,[a,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[c,[a,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[a,c],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[c,a]],os:[[/microsoft (windows) (vista|xp)/i],[a,c],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[a,[c,g,b]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[a,"Windows"],[c,g,b]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[c,/_/g,"."],[a,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[a,"Mac OS"],[c,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[c,a],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[a,c],[/\(bb(10);/i],[c,[a,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[c,[a,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[c,[a,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[c,[a,"webOS"]],[/crkey\/([\d\.]+)/i],[c,[a,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[a,"Chromium OS"],c],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[a,c],[/(sunos) ?([\w\.\d]*)/i],[[a,"Solaris"],c],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[a,c]]},y=function e(t,r){if("object"===L(t)&&(r=t,t=void 0),!(this instanceof e))return new e(t,r).getResult();var i=t||("undefined"!==L(n)&&n.navigator&&n.navigator.userAgent?n.navigator.userAgent:""),a=r?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(k,r):k;return this.getBrowser=function(){var e,t={};return t.name=void 0,t.version=void 0,m.call(t,i,a.browser),t.major="string"===L(e=t.version)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0,t},this.getCPU=function(){var e={architecture:void 0};return m.call(e,i,a.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return m.call(e,i,a.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return m.call(e,i,a.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return m.call(e,i,a.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i="string"===L(e)&&e.length>255?v(e,255):e,this},this.setUA(i),this};y.VERSION="1.0.2",y.BROWSER=p([a,c,"major"]),y.CPU=p(["architecture"]),y.DEVICE=p([i,s,o,"console",u,l,d,"wearable","embedded"]),y.ENGINE=y.OS=p([a,c]),e.exports&&(t=e.exports=y),t.UAParser=y;var S="undefined"!==L(n)&&(n.jQuery||n.Zepto);if(S&&!S.ua){var w=new y;S.ua=w.getResult(),S.ua.get=function(){return w.getUA()},S.ua.set=function(e){w.setUA(e);var t=w.getResult();for(var n in t)S.ua[n]=t[n]}}}("object"===("undefined"==typeof window?"undefined":L(window))?window:M)}(za,za.exports);var Ha=za.exports,Za="1.5.0",Ka=Za;exports.version=Ka;var Ya=8;exports.protocolVersion=Ya;var Xa="|";function eo(e){var t=e.split(Xa);return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}function to(e){return no.apply(this,arguments)}function no(){return(no=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,t)}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ro(){return"addTransceiver"in RTCPeerConnection.prototype}function io(){return"addTrack"in RTCPeerConnection.prototype}function ao(){return void 0!==("undefined"==typeof ResizeObserver?"undefined":L(ResizeObserver))&&void 0!==("undefined"==typeof IntersectionObserver?"undefined":L(IntersectionObserver))}function oo(){return ro()}function so(){var e=RTCRtpReceiver.getCapabilities("video"),t=!1,n=!1;if(e){var r,i=D(e.codecs);try{for(i.s();!(r=i.n()).done;){if("video/AV1"===r.value.mimeType){t=!0;break}}}catch(s){i.e(s)}finally{i.f()}var a,o=D(e.headerExtensions);try{for(o.s();!(a=o.n()).done;){if("https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension"===a.value.uri){n=!0;break}}}catch(s){o.e(s)}finally{o.f()}}return t&&n}function co(e){return!!document&&(e||(e=document.createElement("audio")),"setSinkId"in e)}var uo={Chrome:"100",Chromium:"100",Safari:"15",Firefox:"100",Edge:"100",Brave:"1.40"};function lo(e){if(!mo())return!1;if(!("setCodecPreferences"in e))return!1;var t=Ha();if(!t.browser.name||!t.browser.version)return!1;var n=uo[t.browser.name];return!!n&&go(t.browser.version,n)>=0}function po(){return ro()||io()}function fo(){return!!mo()&&-1!==navigator.userAgent.indexOf("Firefox")}function ho(){return!!mo()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function vo(){return!!mo()&&/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent)}function mo(){return"undefined"!=typeof document}function go(e,t){for(var n=e.split("."),r=t.split("."),i=Math.min(e.length,t.length),a=0;a<i;++a){var o=parseInt(n[a],10),s=parseInt(r[a],10);if(o>s)return 1;if(o<s)return-1}return n.length==r.length?0:n.length<r.length?-1:1}function bo(e){var t,n=D(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.target.handleResize(r)}}catch(i){n.e(i)}finally{n.f()}}function ko(e){var t,n=D(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.target.handleVisibilityChanged(r)}}catch(i){n.e(i)}finally{n.f()}}var yo,So,wo=null,Co=function(){return wo||(wo=new ResizeObserver(bo)),wo},To=null,Po=function(){return To||(To=new IntersectionObserver(ko,{root:document,rootMargin:"0px"})),To};function Eo(){return $n.fromPartial({sdk:qt.JS,protocol:Ya,version:Ka})}function xo(){var e;if(!yo){var t=document.createElement("canvas");t.width=16,t.height=16,null===(e=t.getContext("2d"))||void 0===e||e.fillRect(0,0,t.width,t.height);var n=o(t.captureStream().getTracks(),1);if(!(yo=n[0]))throw Error("Could not get empty media stream video track");yo.enabled=!1}return yo}function Ro(){if(!So){var e=new AudioContext,t=e.createOscillator(),n=e.createMediaStreamDestination();t.connect(n),t.start();var r=o(n.stream.getAudioTracks(),1);if(!(So=r[0]))throw Error("Could not get empty media stream audio track");So.enabled=!1}return So}var Oo=O(function e(t,n){var r=this;x(this,e),this.onFinally=n,this.promise=new Promise(function(){var e=l(a().mark(function e(n,i){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.resolve=n,r.reject=i,!t){e.next=5;break}return e.next=5,t(n,i);case 5:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()).finally(function(){var e;return null===(e=r.onFinally)||void 0===e?void 0:e.call(r)})}),No=function(){function e(t,n){x(this,e),this.maxConcurrent=t||1,this.minCycle=n||0,this.queueRunning=[],this.queueWaiting={},this.lastRun=0}return O(e,[{key:"dequeue",value:function(e){var t=this.queueRunning,n=t.findIndex(function(t){return t.hash===e});if(-1==n)throw"queue desync";var r=t[n];return t.splice(n,1),r}},{key:"getFirstWaiting",value:function(){var e,t=D(Object.keys(this.queueWaiting).sort(function(e,t){return e-t}));try{for(t.s();!(e=t.n()).done;){var n=e.value;if(void 0!==this.queueWaiting[n]&&this.queueWaiting[n].length>0)return this.queueWaiting[n]}}catch(r){t.e(r)}finally{t.f()}}},{key:"end",value:function(e){this.dequeue(e).resolve();var t=this.getFirstWaiting();void 0!==t&&t.shift().resolve()}},{key:"wait",value:function(){var e=l(a().mark(function e(t,n){var r,i,o=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i={hash:t,priority:r=void 0===n?0:n},null==this.queueWaiting[r]&&(this.queueWaiting[r]=[]),!(this.queueRunning.length>=this.maxConcurrent)){e.next=8;break}return i.promise=new Promise(function(e){i.resolve=e}),this.queueWaiting[r].push(i),e.next=8,i.promise;case 8:this.queueRunning.push(i),i.promise=new Promise(function(e){i.resolve=e});case 10:if(!(Date.now()-this.lastRun<this.minCycle)){e.next=15;break}return e.next=13,new Promise(function(e){return setTimeout(e,o.minCycle-Date.now()+o.lastRun)});case 13:e.next=10;break;case 15:this.lastRun=Date.now();case 16:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"run",value:function(e,t){var n=this,r=void 0===t?0:t,i=Symbol();return this.wait(i,r).then(function(){return e()}).finally(function(){n.end(i)})}},{key:"stat",value:function(){var e=this;return{running:this.queueRunning.length,waiting:Object.keys(this.queueWaiting).reduce(function(t,n){return t+e.queueWaiting[n].length},0),last:this.lastRun}}},{key:"flush",value:function(){var e=l(a().mark(function e(){var t,n,r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.stat().waiting>0)){e.next=22;break}t=D(Object.keys(this.queueWaiting).sort(function(e,t){return t-e})),e.prev=2,t.s();case 4:if((n=t.n()).done){e.next=12;break}if(r=n.value,!(void 0!==(i=this.queueWaiting[r])&&i.length>0)){e.next=10;break}return e.next=10,i[i.length-1].promise;case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),t.e(e.t0);case 17:return e.prev=17,t.f(),e.finish(17);case 20:e.next=0;break;case 22:if(!(this.queueRunning.length>0)){e.next=27;break}return e.next=25,Promise.allSettled(this.queueRunning.map(function(e){return e.promise}));case 25:e.next=22;break;case 27:case"end":return e.stop()}},e,this,[[2,14,17,20]])}));return function(){return e.apply(this,arguments)}}()}]),e}(),Io="default",Do=function(){function e(){x(this,e)}return O(e,[{key:"getDevices",value:function(){var t=l(a().mark(function t(n){var r,i,o,s,c,u=arguments;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=!(u.length>1&&void 0!==u[1])||u[1],!((null===(i=e.userMediaPromiseMap)||void 0===i?void 0:i.size)>0)){t.next=16;break}if($.debug("awaiting getUserMedia promise"),t.prev=3,!n){t.next=9;break}return t.next=7,e.userMediaPromiseMap.get(n);case 7:t.next=11;break;case 9:return t.next=11,Promise.all(e.userMediaPromiseMap.values());case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),$.warn("error waiting for media permissons");case 16:return t.next=18,navigator.mediaDevices.enumerateDevices();case 18:if(o=t.sent,!r||!n||e.userMediaPromiseMap.get(n)&&ho()){t.next=30;break}if(!(0===o.length||o.some(function(e){var t=""===e.label,r=!n||e.kind===n;return t&&r}))){t.next=30;break}return s={video:"audioinput"!==n&&"audiooutput"!==n,audio:"videoinput"!==n},t.next=25,navigator.mediaDevices.getUserMedia(s);case 25:return c=t.sent,t.next=28,navigator.mediaDevices.enumerateDevices();case 28:o=t.sent,c.getTracks().forEach(function(e){e.stop()});case 30:return n&&(o=o.filter(function(e){return e.kind===n})),t.abrupt("return",o);case 32:case"end":return t.stop()}},t,null,[[3,13]])}));return function(e){return t.apply(this,arguments)}}()},{key:"normalizeDeviceId",value:function(){var e=l(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n===Io){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,this.getDevices(t);case 4:return i=e.sent,o=i.find(function(e){return e.groupId===r&&e.deviceId!==Io}),e.abrupt("return",null==o?void 0:o.deviceId);case 7:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return void 0===this.instance&&(this.instance=new e),this.instance}}]),e}();Do.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],Do.userMediaPromiseMap=new Map;var Ao,Uo={exports:{}},Lo="object"===("undefined"==typeof Reflect?"undefined":L(Reflect))?Reflect:null,_o=Lo&&"function"==typeof Lo.apply?Lo.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};function Mo(e){console&&console.warn&&console.warn(e)}Ao=Lo&&"function"==typeof Lo.ownKeys?Lo.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var jo=Number.isNaN||function(e){return e!=e};function Bo(){Bo.init.call(this)}Uo.exports=Bo,Uo.exports.once=Ko,Bo.EventEmitter=Bo,Bo.prototype._events=void 0,Bo.prototype._eventsCount=0,Bo.prototype._maxListeners=void 0;var Jo=10;function $o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+L(e))}function Fo(e){return void 0===e._maxListeners?Bo.defaultMaxListeners:e._maxListeners}function Vo(e,t,n,r){var i,a,o;if($o(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=Fo(e))>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,Mo(s)}return e}function qo(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Wo(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=qo.bind(r);return i.listener=n,r.wrapFn=i,i}function Go(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?Zo(i):zo(i,i.length)}function Qo(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function zo(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function Ho(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Zo(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}function Ko(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,a),r(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}Xo(e,t,a,{once:!0}),"error"!==t&&Yo(e,i,{once:!0})})}function Yo(e,t,n){"function"==typeof e.on&&Xo(e,"error",t,n)}function Xo(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+L(e));e.addEventListener(t,function i(a){r.once&&e.removeEventListener(t,i),n(a)})}}Object.defineProperty(Bo,"defaultMaxListeners",{enumerable:!0,get:function(){return Jo},set:function(e){if("number"!=typeof e||e<0||jo(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Jo=e}}),Bo.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Bo.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||jo(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Bo.prototype.getMaxListeners=function(){return Fo(this)},Bo.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)_o(s,this,t);else{var c=s.length,u=zo(s,c);for(n=0;n<c;++n)_o(u[n],this,t)}return!0},Bo.prototype.addListener=function(e,t){return Vo(this,e,t,!1)},Bo.prototype.on=Bo.prototype.addListener,Bo.prototype.prependListener=function(e,t){return Vo(this,e,t,!0)},Bo.prototype.once=function(e,t){return $o(t),this.on(e,Wo(this,e,t)),this},Bo.prototype.prependOnceListener=function(e,t){return $o(t),this.prependListener(e,Wo(this,e,t)),this},Bo.prototype.removeListener=function(e,t){var n,r,i,a,o;if($o(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():Ho(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},Bo.prototype.off=Bo.prototype.removeListener,Bo.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},Bo.prototype.listeners=function(e){return Go(this,e,!0)},Bo.prototype.rawListeners=function(e){return Go(this,e,!1)},Bo.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Qo.call(e,t)},Bo.prototype.listenerCount=Qo,Bo.prototype.eventNames=function(){return this._eventsCount>0?Ao(this._events):[]};var es=5e3,ts=[],ns=function(e){p(n,Uo.exports.EventEmitter);var t=f(n);function n(e,r){var i;return x(this,n),(i=t.call(this)).attachedElements=[],i.isMuted=!1,i.streamState=n.StreamState.Active,i._currentBitrate=0,i.appVisibilityChangedListener=function(){i.backgroundTimeout&&clearTimeout(i.backgroundTimeout),"hidden"===document.visibilityState?i.backgroundTimeout=setTimeout(function(){return i.handleAppVisibilityChanged()},es):i.handleAppVisibilityChanged()},i.setMaxListeners(100),i.kind=r,i._mediaStreamTrack=e,i._mediaStreamID=e.id,i.source=n.Source.Unknown,mo()?(i.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",i.appVisibilityChangedListener)):i.isInBackground=!1,i}return O(n,[{key:"currentBitrate",get:function(){return this._currentBitrate}},{key:"mediaStreamTrack",get:function(){return this._mediaStreamTrack}},{key:"mediaStreamID",get:function(){return this._mediaStreamID}},{key:"attach",value:function(e){var t=this,r="audio";return this.kind===n.Kind.Video&&(r="video"),e||("audio"===r&&(ts.forEach(function(t){null!==t.parentElement||e||(e=t)}),e&&ts.splice(ts.indexOf(e),1)),e||(e=document.createElement(r))),this.attachedElements.includes(e)||this.attachedElements.push(e),rs(this._mediaStreamTrack,e),e instanceof HTMLAudioElement&&e.play().then(function(){t.emit(qa.AudioPlaybackStarted)}).catch(function(e){t.emit(qa.AudioPlaybackFailed,e)}),this.emit(qa.ElementAttached,e),e}},{key:"detach",value:function(e){var t=this;if(e){is(this._mediaStreamTrack,e);var n=this.attachedElements.indexOf(e);return n>=0&&(this.attachedElements.splice(n,1),this.recycleElement(e),this.emit(qa.ElementDetached,e)),e}var r=[];return this.attachedElements.forEach(function(e){is(t._mediaStreamTrack,e),r.push(e),t.recycleElement(e),t.emit(qa.ElementDetached,e)}),this.attachedElements=[],r}},{key:"stop",value:function(){this.stopMonitor(),this._mediaStreamTrack.stop(),mo()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}},{key:"enable",value:function(){this._mediaStreamTrack.enabled=!0}},{key:"disable",value:function(){this._mediaStreamTrack.enabled=!1}},{key:"stopMonitor",value:function(){this.monitorInterval&&clearInterval(this.monitorInterval)}},{key:"recycleElement",value:function(e){if(e instanceof HTMLAudioElement){var t=!0;e.pause(),ts.forEach(function(e){e.parentElement||(t=!1)}),t&&ts.push(e)}}},{key:"handleAppVisibilityChanged",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.isInBackground="hidden"===document.visibilityState;case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();function rs(e,t){var n,r;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,(r="audio"===e.kind?n.getAudioTracks():n.getVideoTracks()).includes(e)||(r.forEach(function(e){n.removeTrack(e)}),n.addTrack(e)),t.srcObject!==n&&(t.srcObject=n,(ho()||fo())&&t instanceof HTMLVideoElement&&setTimeout(function(){t.srcObject=n,t.play().catch(function(){})},0)),t.autoplay=!0,t instanceof HTMLVideoElement&&(t.playsInline=!0)}function is(e,t){if(t.srcObject instanceof MediaStream){var n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}exports.Track=ns,function(e){var t,n,r;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(r=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return Lt.AUDIO;case t.Video:return Lt.VIDEO;default:return Lt.UNRECOGNIZED}},e.kindFromProto=function(e){switch(e){case Lt.AUDIO:return t.Audio;case Lt.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return _t.CAMERA;case n.Microphone:return _t.MICROPHONE;case n.ScreenShare:return _t.SCREEN_SHARE;case n.ScreenShareAudio:return _t.SCREEN_SHARE_AUDIO;default:return _t.UNRECOGNIZED}},e.sourceFromProto=function(e){switch(e){case _t.CAMERA:return n.Camera;case _t.MICROPHONE:return n.Microphone;case _t.SCREEN_SHARE:return n.ScreenShare;case _t.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case fi.ACTIVE:return r.Active;case fi.PAUSED:return r.Paused;default:return r.Unknown}}}(ns||(exports.Track=ns={}));var as=function(e){p(n,ns);var t=f(n);function n(e,r,i){var a;x(this,n);var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return(a=t.call(this,e,r))._isUpstreamPaused=!1,a.handleEnded=function(){a.isInBackground&&(a.reacquireTrack=!0),a.emit(qa.Ended,v(a))},a._mediaStreamTrack.addEventListener("ended",a.handleEnded),a.constraints=null!=i?i:e.getConstraints(),a.reacquireTrack=!1,a.providedByUser=o,a.muteQueue=new No,a}return O(n,[{key:"id",get:function(){return this._mediaStreamTrack.id}},{key:"dimensions",get:function(){if(this.kind===ns.Kind.Video){var e=this._mediaStreamTrack.getSettings(),t=e.width,n=e.height;return t&&n?{width:t,height:n}:void 0}}},{key:"isUpstreamPaused",get:function(){return this._isUpstreamPaused}},{key:"isUserProvided",get:function(){return this.providedByUser}},{key:"getDeviceId",value:function(){var e=l(a().mark(function e(){var t,n,r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.source!==ns.Source.ScreenShare){e.next=2;break}return e.abrupt("return");case 2:return t=this._mediaStreamTrack.getSettings(),n=t.deviceId,r=t.groupId,i=this.kind===ns.Kind.Audio?"audioinput":"videoinput",e.abrupt("return",Do.getInstance().normalizeDeviceId(i,n,r));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"mute",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setTrackMuted(!0),e.abrupt("return",this);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unmute",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setTrackMuted(!1),e.abrupt("return",this);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=l(a().mark(function e(t){var n,r=this,i=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(i.length>1&&void 0!==i[1])||i[1],this.sender){e.next=3;break}throw new _a("unable to replace an unpublished track");case 3:if(this.attachedElements.forEach(function(e){is(r._mediaStreamTrack,e)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this.providedByUser||this._mediaStreamTrack.stop(),t.addEventListener("ended",this.handleEnded),$.debug("replace MediaStreamTrack"),!this.sender){e.next=11;break}return e.next=11,this.sender.replaceTrack(t);case 11:return this._mediaStreamTrack=t,this._mediaStreamTrack.enabled=!this.isMuted,e.next=15,this.resumeUpstream();case 15:return this.attachedElements.forEach(function(e){rs(t,e)}),this.mediaStream=new MediaStream([t]),this.providedByUser=n,e.abrupt("return",this);case 19:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"restart",value:function(){var e=l(a().mark(function e(t){var n,r,i,o=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t=this.constraints),$.debug("restarting track with constraints",t),n={audio:!1,video:!1},this.kind===ns.Kind.Video?n.video=t:n.audio=t,this.attachedElements.forEach(function(e){is(o._mediaStreamTrack,e)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop(),e.next=9,navigator.mediaDevices.getUserMedia(n);case 9:if(r=e.sent,(i=r.getTracks()[0]).addEventListener("ended",this.handleEnded),$.debug("re-acquired MediaStreamTrack"),!this.sender){e.next=16;break}return e.next=16,this.sender.replaceTrack(i);case 16:return this._mediaStreamTrack=i,e.next=19,this.resumeUpstream();case 19:return this.attachedElements.forEach(function(e){rs(i,e)}),this.mediaStream=r,this.constraints=t,e.abrupt("return",this);case 23:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setTrackMuted",value:function(e){$.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted")),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?qa.Muted:qa.Unmuted,this))}},{key:"needsReAcquisition",get:function(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}},{key:"handleAppVisibilityChanged",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(S(n.prototype),"handleAppVisibilityChanged",this).call(this);case 2:if(vo()){e.next=4;break}return e.abrupt("return");case 4:if($.debug("visibility changed, is in Background: ".concat(this.isInBackground)),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted){e.next=10;break}return $.debug("track needs to be reaquired, restarting ".concat(this.source)),e.next=9,this.restart();case 9:this.reacquireTrack=!1;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"pauseUpstream",value:function(){var e=l(a().mark(function e(){var t=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.muteQueue.run(l(a().mark(function e(){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==t._isUpstreamPaused){e.next=2;break}return e.abrupt("return");case 2:if(t.sender){e.next=5;break}return $.warn("unable to pause upstream for an unpublished track"),e.abrupt("return");case 5:return t._isUpstreamPaused=!0,t.emit(qa.UpstreamPaused,t),n=t.kind===ns.Kind.Audio?Ro():xo(),e.next=10,t.sender.replaceTrack(n);case 10:case"end":return e.stop()}},e)})));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"resumeUpstream",value:function(){var e=l(a().mark(function e(){var t=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.muteQueue.run(l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==t._isUpstreamPaused){e.next=2;break}return e.abrupt("return");case 2:if(t.sender){e.next=5;break}return $.warn("unable to resume upstream for an unpublished track"),e.abrupt("return");case 5:return t._isUpstreamPaused=!1,t.emit(qa.UpstreamResumed,t),e.next=9,t.sender.replaceTrack(t._mediaStreamTrack);case 9:case"end":return e.stop()}},e)})));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();function os(e,t,n){var r=ar({},e);return!0===r.audio&&(r.audio={}),!0===r.video&&(r.video={}),r.audio&&ss(r.audio,t),r.video&&ss(r.video,n),r}function ss(e,t){return Object.keys(t).forEach(function(n){void 0===e[n]&&(e[n]=t[n])}),e}function cs(e){var t={};if(e.video)if("object"===L(e.video)){var n={},r=n,i=e.video;Object.keys(i).forEach(function(e){switch(e){case"resolution":ss(r,i.resolution);break;default:r[e]=i[e]}}),t.video=n}else t.video=e.video;else t.video=!1;return e.audio?"object"===L(e.audio)?t.audio=e.audio:t.audio=!0:t.audio=!1,t}function us(e){return ds.apply(this,arguments)}function ds(){return(ds=l(a().mark(function e(t){var n,r,i,o,s,c,u=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:200,!(r=ls())){e.next=15;break}return(i=r.createAnalyser()).fftSize=2048,o=i.frequencyBinCount,s=new Uint8Array(o),r.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(i),e.next=11,to(n);case 11:return i.getByteTimeDomainData(s),c=s.some(function(e){return 128!==e&&0!==e}),r.close(),e.abrupt("return",!c);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ls(){var e=window.AudioContext||window.webkitAudioContext;if(e)return new e({latencyHint:"interactive"})}exports.LocalTrack=as;var ps=function(e){p(n,as);var t=f(n);function n(e,r){var i;x(this,n);var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(i=t.call(this,e,ns.Kind.Audio,r,o)).stopOnMute=!1,i.monitorSender=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.sender){e.next=3;break}return i._currentBitrate=0,e.abrupt("return");case 3:return e.prev=3,e.next=6,i.getSenderStats();case 6:t=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),$.error("could not get audio sender stats",{error:e.t0}),e.abrupt("return");case 13:t&&i.prevStats&&(i._currentBitrate=Qa(t,i.prevStats)),i.prevStats=t;case 15:case"end":return e.stop()}},e,null,[[3,9]])})),i.checkForSilence(),i}return O(n,[{key:"setDeviceId",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.constraints.deviceId!==t){e.next=2;break}return e.abrupt("return");case 2:if(this.constraints.deviceId=t,this.isMuted){e.next=6;break}return e.next=6,this.restartTrack();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"mute",value:function(){var e=l(a().mark(function e(){var t=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.muteQueue.run(l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.source===ns.Source.Microphone&&t.stopOnMute&&!t.isUserProvided&&($.debug("stopping mic track"),t._mediaStreamTrack.stop()),e.next=3,r(S(n.prototype),"mute",t).call(t);case 3:case"end":return e.stop()}},e)})));case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unmute",value:function(){var e=l(a().mark(function e(){var t=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.muteQueue.run(l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.source!==ns.Source.Microphone||!t.stopOnMute||t.isUserProvided){e.next=4;break}return $.debug("reacquiring mic track"),e.next=4,t.restartTrack();case 4:return e.next=6,r(S(n.prototype),"unmute",t).call(t);case 6:case"end":return e.stop()}},e)})));case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"restartTrack",value:function(){var e=l(a().mark(function e(t){var n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t&&"boolean"!=typeof(r=cs({audio:t})).audio&&(n=r.audio),e.next=3,this.restart(n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"restart",value:function(){var e=l(a().mark(function e(t){var i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(S(n.prototype),"restart",this).call(this,t);case 2:return i=e.sent,this.checkForSilence(),e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"startMonitor",value:function(){var e=this;mo()&&(this.monitorInterval||(this.monitorInterval=setInterval(function(){e.monitorSender()},Ga)))}},{key:"getSenderStats",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.next=4,this.sender.getStats();case 4:return e.sent.forEach(function(e){"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})}),e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkForSilence",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,us(this);case 2:e.sent&&(this.isMuted||$.warn("silence detected on local audio track"),this.emit(qa.AudioSilenceDetected));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();exports.LocalAudioTrack=ps;var fs=5e3,hs=function(e){p(n,as);var t=f(n);function n(e,r){var i;x(this,n);var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(i=t.call(this,e,ns.Kind.Video,r,o)).simulcastCodecs=new Map,i.monitorSender=l(a().mark(function e(){var t,n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.sender){e.next=3;break}return i._currentBitrate=0,e.abrupt("return");case 3:return e.prev=3,e.next=6,i.getSenderStats();case 6:t=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),$.error("could not get audio sender stats",{error:e.t0}),e.abrupt("return");case 13:n=new Map(t.map(function(e){return[e.rid,e]})),i.prevStats&&(r=0,n.forEach(function(e,t){var n,a=null===(n=i.prevStats)||void 0===n?void 0:n.get(t);r+=Qa(e,a)}),i._currentBitrate=r),i.prevStats=n;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),i}return O(n,[{key:"isSimulcast",get:function(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}},{key:"startMonitor",value:function(e){var t,n=this;if(this.signalClient=e,mo()){var r=null===(t=this.sender)||void 0===t?void 0:t.getParameters();r&&(this.encodings=r.encodings),this.monitorInterval||(this.monitorInterval=setInterval(function(){n.monitorSender()},Ga))}}},{key:"stop",value:function(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(function(e){e.mediaStreamTrack.stop()}),r(S(n.prototype),"stop",this).call(this)}},{key:"mute",value:function(){var e=l(a().mark(function e(){var t=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.muteQueue.run(l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.source!==ns.Source.Camera||t.isUserProvided||($.debug("stopping camera track"),t._mediaStreamTrack.stop()),e.next=3,r(S(n.prototype),"mute",t).call(t);case 3:case"end":return e.stop()}},e)})));case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unmute",value:function(){var e=l(a().mark(function e(){var t=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.muteQueue.run(l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.source!==ns.Source.Camera||t.isUserProvided){e.next=4;break}return $.debug("reacquiring camera track"),e.next=4,t.restartTrack();case 4:return e.next=6,r(S(n.prototype),"unmute",t).call(t);case 6:case"end":return e.stop()}},e)})));case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=l(a().mark(function e(){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender){e.next=2;break}return e.abrupt("return",[]);case 2:return t=[],e.next=5,this.sender.getStats();case 5:return(n=e.sent).forEach(function(e){var r;if("outbound-rtp"===e.type){var i={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,framesSent:e.framesSent,timestamp:e.timestamp,rid:null!==(r=e.rid)&&void 0!==r?r:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges},a=n.get(e.remoteId);a&&(i.jitter=a.jitter,i.packetsLost=a.packetsLost,i.roundTripTime=a.roundTripTime),t.push(i)}}),e.abrupt("return",t);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setPublishingQuality",value:function(e){for(var t=[],n=Mt.LOW;n<=Mt.HIGH;n+=1)t.push({quality:n,enabled:n<=e});$.debug("setting publishing quality. max quality ".concat(e)),this.setPublishingLayers(t)}},{key:"setDeviceId",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.constraints.deviceId!==t){e.next=2;break}return e.abrupt("return");case 2:if(this.constraints.deviceId=t,this.isMuted){e.next=6;break}return e.next=6,this.restartTrack();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"restartTrack",value:function(){var e=l(a().mark(function e(t){var n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t&&"boolean"!=typeof(r=cs({video:t})).video&&(n=r.video),e.next=3,this.restart(n);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addSimulcastTrack",value:function(e,t){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));var n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}},{key:"setSimulcastTrackSender",value:function(e,t){var n=this,r=this.simulcastCodecs.get(e);r&&(r.sender=t,setTimeout(function(){n.subscribedCodecs&&n.setPublishingCodecs(n.subscribedCodecs)},fs))}},{key:"setPublishingCodecs",value:function(){var e=l(a().mark(function e(t){var n,r,i,o,s,c,u,d,l,p;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($.debug("setting publishing codecs",{codecs:t,currentCodec:this.codec}),this.codec||!(t.length>0)){e.next=5;break}return e.next=4,this.setPublishingLayers(t[0].qualities);case 4:return e.abrupt("return",[]);case 5:this.subscribedCodecs=t,n=[],r=!1,i=!1,e.prev=9,s=nr(t);case 11:return e.next=13,s.next();case 13:if(!(r=!(c=e.sent).done)){e.next=50;break}if(u=c.value,this.codec&&this.codec!==u.codec){e.next=20;break}return e.next=18,this.setPublishingLayers(u.qualities);case 18:e.next=47;break;case 20:if(d=this.simulcastCodecs.get(u.codec),$.debug("try setPublishingCodec for ".concat(u.codec),d),d&&d.sender){e.next=43;break}l=D(u.qualities),e.prev=24,l.s();case 26:if((p=l.n()).done){e.next=33;break}if(!p.value.enabled){e.next=31;break}return n.push(u.codec),e.abrupt("break",33);case 31:e.next=26;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(24),l.e(e.t0);case 38:return e.prev=38,l.f(),e.finish(38);case 41:e.next=47;break;case 43:if(!d.encodings){e.next=47;break}return $.debug("try setPublishingLayersForSender ".concat(u.codec)),e.next=47,vs(d.sender,d.encodings,u.qualities);case 47:r=!1,e.next=11;break;case 50:e.next=56;break;case 52:e.prev=52,e.t1=e.catch(9),i=!0,o=e.t1;case 56:if(e.prev=56,e.prev=57,!r||null==s.return){e.next=61;break}return e.next=61,s.return();case 61:if(e.prev=61,!i){e.next=64;break}throw o;case 64:return e.finish(61);case 65:return e.finish(56);case 66:return e.abrupt("return",n);case 67:case"end":return e.stop()}},e,this,[[9,52,56,66],[24,35,38,41],[57,,61,65]])}));return function(t){return e.apply(this,arguments)}}()},{key:"setPublishingLayers",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($.debug("setting publishing layers",t),this.sender&&this.encodings){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,vs(this.sender,this.encodings,t);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleAppVisibilityChanged",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(S(n.prototype),"handleAppVisibilityChanged",this).call(this);case 2:if(vo()){e.next=4;break}return e.abrupt("return");case 4:this.isInBackground&&this.source===ns.Source.Camera&&(this._mediaStreamTrack.enabled=!1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();function vs(e,t,n){return ms.apply(this,arguments)}function ms(){return(ms=l(a().mark(function e(t,n,r){var i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($.debug("setPublishingLayersForSender",{sender:t,qualities:r,senderEncodings:n}),i=t.getParameters(),o=i.encodings){e.next=5;break}return e.abrupt("return");case 5:if(o.length===n.length){e.next=8;break}return $.warn("cannot set publishing layers, encodings mismatch"),e.abrupt("return");case 8:if(s=!1,o.forEach(function(e,t){var i,a=null!==(i=e.rid)&&void 0!==i?i:"";""===a&&(a="q");var o=gs(a),c=r.find(function(e){return e.quality===o});c&&e.active!==c.enabled&&(s=!0,e.active=c.enabled,$.debug("setting layer ".concat(c.quality," to ").concat(e.active?"enabled":"disabled")),fo()&&(c.enabled?(e.scaleResolutionDownBy=n[t].scaleResolutionDownBy,e.maxBitrate=n[t].maxBitrate,e.maxFrameRate=n[t].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))}),!s){e.next=14;break}return i.encodings=o,e.next=14,t.setParameters(i);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gs(e){switch(e){case"f":return Mt.HIGH;case"h":return Mt.MEDIUM;case"q":return Mt.LOW;default:return Mt.UNRECOGNIZED}}function bs(e,t,n){return n?n.map(function(r){var i,a,o,s=null!==(i=r.scaleResolutionDownBy)&&void 0!==i?i:1,c=gs(null!==(a=r.rid)&&void 0!==a?a:"");return c===Mt.UNRECOGNIZED&&1===n.length&&(c=Mt.HIGH),{quality:c,width:e/s,height:t/s,bitrate:null!==(o=r.maxBitrate)&&void 0!==o?o:0,ssrc:0}}):[{quality:Mt.HIGH,width:e,height:t,bitrate:0,ssrc:0}]}exports.LocalVideoTrack=hs;var ks=function(e){p(n,ns);var t=f(n);function n(e,r,i,a){var o;return x(this,n),(o=t.call(this,e,i)).sid=r,o.receiver=a,o}return O(n,[{key:"setMuted",value:function(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?qa.Muted:qa.Unmuted,this))}},{key:"setMediaStream",value:function(e){var t=this;this.mediaStream=e,e.onremovetrack=function(){t.receiver=void 0,t._currentBitrate=0,t.emit(qa.Ended,t)}}},{key:"start",value:function(){this.startMonitor(),r(S(n.prototype),"enable",this).call(this)}},{key:"stop",value:function(){this.stopMonitor(),r(S(n.prototype),"disable",this).call(this)}},{key:"startMonitor",value:function(){var e=this;this.monitorInterval||(this.monitorInterval=setInterval(function(){return e.monitorReceiver()},Ga))}}]),n}();exports.RemoteTrack=ks;var ys=function(e){p(n,ks);var t=f(n);function n(e,r,i,o,s){var c;return x(this,n),(c=t.call(this,e,r,ns.Kind.Audio,i)).monitorReceiver=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.receiver){e.next=3;break}return c._currentBitrate=0,e.abrupt("return");case 3:return e.next=5,c.getReceiverStats();case 5:(t=e.sent)&&c.prevStats&&c.receiver&&(c._currentBitrate=Qa(t,c.prevStats)),c.prevStats=t;case 8:case"end":return e.stop()}},e)})),c.audioContext=o,c.webAudioPluginNodes=[],s&&(c.sinkId=s.deviceId),c}return O(n,[{key:"setVolume",value:function(e){var t,n,r=D(this.attachedElements);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):i.volume=e}}catch(a){r.e(a)}finally{r.f()}this.elementVolume=e}},{key:"getVolume",value:function(){if(this.elementVolume)return this.elementVolume;var e=0;return this.attachedElements.forEach(function(t){t.volume>e&&(e=t.volume)}),e}},{key:"setSinkId",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.sinkId=t,e.next=3,Promise.all(this.attachedElements.map(function(e){if(co(e))return e.setSinkId(t)}));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"attach",value:function(e){var t=0===this.attachedElements.length;return e?r(S(n.prototype),"attach",this).call(this,e):e=r(S(n.prototype),"attach",this).call(this),this.elementVolume&&(e.volume=this.elementVolume),this.sinkId&&co(e)&&e.setSinkId(this.sinkId),this.audioContext&&t&&($.debug("using audio context mapping"),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),e}},{key:"detach",value:function(e){var t;return e?(t=r(S(n.prototype),"detach",this).call(this,e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=r(S(n.prototype),"detach",this).call(this),this.disconnectWebAudio()),t}},{key:"setAudioContext",value:function(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}},{key:"setWebAudioPlugins",value:function(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}},{key:"connectWebAudio",value:function(e,t){var n=this;this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);var r=this.sourceNode;this.webAudioPluginNodes.forEach(function(e){r.connect(e),r=e}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then(function(){"running"!==e.state&&n.emit(qa.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(function(e){n.emit(qa.AudioPlaybackFailed,e)})}},{key:"disconnectWebAudio",value:function(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}},{key:"getReceiverStats",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.receiver&&this.receiver.getStats){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.receiver.getStats();case 4:return e.sent.forEach(function(e){"inbound-rtp"===e.type&&(t={type:"audio",timestamp:e.timestamp,jitter:e.jitter,bytesReceived:e.bytesReceived,concealedSamples:e.concealedSamples,concealmentEvents:e.concealmentEvents,silentConcealedSamples:e.silentConcealedSamples,silentConcealmentEvents:e.silentConcealmentEvents,totalAudioEnergy:e.totalAudioEnergy,totalSamplesDuration:e.totalSamplesDuration})}),e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();function Ss(e,t,n){var r,i,a;void 0===t&&(t=50),void 0===n&&(n={});var o=null!=(r=n.isImmediate)&&r,s=null!=(i=n.callback)&&i,c=n.maxWait,u=Date.now(),d=[];function l(){if(void 0!==c){var e=Date.now()-u;if(e+t>=c)return c-e}return t}var p=function(){var t=[].slice.call(arguments),n=this;return new Promise(function(r,i){var c=o&&void 0===a;if(void 0!==a&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,u=Date.now(),!o){var r=e.apply(n,t);s&&s(r),d.forEach(function(e){return(0,e.resolve)(r)}),d=[]}},l()),c){var p=e.apply(n,t);return s&&s(p),r(p)}d.push({resolve:r,reject:i})})};return p.cancel=function(e){void 0!==a&&clearTimeout(a),d.forEach(function(t){return(0,t.reject)(e)}),d=[]},p}exports.RemoteAudioTrack=ys;var ws=100,Cs=function(e){p(n,ks);var t=f(n);function n(e,r,i,o){var s;return x(this,n),(s=t.call(this,e,r,ns.Kind.Video,i)).elementInfos=[],s.hasUsedAttach=!1,s.monitorReceiver=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s.receiver){e.next=3;break}return s._currentBitrate=0,e.abrupt("return");case 3:return e.next=5,s.getReceiverStats();case 5:(t=e.sent)&&s.prevStats&&s.receiver&&(s._currentBitrate=Qa(t,s.prevStats)),s.prevStats=t;case 8:case"end":return e.stop()}},e)})),s.debouncedHandleResize=Ss(function(){s.updateDimensions()},ws),s.adaptiveStreamSettings=o,s.isAdaptiveStream&&(s.streamState=ns.StreamState.Paused),s}return O(n,[{key:"isAdaptiveStream",get:function(){return void 0!==this.adaptiveStreamSettings}},{key:"mediaStreamTrack",get:function(){return this.isAdaptiveStream&&!this.hasUsedAttach&&$.warn("When using adaptiveStream, you need to use remoteVideoTrack.attach() to add the track to a HTMLVideoElement, otherwise your video tracks might never start"),this._mediaStreamTrack}},{key:"setMuted",value:function(e){var t=this;r(S(n.prototype),"setMuted",this).call(this,e),this.attachedElements.forEach(function(n){e?is(t._mediaStreamTrack,n):rs(t._mediaStreamTrack,n)})}},{key:"attach",value:function(e){if(e?r(S(n.prototype),"attach",this).call(this,e):e=r(S(n.prototype),"attach",this).call(this),this.adaptiveStreamSettings&&void 0===this.elementInfos.find(function(t){return t.element===e})){var t=new Ts(e);this.observeElementInfo(t)}return this.hasUsedAttach=!0,e}},{key:"observeElementInfo",value:function(e){var t=this;this.adaptiveStreamSettings&&void 0===this.elementInfos.find(function(t){return t===e})?(e.handleResize=function(){t.debouncedHandleResize()},e.handleVisibilityChanged=function(){t.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):$.warn("visibility resize observer not triggered")}},{key:"stopObservingElementInfo",value:function(e){var t,n=D(this.elementInfos.filter(function(t){return t===e}));try{for(n.s();!(t=n.n()).done;){t.value.stopObserving()}}catch(r){n.e(r)}finally{n.f()}this.elementInfos=this.elementInfos.filter(function(t){return t!==e}),this.updateVisibility()}},{key:"detach",value:function(e){var t;if(e)return this.stopObservingElement(e),r(S(n.prototype),"detach",this).call(this,e);var i,a=D(t=r(S(n.prototype),"detach",this).call(this));try{for(a.s();!(i=a.n()).done;){var o=i.value;this.stopObservingElement(o)}}catch(s){a.e(s)}finally{a.f()}return t}},{key:"getDecoderImplementation",value:function(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}},{key:"getReceiverStats",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.receiver&&this.receiver.getStats){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.receiver.getStats();case 4:return e.sent.forEach(function(e){"inbound-rtp"===e.type&&(t={type:"video",framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation})}),e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"stopObservingElement",value:function(e){var t,n=D(this.elementInfos.filter(function(t){return t.element===e}));try{for(n.s();!(t=n.n()).done;){t.value.stopObserving()}}catch(r){n.e(r)}finally{n.f()}this.elementInfos=this.elementInfos.filter(function(t){return t.element!==e})}},{key:"handleAppVisibilityChanged",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(S(n.prototype),"handleAppVisibilityChanged",this).call(this);case 2:if(this.isAdaptiveStream){e.next=4;break}return e.abrupt("return");case 4:this.updateVisibility();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateVisibility",value:function(){var e,t,n=this,r=this.elementInfos.reduce(function(e,t){return Math.max(e,t.visibilityChangedAt||0)},0),i=!(null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pauseVideoInBackground)&&void 0!==t&&!t)&&this.isInBackground,a=this.elementInfos.some(function(e){return e.visible})&&!i;this.lastVisible!==a&&(!a&&Date.now()-r<ws?setTimeout(function(){n.updateVisibility()},ws):(this.lastVisible=a,this.emit(qa.VisibilityChanged,a,this)))}},{key:"updateDimensions",value:function(){var e,t,n,r,i,a=0,o=0,s=D(this.elementInfos);try{for(s.s();!(i=s.n()).done;){var c=i.value,u=null!==(t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity)&&void 0!==t?t:1,d="screen"===u?window.devicePixelRatio:u,l=c.width()*d,p=c.height()*d;l+p>a+o&&(a=l,o=p)}}catch(f){s.e(f)}finally{s.f()}(null===(n=this.lastDimensions)||void 0===n?void 0:n.width)===a&&(null===(r=this.lastDimensions)||void 0===r?void 0:r.height)===o||(this.lastDimensions={width:a,height:o},this.emit(qa.VideoDimensionsChanged,this.lastDimensions,this))}}]),n}();exports.RemoteVideoTrack=Cs;var Ts=function(){function e(t,n){var r=this;x(this,e),this.onVisibilityChanged=function(e){var t,n=e.target,i=e.isIntersecting;n===r.element&&(r.visible=i,r.visibilityChangedAt=Date.now(),null===(t=r.handleVisibilityChanged)||void 0===t||t.call(r))},this.element=t,this.visible=null!=n?n:Ps(t),this.visibilityChangedAt=0}return O(e,[{key:"width",value:function(){return this.element.clientWidth}},{key:"height",value:function(){return this.element.clientHeight}},{key:"observe",value:function(){var e=this;this.element.handleResize=function(){var t;null===(t=e.handleResize)||void 0===t||t.call(e)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Po().observe(this.element),Co().observe(this.element)}},{key:"stopObserving",value:function(){var e,t;null===(e=Po())||void 0===e||e.unobserve(this.element),null===(t=Co())||void 0===t||t.unobserve(this.element)}}]),e}();function Ps(e){for(var t=e.offsetTop,n=e.offsetLeft,r=e.offsetWidth,i=e.offsetHeight,a=e.hidden,o=getComputedStyle(e),s=o.opacity,c=o.display;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+i>window.pageYOffset&&n+r>window.pageXOffset&&!a&&(""===s||parseFloat(s)>0)&&"none"!==c}var Es=function(e){p(n,Uo.exports.EventEmitter);var t=f(n);function n(e,r,i){var a;return x(this,n),(a=t.call(this)).metadataMuted=!1,a.handleMuted=function(){a.emit(qa.Muted)},a.handleUnmuted=function(){a.emit(qa.Unmuted)},a.setMaxListeners(100),a.kind=e,a.trackSid=r,a.trackName=i,a.source=ns.Source.Unknown,a}return O(n,[{key:"setTrack",value:function(e){this.track&&(this.track.off(qa.Muted,this.handleMuted),this.track.off(qa.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(qa.Muted,this.handleMuted),e.on(qa.Unmuted,this.handleUnmuted))}},{key:"isMuted",get:function(){return this.metadataMuted}},{key:"isEnabled",get:function(){return!0}},{key:"isSubscribed",get:function(){return void 0!==this.track}},{key:"audioTrack",get:function(){if(this.track instanceof ps||this.track instanceof ys)return this.track}},{key:"videoTrack",get:function(){if(this.track instanceof hs||this.track instanceof Cs)return this.track}},{key:"updateInfo",value:function(e){this.trackSid=e.sid,this.trackName=e.name,this.source=ns.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===ns.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.trackInfo=e,$.trace("update publication info",{info:e})}}]),n}();exports.TrackPublication=Es,function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(Es||(exports.TrackPublication=Es={}));var xs=function(e){p(n,Es);var t=f(n);function n(e,r,i){var a;return x(this,n),(a=t.call(this,e,r.sid,r.name)).track=void 0,a.handleTrackEnded=function(){a.emit(qa.Ended)},a.updateInfo(r),a.setTrack(i),a}return O(n,[{key:"isUpstreamPaused",get:function(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}},{key:"setTrack",value:function(e){this.track&&this.track.off(qa.Ended,this.handleTrackEnded),r(S(n.prototype),"setTrack",this).call(this,e),e&&e.on(qa.Ended,this.handleTrackEnded)}},{key:"isMuted",get:function(){return this.track?this.track.isMuted:r(S(n.prototype),"isMuted",this)}},{key:"audioTrack",get:function(){return r(S(n.prototype),"audioTrack",this)}},{key:"videoTrack",get:function(){return r(S(n.prototype),"videoTrack",this)}},{key:"mute",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.track)||void 0===t?void 0:t.mute());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"unmute",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(t=this.track)||void 0===t?void 0:t.unmute());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"pauseUpstream",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.track)||void 0===t?void 0:t.pauseUpstream();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"resumeUpstream",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.track)||void 0===t?void 0:t.resumeUpstream();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();exports.LocalTrackPublication=xs;var Rs=function(){function e(t,n,r,i){x(this,e),this.width=t,this.height=n,this.encoding={maxBitrate:r,maxFramerate:i}}return O(e,[{key:"resolution",get:function(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}]),e}();exports.VideoPreset=Rs;var Os,Ns=["vp8","h264"];function Is(e){return!!Ns.find(function(t){return t===e})}exports.AudioPresets=Os,function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:2e4},e.music={maxBitrate:32e3},e.musicStereo={maxBitrate:48e3},e.musicHighQuality={maxBitrate:64e3},e.musicHighQualityStereo={maxBitrate:96e3}}(Os||(exports.AudioPresets=Os={}));var Ds={h90:new Rs(160,90,6e4,15),h180:new Rs(320,180,12e4,15),h216:new Rs(384,216,18e4,15),h360:new Rs(640,360,3e5,20),h540:new Rs(960,540,6e5,25),h720:new Rs(1280,720,17e5,30),h1080:new Rs(1920,1080,3e6,30),h1440:new Rs(2560,1440,5e6,30),h2160:new Rs(3840,2160,8e6,30)};exports.VideoPresets=Ds;var As={h120:new Rs(160,120,8e4,15),h180:new Rs(240,180,1e5,15),h240:new Rs(320,240,15e4,15),h360:new Rs(480,360,225e3,20),h480:new Rs(640,480,3e5,20),h540:new Rs(720,540,45e4,25),h720:new Rs(960,720,15e5,30),h1080:new Rs(1440,1080,25e5,30),h1440:new Rs(1920,1440,35e5,30)};exports.VideoPresets43=As;var Us,Ls={h360fps3:new Rs(640,360,2e5,3),h720fps5:new Rs(1280,720,4e5,5),h720fps15:new Rs(1280,720,1e6,15),h1080fps15:new Rs(1920,1080,15e5,15),h1080fps30:new Rs(1920,1080,3e6,30)};function _s(e){switch(e){case jt.EXCELLENT:return Us.Excellent;case jt.GOOD:return Us.Good;case jt.POOR:return Us.Poor;default:return Us.Unknown}}exports.ScreenSharePresets=Ls,exports.ConnectionQuality=Us,function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Unknown="unknown"}(Us||(exports.ConnectionQuality=Us={}));var Ms=function(e){p(n,Uo.exports.EventEmitter);var t=f(n);function n(e,r,i,a){var o;return x(this,n),(o=t.call(this)).audioLevel=0,o.isSpeaking=!1,o._connectionQuality=Us.Unknown,o.setMaxListeners(100),o.sid=e,o.identity=r,o.name=i,o.metadata=a,o.audioTracks=new Map,o.videoTracks=new Map,o.tracks=new Map,o}return O(n,[{key:"getTracks",value:function(){return Array.from(this.tracks.values())}},{key:"getTrack",value:function(e){if(e!==ns.Source.Unknown){var t,n=D(this.tracks);try{for(n.s();!(t=n.n()).done;){var r=o(t.value,2)[1];if(r.source===e)return r}}catch(i){n.e(i)}finally{n.f()}}}},{key:"getTrackByName",value:function(e){var t,n=D(this.tracks);try{for(n.s();!(t=n.n()).done;){var r=o(t.value,2)[1];if(r.trackName===e)return r}}catch(i){n.e(i)}finally{n.f()}}},{key:"connectionQuality",get:function(){return this._connectionQuality}},{key:"isCameraEnabled",get:function(){var e,t=this.getTrack(ns.Source.Camera);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}},{key:"isMicrophoneEnabled",get:function(){var e,t=this.getTrack(ns.Source.Microphone);return!(null===(e=null==t?void 0:t.isMuted)||void 0===e||e)}},{key:"isScreenShareEnabled",get:function(){return!!this.getTrack(ns.Source.ScreenShare)}},{key:"isLocal",get:function(){return!1}},{key:"joinedAt",get:function(){return this.participantInfo?new Date(1e3*this.participantInfo.joinedAt):new Date}},{key:"updateInfo",value:function(e){this.identity=e.identity,this.sid=e.sid,this.name=e.name,this.setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,$.trace("update participant info",{info:e})}},{key:"setMetadata",value:function(e){var t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Fa.ParticipantMetadataChanged,n)}},{key:"setPermissions",value:function(e){var t,n,r,i,a,o=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(r=this.permissions)||void 0===r?void 0:r.canPublishData)||e.hidden!==(null===(i=this.permissions)||void 0===i?void 0:i.hidden)||e.recorder!==(null===(a=this.permissions)||void 0===a?void 0:a.recorder);return this.permissions=e,o}},{key:"setIsSpeaking",value:function(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Fa.IsSpeakingChanged,e))}},{key:"setConnectionQuality",value:function(e){var t=this._connectionQuality;this._connectionQuality=_s(e),t!==this._connectionQuality&&this.emit(Fa.ConnectionQualityChanged,this._connectionQuality)}},{key:"addTrackPublication",value:function(e){var t=this;e.on(qa.Muted,function(){t.emit(Fa.TrackMuted,e)}),e.on(qa.Unmuted,function(){t.emit(Fa.TrackUnmuted,e)});var n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case ns.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case ns.Kind.Video:this.videoTracks.set(e.trackSid,e)}}}]),n}();function js(e){var t,n,r;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return{participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(r=e.allowAll)&&void 0!==r&&r,trackSids:e.allowedTrackSids||[]}}function Bs(e,t){switch(e.kind){case"audio":return new ps(e,t,!1);case"video":return new hs(e,t,!1);default:throw new _a("unsupported track type: ".concat(e.kind))}}exports.Participant=Ms;var Js=Object.values(Ds),$s=Object.values(As),Fs=Object.values(Ls),Vs=[Ds.h180,Ds.h360],qs=[As.h180,As.h360],Ws=function(e){return[{scaleResolutionDownBy:2,fps:3}].map(function(t){var n;return new Rs(Math.floor(e.width/t.scaleResolutionDownBy),Math.floor(e.height/t.scaleResolutionDownBy),Math.max(15e4,Math.floor(e.encoding.maxBitrate/(Math.pow(t.scaleResolutionDownBy,2)*((null!==(n=e.encoding.maxFramerate)&&void 0!==n?n:30)/t.fps)))),t.fps)})},Gs=["q","h","f"];function Qs(e,t,n,r){var i,a,s=null==r?void 0:r.videoEncoding;e&&(s=null==r?void 0:r.screenShareEncoding);var c=null==r?void 0:r.simulcast,u=null==r?void 0:r.scalabilityMode,d=null==r?void 0:r.videoCodec;if(!s&&!c&&!u||!t||!n)return[{}];s||(s=Hs(e,t,n,d),$.debug("using video encoding",s));var l=new Rs(t,n,s.maxBitrate,s.maxFramerate);if(u&&"av1"===d){$.debug("using svc with scalabilityMode ".concat(u));var p=[];switch(u){case"L3T3":for(var f=0;f<3;f+=1)p.push({rid:Gs[2-f],scaleResolutionDownBy:Math.pow(2,f),maxBitrate:s.maxBitrate/Math.pow(3,f),maxFramerate:l.encoding.maxFramerate,scalabilityMode:"L3T3"});return $.debug("encodings",p),p;default:throw new Error("unsupported scalabilityMode: ".concat(u))}}if(!c)return[s];var h,v=[];if((v=e?null!==(i=Xs(null==r?void 0:r.screenShareSimulcastLayers))&&void 0!==i?i:Ks(e,l):null!==(a=Xs(null==r?void 0:r.videoSimulcastLayers))&&void 0!==a?a:Ks(e,l)).length>0){var m=v[0];if(v.length>1)h=o(v,2)[1];var g=Math.max(t,n);if(g>=960&&h)return Ys(t,n,[m,h,l]);if(g>=480)return Ys(t,n,[m,l])}return Ys(t,n,[l])}function zs(e,t,n){var r,i,a,o;if(n.backupCodec&&n.backupCodec.codec!==n.videoCodec){t!==n.backupCodec.codec&&$.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;var s=e.mediaStreamTrack.getSettings(),c=null!==(r=s.width)&&void 0!==r?r:null===(i=e.dimensions)||void 0===i?void 0:i.width,u=null!==(a=s.height)&&void 0!==a?a:null===(o=e.dimensions)||void 0===o?void 0:o.height;return Qs(e.source===ns.Source.ScreenShare,c,u,n)}}function Hs(e,t,n,r){for(var i=Zs(e,t,n),a=i[0].encoding,o=Math.max(t,n),s=0;s<i.length;s+=1){var c=i[s];if(a=c.encoding,c.width>=o)break}if(r)switch(r){case"av1":a.maxBitrate=.7*a.maxBitrate}return a}function Zs(e,t,n){if(e)return Fs;var r=t>n?t/n:n/t;return Math.abs(r-16/9)<Math.abs(r-4/3)?Js:$s}function Ks(e,t){if(e)return Ws(t);var n=t.width,r=t.height,i=n>r?n/r:r/n;return Math.abs(i-16/9)<Math.abs(i-4/3)?Vs:qs}function Ys(e,t,n){var r=[];return n.forEach(function(n,i){if(!(i>=Gs.length)){var a=Math.min(e,t),o=Gs[i];r.push({rid:o,scaleResolutionDownBy:a/Math.min(n.width,n.height),maxBitrate:n.encoding.maxBitrate,maxFramerate:n.encoding.maxFramerate})}}),r}function Xs(e){if(e)return e.sort(function(e,t){var n=e.encoding,r=t.encoding;return n.maxBitrate>r.maxBitrate?1:n.maxBitrate<r.maxBitrate?-1:n.maxBitrate===r.maxBitrate&&n.maxFramerate&&r.maxFramerate?n.maxFramerate>r.maxFramerate?1:-1:0})}var ec=function(e){p(n,Es);var t=f(n);function n(e,r,i,a){var o;return x(this,n),(o=t.call(this,e,r,i)).track=void 0,o.allowed=!0,o.disabled=!1,o.currentVideoQuality=Mt.HIGH,o.handleEnded=function(e){o.setTrack(void 0),o.emit(qa.Ended,e)},o.handleVisibilityChange=function(e){$.debug("adaptivestream video visibility ".concat(o.trackSid,", visible=").concat(e),{trackSid:o.trackSid}),o.disabled=!e,o.emitTrackUpdate()},o.handleVideoDimensionsChange=function(e){$.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),{trackSid:o.trackSid}),o.videoDimensions=e,o.emitTrackUpdate()},o.subscribed=a,o}return O(n,[{key:"setSubscribed",value:function(e){var t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);var r={trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[{participantSid:"",trackSids:[this.trackSid]}]};this.emit(qa.UpdateSubscription,r),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}},{key:"subscriptionStatus",get:function(){return!1===this.subscribed?Es.SubscriptionStatus.Unsubscribed:r(S(n.prototype),"isSubscribed",this)?Es.SubscriptionStatus.Subscribed:Es.SubscriptionStatus.Desired}},{key:"permissionStatus",get:function(){return this.allowed?Es.PermissionStatus.Allowed:Es.PermissionStatus.NotAllowed}},{key:"isSubscribed",get:function(){return!1!==this.subscribed&&r(S(n.prototype),"isSubscribed",this)}},{key:"isDesired",get:function(){return!1!==this.subscribed}},{key:"isEnabled",get:function(){return!this.disabled}},{key:"setEnabled",value:function(e){this.isManualOperationAllowed()&&this.disabled!==!e&&(this.disabled=!e,this.emitTrackUpdate())}},{key:"setVideoQuality",value:function(e){this.isManualOperationAllowed()&&this.currentVideoQuality!==e&&(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}},{key:"setVideoDimensions",value:function(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.videoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.videoDimensions)||void 0===n?void 0:n.height)===e.height||(this.track instanceof Cs&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}},{key:"setVideoFPS",value:function(e){this.isManualOperationAllowed()&&this.track instanceof Cs&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}},{key:"videoQuality",get:function(){return this.currentVideoQuality}},{key:"setTrack",value:function(e){var t=this.subscriptionStatus,i=this.permissionStatus,a=this.track;a!==e&&(a&&(a.off(qa.VideoDimensionsChanged,this.handleVideoDimensionsChange),a.off(qa.VisibilityChanged,this.handleVisibilityChange),a.off(qa.Ended,this.handleEnded),a.detach(),this.emit(qa.Unsubscribed,a)),r(S(n.prototype),"setTrack",this).call(this,e),e&&(e.sid=this.trackSid,e.on(qa.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(qa.VisibilityChanged,this.handleVisibilityChange),e.on(qa.Ended,this.handleEnded),this.emit(qa.Subscribed,e)),this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(t))}},{key:"setAllowed",value:function(e){var t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}},{key:"updateInfo",value:function(e){var t;r(S(n.prototype),"updateInfo",this).call(this,e),this.metadataMuted=e.muted,null===(t=this.track)||void 0===t||t.setMuted(e.muted)}},{key:"emitSubscriptionUpdateIfChanged",value:function(e){var t=this.subscriptionStatus;e!==t&&this.emit(qa.SubscriptionStatusChanged,t,e)}},{key:"emitPermissionUpdateIfChanged",value:function(e){this.permissionStatus!==e&&this.emit(qa.SubscriptionPermissionChanged,this.permissionStatus,e)}},{key:"isManualOperationAllowed",value:function(){return this.isAdaptiveStream?($.warn("adaptive stream is enabled, cannot change track settings",{trackSid:this.trackSid}),!1):!!this.isDesired||($.warn("cannot update track settings when not subscribed",{trackSid:this.trackSid}),!1)}},{key:"isAdaptiveStream",get:function(){return this.track instanceof Cs&&this.track.isAdaptiveStream}},{key:"emitTrackUpdate",value:function(){var e=zi.fromPartial({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=this.videoDimensions.width,e.height=this.videoDimensions.height):void 0!==this.currentVideoQuality?e.quality=this.currentVideoQuality:e.quality=Mt.HIGH,this.emit(qa.UpdateSettings,e)}}]),n}();exports.RemoteTrackPublication=ec;var tc=function(e){p(n,Ms);var t=f(n);function n(e,r,i,a,o){var s;return x(this,n),(s=t.call(this,r,i||"",a,o)).signalClient=e,s.tracks=new Map,s.audioTracks=new Map,s.videoTracks=new Map,s}return O(n,[{key:"addTrackPublication",value:function(e){var t=this;r(S(n.prototype),"addTrackPublication",this).call(this,e),e.on(qa.UpdateSettings,function(e){$.debug("send update settings",e),t.signalClient.sendUpdateTrackSettings(e)}),e.on(qa.UpdateSubscription,function(e){e.participantTracks.forEach(function(e){e.participantSid=t.sid}),t.signalClient.sendUpdateSubscription(e)}),e.on(qa.SubscriptionPermissionChanged,function(n){t.emit(Fa.TrackSubscriptionPermissionChanged,e,n)}),e.on(qa.SubscriptionStatusChanged,function(n){t.emit(Fa.TrackSubscriptionStatusChanged,e,n)}),e.on(qa.Subscribed,function(n){t.emit(Fa.TrackSubscribed,n,e)}),e.on(qa.Unsubscribed,function(n){t.emit(Fa.TrackUnsubscribed,n,e)})}},{key:"getTrack",value:function(e){var t=r(S(n.prototype),"getTrack",this).call(this,e);if(t)return t}},{key:"getTrackByName",value:function(e){var t=r(S(n.prototype),"getTrackByName",this).call(this,e);if(t)return t}},{key:"setVolume",value:function(e){this.volume=e;var t=this.getTrack(ns.Source.Microphone);t&&t.track&&t.track.setVolume(e)}},{key:"getVolume",value:function(){var e=this.getTrack(ns.Source.Microphone);return e&&e.track?e.track.getVolume():this.volume}},{key:"addSubscribedMediaTrack",value:function(e,t,n,r,i,a){var o,s=this,c=this.getTrackPublication(t);return c||t.startsWith("TR")||this.tracks.forEach(function(t){c||e.kind!==t.kind.toString()||(c=t)}),c?"ended"===e.readyState?($.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",{participant:this.sid,trackSid:t}),void this.emit(Fa.TrackSubscriptionFailed,t)):((o="video"===e.kind?new Cs(e,t,r,i):new ys(e,t,r,this.audioContext,this.audioOutput)).source=c.source,o.isMuted=c.isMuted,o.setMediaStream(n),o.start(),c.setTrack(o),void 0!==this.volume&&o instanceof ys&&o.source===ns.Source.Microphone&&o.setVolume(this.volume),c):0===a?($.error("could not find published track",{participant:this.sid,trackSid:t}),void this.emit(Fa.TrackSubscriptionFailed,t)):(void 0===a&&(a=20),void setTimeout(function(){s.addSubscribedMediaTrack(e,t,n,r,i,a-1)},150))}},{key:"hasMetadata",get:function(){return!!this.participantInfo}},{key:"getTrackPublication",value:function(e){return this.tracks.get(e)}},{key:"updateInfo",value:function(e){var t=this;r(S(n.prototype),"updateInfo",this).call(this,e);var i=new Map,a=new Map;e.tracks.forEach(function(n){var r,o=t.getTrackPublication(n.sid);if(o)o.updateInfo(n);else{var s=ns.kindFromProto(n.type);if(!s)return;(o=new ec(s,n.sid,n.name,null===(r=t.signalClient.connectOptions)||void 0===r?void 0:r.autoSubscribe)).updateInfo(n),a.set(n.sid,o);var c=Array.from(t.tracks.values()).find(function(e){return e.source===(null==o?void 0:o.source)});c&&o.source!==ns.Source.Unknown&&$.warn("received a second track publication for ".concat(t.identity," with the same source: ").concat(o.source),{oldTrack:c,newTrack:o,participant:t,participantInfo:e}),t.addTrackPublication(o)}i.set(n.sid,o)}),a.forEach(function(e){t.emit(Fa.TrackPublished,e)}),this.tracks.forEach(function(e){i.has(e.trackSid)||($.trace("detected removed track on remote participant, unpublishing",{publication:e,participantSid:t.sid}),t.unpublishTrack(e.trackSid,!0))})}},{key:"unpublishTrack",value:function(e,t){var n=this.tracks.get(e);if(n){switch(this.tracks.delete(e),n.kind){case ns.Kind.Audio:this.audioTracks.delete(e);break;case ns.Kind.Video:this.videoTracks.delete(e)}var r=n.track;r&&(r.stop(),n.setTrack(void 0)),t&&this.emit(Fa.TrackUnpublished,n)}}},{key:"setAudioContext",value:function(e){this.audioContext=e,this.audioTracks.forEach(function(t){return t.track instanceof ys&&t.track.setAudioContext(e)})}},{key:"setAudioOutput",value:function(){var e=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.audioOutput=t,n=[],this.audioTracks.forEach(function(e){var r;e.track instanceof ys&&n.push(e.track.setSinkId(null!==(r=t.deviceId)&&void 0!==r?r:"default"))}),e.next=5,Promise.all(n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"emit",value:function(e){for(var t,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return $.trace("participant event",{participant:this.sid,event:e,args:a}),(t=r(S(n.prototype),"emit",this)).call.apply(t,[this,e].concat(a))}}],[{key:"fromParticipantInfo",value:function(e,t){return new n(e,t.sid,t.identity,t.name,t.metadata)}}]),n}();exports.RemoteParticipant=tc;var nc=function(e){p(n,Ms);var t=f(n);function n(e,r,i,o){var s;return x(this,n),(s=t.call(this,e,r)).pendingPublishing=new Set,s.participantTrackPermissions=[],s.allParticipantsAllowedToSubscribe=!0,s.updateTrackSubscriptionPermissions=function(){$.debug("updating track subscription permissions",{allParticipantsAllowed:s.allParticipantsAllowedToSubscribe,participantTrackPermissions:s.participantTrackPermissions}),s.engine.client.sendUpdateSubscriptionPermissions(s.allParticipantsAllowedToSubscribe,s.participantTrackPermissions.map(function(e){return js(e)}))},s.onTrackUnmuted=function(e){s.onTrackMuted(e,e.isUpstreamPaused)},s.onTrackMuted=function(e,t){void 0===t&&(t=!0),e.sid?s.engine.updateMuteStatus(e.sid,t):$.error("could not update mute status for unpublished track",e)},s.onTrackUpstreamPaused=function(e){$.debug("upstream paused"),s.onTrackMuted(e,!0)},s.onTrackUpstreamResumed=function(e){$.debug("upstream resumed"),s.onTrackMuted(e,e.isMuted)},s.handleSubscribedQualityUpdate=function(){var e=l(a().mark(function e(t){var n,r,i,o,c,u,d,l,p,f;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=s.roomOptions)||void 0===n?void 0:n.dynacast){e.next=2;break}return e.abrupt("return");case 2:if(i=s.videoTracks.get(t.trackSid)){e.next=6;break}return $.warn("received subscribed quality update for unknown track",{method:"handleSubscribedQualityUpdate",sid:t.trackSid}),e.abrupt("return");case 6:if(!(t.subscribedCodecs.length>0)){e.next=45;break}if(i.videoTrack){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,i.videoTrack.setPublishingCodecs(t.subscribedCodecs);case 11:o=e.sent,c=!1,u=!1,e.prev=14,l=nr(o);case 16:return e.next=18,l.next();case 18:if(!(c=!(p=e.sent).done)){e.next=27;break}if(!Is(f=p.value)){e.next=24;break}return $.debug("publish ".concat(f," for ").concat(i.videoTrack.sid)),e.next=24,s.publishAdditionalCodecForTrack(i.videoTrack,f,i.options);case 24:c=!1,e.next=16;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(14),u=!0,d=e.t0;case 33:if(e.prev=33,e.prev=34,!c||null==l.return){e.next=38;break}return e.next=38,l.return();case 38:if(e.prev=38,!u){e.next=41;break}throw d;case 41:return e.finish(38);case 42:return e.finish(33);case 43:e.next=46;break;case 45:t.subscribedQualities.length>0&&(null===(r=i.videoTrack)||void 0===r||r.setPublishingLayers(t.subscribedQualities));case 46:case"end":return e.stop()}},e,null,[[14,29,33,43],[34,,38,42]])}));return function(t){return e.apply(this,arguments)}}(),s.handleLocalTrackUnpublished=function(e){var t=s.tracks.get(e.trackSid);t?s.unpublishTrack(t.track):$.warn("received unpublished event for unknown track",{method:"handleLocalTrackUnpublished",trackSid:e.trackSid})},s.handleTrackEnded=function(){var e=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.source!==ns.Source.ScreenShare&&t.source!==ns.Source.ScreenShareAudio){e.next=5;break}$.debug("unpublishing local track due to TrackEnded",{track:t.sid}),s.unpublishTrack(t),e.next=35;break;case 5:if(!t.isUserProvided){e.next=10;break}return e.next=8,t.pauseUpstream();case 8:e.next=35;break;case 10:if(!(t instanceof ps||t instanceof hs)){e.next=35;break}if(e.prev=11,!mo()){e.next=25;break}return e.prev=13,e.next=16,null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:t.source===ns.Source.Camera?"camera":"microphone"});case 16:if(!(n=e.sent)||"denied"!==n.state){e.next=21;break}throw $.warn("user has revoked access to ".concat(t.source)),n.onchange=function(){"denied"!==n.state&&(t.restartTrack(),n.onchange=null)},new Error("GetUserMedia Permission denied");case 21:e.next=25;break;case 23:e.prev=23,e.t0=e.catch(13);case 25:return $.debug("track ended, attempting to use a different device"),e.next=28,t.restartTrack();case 28:e.next=35;break;case 30:return e.prev=30,e.t1=e.catch(11),$.warn("could not restart track, pausing upstream instead"),e.next=35,t.pauseUpstream();case 35:case"end":return e.stop()}},e,null,[[11,30],[13,23]])}));return function(t){return e.apply(this,arguments)}}(),s.audioTracks=new Map,s.videoTracks=new Map,s.tracks=new Map,s.engine=i,s.roomOptions=o,s.setupEngine(i),s}return O(n,[{key:"lastCameraError",get:function(){return this.cameraError}},{key:"lastMicrophoneError",get:function(){return this.microphoneError}},{key:"getTrack",value:function(e){var t=r(S(n.prototype),"getTrack",this).call(this,e);if(t)return t}},{key:"getTrackByName",value:function(e){var t=r(S(n.prototype),"getTrackByName",this).call(this,e);if(t)return t}},{key:"setupEngine",value:function(e){var t=this;this.engine=e,this.engine.client.onRemoteMuteChanged=function(e,n){var r=t.tracks.get(e);r&&r.track&&(n?r.mute():r.unmute())},this.engine.client.onSubscribedQualityUpdate=this.handleSubscribedQualityUpdate,this.engine.client.onLocalTrackUnpublished=this.handleLocalTrackUnpublished,this.engine.on(Va.Connected,this.updateTrackSubscriptionPermissions).on(Va.Restarted,this.updateTrackSubscriptionPermissions).on(Va.Resumed,this.updateTrackSubscriptionPermissions)}},{key:"setCameraEnabled",value:function(e,t,n){return this.setTrackEnabled(ns.Source.Camera,e,t,n)}},{key:"setMicrophoneEnabled",value:function(e,t,n){return this.setTrackEnabled(ns.Source.Microphone,e,t,n)}},{key:"setScreenShareEnabled",value:function(e,t,n){return this.setTrackEnabled(ns.Source.ScreenShare,e,t,n)}},{key:"setPermissions",value:function(e){var t=this.permissions,i=r(S(n.prototype),"setPermissions",this).call(this,e);return i&&t&&this.emit(Fa.ParticipantPermissionsChanged,t),i}},{key:"setTrackEnabled",value:function(){var e=l(a().mark(function e(t,n,r,i){var s,c,u,d,l,p,f,h,v,m,g;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($.debug("setTrackEnabled",{source:t,enabled:n}),u=this.getTrack(t),!n){e.next=48;break}if(!u){e.next=8;break}return e.next=6,u.unmute();case 6:e.next=46;break;case 8:if(!this.pendingPublishing.has(t)){e.next=11;break}return $.info("skipping duplicate published source",{source:t}),e.abrupt("return");case 11:this.pendingPublishing.add(t),e.prev=12,e.t0=t,e.next=e.t0===ns.Source.Camera?16:e.t0===ns.Source.Microphone?20:e.t0===ns.Source.ScreenShare?24:28;break;case 16:return e.next=18,this.createTracks({video:null===(s=r)||void 0===s||s});case 18:return d=e.sent,e.abrupt("break",29);case 20:return e.next=22,this.createTracks({audio:null===(c=r)||void 0===c||c});case 22:return d=e.sent,e.abrupt("break",29);case 24:return e.next=26,this.createScreenTracks(ar({},r));case 26:return d=e.sent,e.abrupt("break",29);case 28:throw new _a(t);case 29:l=[],p=D(d);try{for(p.s();!(f=p.n()).done;)h=f.value,$.info("publishing track",{localTrack:h}),l.push(this.publishTrack(h,i))}catch(a){p.e(a)}finally{p.f()}return e.next=34,Promise.all(l);case 34:v=e.sent,m=o(v,1),u=m[0],e.next=43;break;case 39:throw e.prev=39,e.t1=e.catch(12),e.t1 instanceof Error&&!(e.t1 instanceof _a)&&this.emit(Fa.MediaDevicesError,e.t1),e.t1;case 43:return e.prev=43,this.pendingPublishing.delete(t),e.finish(43);case 46:e.next=57;break;case 48:if(!u||!u.track){e.next=57;break}if(t!==ns.Source.ScreenShare){e.next=55;break}u=this.unpublishTrack(u.track),(g=this.getTrack(ns.Source.ScreenShareAudio))&&g.track&&this.unpublishTrack(g.track),e.next=57;break;case 55:return e.next=57,u.mute();case 57:return e.abrupt("return",u);case 58:case"end":return e.stop()}},e,this,[[12,39,43,46]])}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"enableCameraAndMicrophone",value:function(){var e=l(a().mark(function e(){var t,n=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingPublishing.has(ns.Source.Camera)&&!this.pendingPublishing.has(ns.Source.Microphone)){e.next=2;break}return e.abrupt("return");case 2:return this.pendingPublishing.add(ns.Source.Camera),this.pendingPublishing.add(ns.Source.Microphone),e.prev=4,e.next=7,this.createTracks({audio:!0,video:!0});case 7:return t=e.sent,e.next=10,Promise.all(t.map(function(e){return n.publishTrack(e)}));case 10:return e.prev=10,this.pendingPublishing.delete(ns.Source.Camera),this.pendingPublishing.delete(ns.Source.Microphone),e.finish(10);case 14:case"end":return e.stop()}},e,this,[[4,,10,14]])}));return function(){return e.apply(this,arguments)}}()},{key:"createTracks",value:function(){var e=l(a().mark(function e(t){var n,r,i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=os(t,null===(n=this.roomOptions)||void 0===n?void 0:n.audioCaptureDefaults,null===(r=this.roomOptions)||void 0===r?void 0:r.videoCaptureDefaults),o=cs(i),e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(o);case 5:s=e.sent,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),e.t0 instanceof Error&&(o.audio&&(this.microphoneError=e.t0),o.video&&(this.cameraError=e.t0)),e.t0;case 12:return o.audio&&(this.microphoneError=void 0),o.video&&(this.cameraError=void 0),e.abrupt("return",s.getTracks().map(function(e){var n,r="audio"===e.kind;r?t.audio:t.video;var i=r?o.audio:o.video;"boolean"!=typeof i&&(n=i);var a=Bs(e,n);return a.kind===ns.Kind.Video?a.source=ns.Source.Camera:a.kind===ns.Kind.Audio&&(a.source=ns.Source.Microphone),a.mediaStream=s,a}));case 15:case"end":return e.stop()}},e,this,[[2,8]])}));return function(t){return e.apply(this,arguments)}}()},{key:"createScreenTracks",value:function(){var e=l(a().mark(function e(t){var n,r,i,o,s,c,u;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),void 0===t.resolution&&(t.resolution=Ls.h1080fps15.resolution),r=!0,t.resolution&&(r=ho()?{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}:{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate}),e.next=6,navigator.mediaDevices.getDisplayMedia({audio:null!==(n=t.audio)&&void 0!==n&&n,video:r});case 6:if(i=e.sent,0!==(o=i.getVideoTracks()).length){e.next=10;break}throw new _a("no video track found");case 10:return(s=new hs(o[0],void 0,!1)).source=ns.Source.ScreenShare,c=[s],i.getAudioTracks().length>0&&((u=new ps(i.getAudioTracks()[0],void 0,!1)).source=ns.Source.ScreenShareAudio,c.push(u)),e.abrupt("return",c);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"publishTrack",value:function(){var e=l(a().mark(function e(t,n){var r,i,o,s,c,u,d,l,p,f,h,v,m,g,b,k,y,S,w,C,T,P;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof MediaStreamTrack)){e.next=9;break}e.t0=t.kind,e.next="audio"===e.t0?4:"video"===e.t0?6:8;break;case 4:return t=new ps(t,void 0,!0),e.abrupt("break",9);case 6:return t=new hs(t,void 0,!0),e.abrupt("break",9);case 8:throw new _a("unsupported MediaStreamTrack kind ".concat(t.kind));case 9:if((f=(null==n?void 0:n.forceStereo)||"channelCount"in t.mediaStreamTrack.getSettings()&&2===t.mediaStreamTrack.getSettings().channelCount||2===t.mediaStreamTrack.getConstraints().channelCount)&&(n||(n={}),void 0===n.dtx&&$.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(r=n.dtx)&&void 0!==r||(n.dtx=!1)),h=ar(ar({},this.roomOptions.publishDefaults),n),this.tracks.forEach(function(e){e.track&&e.track===t&&(v=e)}),!v){e.next=15;break}return e.abrupt("return",v);case 15:if(h.source&&(t.source=h.source),!(m=Array.from(this.tracks.values()).find(function(e){return t instanceof as&&e.source===t.source}))||t.source===ns.Source.Unknown){e.next=25;break}throw e.prev=18,Error("publishing a second track with the same source: ".concat(t.source));case 22:e.prev=22,e.t1=e.catch(18),e.t1 instanceof Error&&$.warn(e.t1.message,{oldTrack:m,newTrack:t,trace:e.t1.stack});case 25:if(h.stopMicTrackOnMute&&t instanceof ps&&(t.stopOnMute=!0),t.source===ns.Source.ScreenShare&&fo()&&(h.simulcast=!1),"av1"!==h.videoCodec||so()||(h.videoCodec=void 0),t.on(qa.Muted,this.onTrackMuted),t.on(qa.Unmuted,this.onTrackUnmuted),t.on(qa.Ended,this.handleTrackEnded),t.on(qa.UpstreamPaused,this.onTrackUpstreamPaused),t.on(qa.UpstreamResumed,this.onTrackUpstreamResumed),g=Ni.fromPartial({cid:t.mediaStreamTrack.id,name:null==n?void 0:n.name,type:ns.kindToProto(t.kind),muted:t.isMuted,source:ns.sourceToProto(t.source),disableDtx:!(null===(i=h.dtx)||void 0===i||i),stereo:f,disableRed:!(null===(o=h.red)||void 0===o||o)}),t.kind===ns.Kind.Video?(y=t.mediaStreamTrack.getSettings(),S=null!==(s=y.width)&&void 0!==s?s:null===(c=t.dimensions)||void 0===c?void 0:c.width,w=null!==(u=y.height)&&void 0!==u?u:null===(d=t.dimensions)||void 0===d?void 0:d.height,g.width=null!=S?S:0,g.height=null!=w?w:0,t instanceof hs&&("av1"===(null==h?void 0:h.videoCodec)&&(h.scalabilityMode=null!==(l=h.scalabilityMode)&&void 0!==l?l:"L3T3"),h.videoCodec&&h.backupCodec&&h.videoCodec!==h.backupCodec.codec&&((C=ar({},h)).simulcast=!0,k=zs(t,h.backupCodec.codec,C),g.simulcastCodecs=[{codec:h.videoCodec,cid:t.mediaStreamTrack.id,enableSimulcastLayers:!0},{codec:h.backupCodec.codec,cid:"",enableSimulcastLayers:!0}])),b=Qs(t.source===ns.Source.ScreenShare,S,w,h),g.layers=bs(g.width,g.height,null!=k?k:b)):t.kind===ns.Kind.Audio&&h.audioBitrate&&(b=[{maxBitrate:h.audioBitrate}]),this.engine&&!this.engine.isClosed){e.next=37;break}throw new ja("cannot publish track when not connected");case 37:return e.next=39,this.engine.addTrack(g);case 39:if(T=e.sent,(P=new xs(t.kind,T,t)).options=h,t.sid=T.sid,this.engine.publisher){e.next=45;break}throw new ja("publisher is closed");case 45:return $.debug("publishing ".concat(t.kind," with encodings"),{encodings:b,trackInfo:T}),e.next=48,this.engine.createSender(t,h,b);case 48:return t.sender=e.sent,"av1"===t.codec&&b&&(null===(p=b[0])||void 0===p?void 0:p.maxBitrate)&&this.engine.publisher.setTrackCodecBitrate(g.cid,t.codec,b[0].maxBitrate/1e3),this.engine.negotiate(),t instanceof hs?t.startMonitor(this.engine.client):t instanceof ps&&t.startMonitor(),this.addTrackPublication(P),this.emit(Fa.LocalTrackPublished,P),e.abrupt("return",P);case 55:case"end":return e.stop()}},e,this,[[18,22]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"isLocal",get:function(){return!0}},{key:"publishAdditionalCodecForTrack",value:function(){var e=l(a().mark(function e(t,n,r){var i,o,s,c,u,d,l;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tracks.forEach(function(e){e.track&&e.track===t&&(o=e)}),o){e.next=3;break}throw new _a("track is not published");case 3:if(t instanceof hs){e.next=5;break}throw new _a("track is not a video track");case 5:if(s=ar(ar({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),r),c=zs(t,n,s)){e.next=10;break}return $.info("backup codec has been disabled, ignoring request to add additional codec for track"),e.abrupt("return");case 10:if(u=t.addSimulcastTrack(n,c),(d=Ni.fromPartial({cid:u.mediaStreamTrack.id,type:ns.kindToProto(t.kind),muted:t.isMuted,source:ns.sourceToProto(t.source),sid:t.sid,simulcastCodecs:[{codec:s.videoCodec,cid:u.mediaStreamTrack.id,enableSimulcastLayers:s.simulcast}]})).layers=bs(d.width,d.height,c),this.engine&&!this.engine.isClosed){e.next=15;break}throw new ja("cannot publish track when not connected");case 15:return e.next=17,this.engine.addTrack(d);case 17:return l=e.sent,e.next=20,this.engine.createSimulcastSender(t,u,s,c);case 20:this.engine.negotiate(),$.debug("published ".concat(n," for track ").concat(t.sid),{encodings:c,trackInfo:l});case 22:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"unpublishTrack",value:function(e,t){var n,r,i=this.getPublicationForTrack(e);if($.debug("unpublishing track",{track:e,method:"unpublishTrack"}),i&&i.track){if((e=i.track).off(qa.Muted,this.onTrackMuted),e.off(qa.Unmuted,this.onTrackUnmuted),e.off(qa.Ended,this.handleTrackEnded),e.off(qa.UpstreamPaused,this.onTrackUpstreamPaused),e.off(qa.UpstreamResumed,this.onTrackUpstreamResumed),void 0===t&&(t=null===(r=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===r||r),t&&e.stop(),this.engine.publisher&&"closed"!==this.engine.publisher.pc.connectionState&&e.sender)try{if(this.engine.removeTrack(e.sender),e instanceof hs){var a,s=D(e.simulcastCodecs);try{for(s.s();!(a=s.n()).done;){var c=o(a.value,2)[1];c.sender&&(this.engine.removeTrack(c.sender),c.sender=void 0)}}catch(u){s.e(u)}finally{s.f()}e.simulcastCodecs.clear()}}catch(ou){$.warn("failed to unpublish track",{error:ou,method:"unpublishTrack"})}finally{this.engine.negotiate()}switch(e.sender=void 0,this.tracks.delete(i.trackSid),i.kind){case ns.Kind.Audio:this.audioTracks.delete(i.trackSid);break;case ns.Kind.Video:this.videoTracks.delete(i.trackSid)}return this.emit(Fa.LocalTrackUnpublished,i),i.setTrack(void 0),i}$.warn("track was not unpublished because no publication was found",{track:e,method:"unpublishTrack"})}},{key:"unpublishTracks",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t.unpublishTrack(e);r&&n.push(r)}),n}},{key:"publishData",value:function(){var e=l(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],void 0!==r&&r.forEach(function(e){e instanceof tc?i.push(e.sid):i.push(e)}),o={kind:n,value:{$case:"user",user:{participantSid:this.sid,payload:t,destinationSids:i}}},e.next=5,this.engine.sendDataPacket(o,n);case 5:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"setTrackSubscriptionPermissions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isConnected&&this.updateTrackSubscriptionPermissions()}},{key:"updateInfo",value:function(e){var t=this;r(S(n.prototype),"updateInfo",this).call(this,e),e.tracks.forEach(function(e){var n,r,i=t.tracks.get(e.sid);if(i){var a=i.isMuted||null!==(r=null===(n=i.track)||void 0===n?void 0:n.isUpstreamPaused)&&void 0!==r&&r;a!==e.muted&&($.debug("updating server mute state after reconcile",{sid:e.sid,muted:a}),t.engine.client.sendMuteTrack(e.sid,a))}})}},{key:"getPublicationForTrack",value:function(e){var t;return this.tracks.forEach(function(n){var r=n.track;r&&(e instanceof MediaStreamTrack?(r instanceof ps||r instanceof hs)&&r.mediaStreamTrack===e&&(t=n):e===r&&(t=n))}),t}},{key:"publishedTracksInfo",value:function(){var e=[];return this.tracks.forEach(function(t){void 0!==t.track&&e.push({cid:t.track.mediaStreamID,track:t.trackInfo})}),e}},{key:"dataChannelsInfo",value:function(){var e=[],t=function(t,n){void 0!==(null==t?void 0:t.id)&&null!==t.id&&e.push({label:t.label,id:t.id,target:n})};return t(this.engine.dataChannelForKind(Ft.LOSSY),pi.PUBLISHER),t(this.engine.dataChannelForKind(Ft.RELIABLE),pi.PUBLISHER),t(this.engine.dataChannelForKind(Ft.LOSSY,!0),pi.SUBSCRIBER),t(this.engine.dataChannelForKind(Ft.RELIABLE,!0),pi.SUBSCRIBER),e}}]),n}();exports.LocalParticipant=nc;var rc=["syncState","trickle","offer","answer","simulate","leave"];function ic(e){var t=rc.includes(e.$case);return $.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}var ac=function(){function e(){x(this,e);var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isConnected=!1,this.isReconnecting=!1,this.useJSON=t,this.requestQueue=new No,this.queuedRequests=[]}return O(e,[{key:"join",value:function(){var e=l(a().mark(function e(t,n,r,i){var o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isConnected=!1,this.options=r,e.next=4,this.connect(t,n,r,i);case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"reconnect",value:function(){var e=l(a().mark(function e(t,n,r){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options){e.next=3;break}return $.warn("attempted to reconnect without signal options being set, ignoring"),e.abrupt("return");case 3:return this.isReconnecting=!0,this.clearPingInterval(),e.next=7,this.connect(t,n,ar(ar({},this.options),{},{reconnect:!0,sid:r}));case 7:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"connect",value:function(e,t,n,r){var i=this;this.connectOptions=n,e.startsWith("http")&&(e=e.replace("http","ws")),e=e.replace(/\/$/,""),e+="/rtc";var o=cc(t,Eo(),n);return new Promise(function(t,s){var c=function(){i.close(),s(new La("room connection has been cancelled"))};(null==r?void 0:r.aborted)&&c(),null==r||r.addEventListener("abort",c),$.debug("connecting to ".concat(e+o)),i.ws&&i.close(),i.ws=new WebSocket(e+o),i.ws.binaryType="arraybuffer",i.ws.onerror=function(){var t=l(a().mark(function t(n){var r,c;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i.isConnected){t.next=19;break}return t.prev=1,t.next=4,fetch("http".concat(e.substring(2),"/validate").concat(o));case 4:if((r=t.sent).ok){t.next=12;break}return t.next=8,r.text();case 8:c=t.sent,s(new La(c,0,r.status)),t.next=13;break;case 12:s(new La("Internal error",2,r.status));case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(1),s(new La("server was not reachable",1));case 18:return t.abrupt("return");case 19:i.handleWSError(n);case 20:case"end":return t.stop()}},t,null,[[1,15]])}));return function(e){return t.apply(this,arguments)}}(),i.ws.onopen=function(){n.reconnect&&(i.isConnected=!0,i.startPingInterval(),t())},i.ws.onmessage=function(){var e=l(a().mark(function e(n){var o,u,d;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof n.data){e.next=5;break}d=JSON.parse(n.data),u=Ei.fromJSON(d),e.next=11;break;case 5:if(!(n.data instanceof ArrayBuffer)){e.next=9;break}u=Ei.decode(new Uint8Array(n.data)),e.next=11;break;case 9:return $.error("could not decode websocket message: ".concat(L(n.data))),e.abrupt("return");case 11:if(i.isConnected){e.next=14;break}return"join"===(null===(o=u.message)||void 0===o?void 0:o.$case)?(i.isConnected=!0,null==r||r.removeEventListener("abort",c),i.pingTimeoutDuration=u.message.join.pingTimeout,i.pingIntervalDuration=u.message.join.pingInterval,i.pingTimeoutDuration&&i.pingTimeoutDuration>0&&($.debug("ping config",{timeout:i.pingTimeoutDuration,interval:i.pingIntervalDuration}),i.startPingInterval()),t(u.message.join)):s(new La("did not receive join response")),e.abrupt("return");case 14:if(!i.signalLatency){e.next=17;break}return e.next=17,to(i.signalLatency);case 17:i.handleSignalResponse(u);case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i.ws.onclose=function(e){i.isConnected&&($.debug("websocket connection closed: ".concat(e.reason)),i.isConnected=!1,i.onClose&&i.onClose(e.reason),i.ws=void 0)}})}},{key:"close",value:function(){this.isConnected=!1,this.ws&&(this.ws.onclose=null,this.ws.onmessage=null,this.ws.onopen=null,this.ws.close()),this.ws=void 0,this.clearPingInterval()}},{key:"sendOffer",value:function(e){$.debug("sending offer",e),this.sendRequest({$case:"offer",offer:sc(e)})}},{key:"sendAnswer",value:function(e){$.debug("sending answer"),this.sendRequest({$case:"answer",answer:sc(e)})}},{key:"sendIceCandidate",value:function(e,t){$.trace("sending ice candidate",e),this.sendRequest({$case:"trickle",trickle:{candidateInit:JSON.stringify(e),target:t}})}},{key:"sendMuteTrack",value:function(e,t){this.sendRequest({$case:"mute",mute:{sid:e,muted:t}})}},{key:"sendAddTrack",value:function(e){this.sendRequest({$case:"addTrack",addTrack:Ni.fromPartial(e)})}},{key:"sendUpdateTrackSettings",value:function(e){this.sendRequest({$case:"trackSetting",trackSetting:e})}},{key:"sendUpdateSubscription",value:function(e){this.sendRequest({$case:"subscription",subscription:e})}},{key:"sendSyncState",value:function(e){this.sendRequest({$case:"syncState",syncState:e})}},{key:"sendUpdateVideoLayers",value:function(e,t){this.sendRequest({$case:"updateLayers",updateLayers:{trackSid:e,layers:t}})}},{key:"sendUpdateSubscriptionPermissions",value:function(e,t){this.sendRequest({$case:"subscriptionPermission",subscriptionPermission:{allParticipants:e,trackPermissions:t}})}},{key:"sendSimulateScenario",value:function(e){this.sendRequest({$case:"simulate",simulate:e})}},{key:"sendPing",value:function(){this.sendRequest({$case:"ping",ping:Date.now()})}},{key:"sendLeave",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendRequest({$case:"leave",leave:{canReconnect:!1,reason:Jt.CLIENT_INITIATED}});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"sendRequest",value:function(){var e=l(a().mark(function e(t){var n,r,i=this,o=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],!(!n&&!ic(t))||!this.isReconnecting){e.next=5;break}return this.queuedRequests.push(l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.sendRequest(t,!0);case 2:case"end":return e.stop()}},e)}))),e.abrupt("return");case 5:if(n){e.next=8;break}return e.next=8,this.requestQueue.flush();case 8:if(!this.signalLatency){e.next=11;break}return e.next=11,to(this.signalLatency);case 11:if(this.ws&&!(this.ws.readyState<this.ws.OPEN)){e.next=14;break}return $.error("cannot send signal request before connected, type: ".concat(null==t?void 0:t.$case)),e.abrupt("return");case 14:r={message:t};try{this.useJSON?this.ws.send(JSON.stringify(Ti.toJSON(r))):this.ws.send(Ti.encode(r).finish())}catch(ou){$.error("error sending signal message",{error:ou})}case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSignalResponse",value:function(e){var t,n,r=e.message;if("answer"===r.$case){var i=oc(r.answer);this.onAnswer&&this.onAnswer(i)}else if("offer"===r.$case){var a=oc(r.offer);this.onOffer&&this.onOffer(a)}else if("trickle"===r.$case){var o=JSON.parse(r.trickle.candidateInit);this.onTrickle&&this.onTrickle(o,r.trickle.target)}else"update"===r.$case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=r.update.participants)&&void 0!==t?t:[]):"trackPublished"===r.$case?this.onLocalTrackPublished&&this.onLocalTrackPublished(r.trackPublished):"speakersChanged"===r.$case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=r.speakersChanged.speakers)&&void 0!==n?n:[]):"leave"===r.$case?this.onLeave&&this.onLeave(r.leave):"mute"===r.$case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(r.mute.sid,r.mute.muted):"roomUpdate"===r.$case?this.onRoomUpdate&&r.roomUpdate.room&&this.onRoomUpdate(r.roomUpdate.room):"connectionQuality"===r.$case?this.onConnectionQuality&&this.onConnectionQuality(r.connectionQuality):"streamStateUpdate"===r.$case?this.onStreamStateUpdate&&this.onStreamStateUpdate(r.streamStateUpdate):"subscribedQualityUpdate"===r.$case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(r.subscribedQualityUpdate):"subscriptionPermissionUpdate"===r.$case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(r.subscriptionPermissionUpdate):"refreshToken"===r.$case?this.onTokenRefresh&&this.onTokenRefresh(r.refreshToken):"trackUnpublished"===r.$case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(r.trackUnpublished):"pong"===r.$case?this.resetPingTimeout():$.debug("unsupported message",r)}},{key:"setReconnected",value:function(){for(;this.queuedRequests.length>0;){var e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}this.isReconnecting=!1}},{key:"handleWSError",value:function(e){$.error("websocket error",e)}},{key:"resetPingTimeout",value:function(){var e=this;this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=setTimeout(function(){$.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*e.pingTimeoutDuration).toUTCString())),e.onClose&&e.onClose("ping timeout")},1e3*this.pingTimeoutDuration):$.warn("ping timeout duration not set")}},{key:"clearPingTimeout",value:function(){this.pingTimeout&&clearTimeout(this.pingTimeout)}},{key:"startPingInterval",value:function(){var e=this;this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?($.debug("start ping interval"),this.pingInterval=setInterval(function(){e.sendPing()},1e3*this.pingIntervalDuration)):$.warn("ping interval duration not set")}},{key:"clearPingInterval",value:function(){$.debug("clearing ping interval"),this.clearPingTimeout(),this.pingInterval&&clearInterval(this.pingInterval)}}]),e}();function oc(e){var t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function sc(e){return{sdp:e.sdp,type:e.type}}function cc(e,t,n){var r,i=new URLSearchParams;return i.set("access_token",e),n.reconnect&&(i.set("reconnect","1"),n.sid&&i.set("sid",n.sid)),i.set("auto_subscribe",n.autoSubscribe?"1":"0"),i.set("sdk","js"),i.set("version",t.version),i.set("protocol",t.protocol.toString()),t.deviceModel&&i.set("device_model",t.deviceModel),t.os&&i.set("os",t.os),t.osVersion&&i.set("os_version",t.osVersion),t.browser&&i.set("browser",t.browser),t.browserVersion&&i.set("browser_version",t.browserVersion),void 0!==n.publishOnly&&i.set("publish",n.publishOnly),n.adaptiveStream&&i.set("adaptive_stream","1"),(null===(r=navigator.connection)||void 0===r?void 0:r.type)&&i.set("network",navigator.connection.type),"?".concat(i.toString())}var uc={audioBitrate:Os.music.maxBitrate,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Ls.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:"vp8",backupCodec:{codec:"vp8",encoding:Ds.h540.encoding}},dc={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},lc={resolution:Ds.h720.resolution},pc={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new tr,expWebAudioMix:!1},fc={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3},hc={},vc={exports:{}},mc=vc.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(mc).forEach(function(e){mc[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})}),function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,r){var i=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:i&&!n[e.name]&&(n[e.name]={});var a=e.push?{}:i?n[e.name]:n;!function(e,n,r,i){if(i&&!r)n[i]=t(e[1]);else for(var a=0;a<r.length;a+=1)null!=e[a+1]&&(n[r[a]]=t(e[a+1]))}(r.match(e.reg),a,e.names,e.name),e.push&&n[e.push].push(a)},r=vc.exports,i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},a=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach(function(e){var t=e[0],i=e.slice(2);"m"===t&&(a.push({rtp:[],fmtp:[]}),o=a[a.length-1]);for(var s=0;s<(r[t]||[]).length;s+=1){var c=r[t][s];if(c.reg.test(i))return n(c,o,i)}}),t.media=a,t};var a=function(e,n){var r=n.split(/=(.+)/,2);return 2===r.length?e[r[0]]=t(r[1]):1===r.length&&n.length>1&&(e[r[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],r=e.split(" ").map(t),i=0;i<r.length;i+=3)n.push({component:r[i],ip:r[i+1],port:r[i+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})})},e.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var n,r=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),r=!0),{scid:n,paused:r}})})}}(hc);var gc=vc.exports,bc=/%[sdv%]/g,kc=function(e){var t=1,n=arguments,r=n.length;return e.replace(bc,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})},yc=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var a=t.names[i];t.name?r.push(n[t.name][a]):r.push(n[t.names[i]])}else r.push(n[t.name]);return kc.apply(null,r)},Sc=["v","o","s","i","u","e","p","c","b","t","r","z","a"],wc=["i","c","b","a"],Cc=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||Sc,r=t.innerOrder||wc,i=[];return n.forEach(function(t){gc[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(yc(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(yc(t,n,e))})})}),e.media.forEach(function(e){i.push(yc("m",gc.m[0],e)),r.forEach(function(t){gc[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(yc(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(yc(t,n,e))})})})}),i.join("\r\n")+"\r\n"},Tc=hc,Pc=Cc,Ec=Pc,xc=Tc.parse;Tc.parseParams,Tc.parseFmtpConfig,Tc.parsePayloads,Tc.parseRemoteCandidates,Tc.parseImageAttributes,Tc.parseSimulcastStreamList;var Rc=function(){function e(t){var n=this;x(this,e),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.negotiate=Ss(function(e){try{n.createAndSendOffer()}catch(ou){if(!e)throw ou;e(ou)}},100),this.pc=new RTCPeerConnection(t)}return O(e,[{key:"isICEConnected",get:function(){return"connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState}},{key:"addIceCandidate",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pc.remoteDescription||this.restartingIce){e.next=2;break}return e.abrupt("return",this.pc.addIceCandidate(t));case 2:this.pendingCandidates.push(t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"setRemoteDescription",value:function(){var e=l(a().mark(function e(t){var n=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"offer"===t.type&&(this.remoteStereoMids=Nc(t)),e.next=3,this.pc.setRemoteDescription(t);case 3:this.pendingCandidates.forEach(function(e){n.pc.addIceCandidate(e)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate&&(this.renegotiate=!1,this.createAndSendOffer());case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createAndSendOffer",value:function(){var e=l(a().mark(function e(t){var n,r,i,o,s=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.onOffer){e.next=2;break}return e.abrupt("return");case 2:if((null==t?void 0:t.iceRestart)&&($.debug("restarting ICE"),this.restartingIce=!0),"have-local-offer"!==this.pc.signalingState){e.next=14;break}if(r=this.pc.remoteDescription,!((null==t?void 0:t.iceRestart)&&r)){e.next=10;break}return e.next=8,this.pc.setRemoteDescription(r);case 8:e.next=12;break;case 10:return this.renegotiate=!0,e.abrupt("return");case 12:e.next=17;break;case 14:if("closed"!==this.pc.signalingState){e.next=17;break}return $.warn("could not createOffer with closed peer connection"),e.abrupt("return");case 17:return $.debug("starting to negotiate"),e.next=20,this.pc.createOffer(t);case 20:return i=e.sent,(o=xc(null!==(n=i.sdp)&&void 0!==n?n:"")).media.forEach(function(e){"audio"===e.type?Oc(e,[]):"video"===e.type&&s.trackBitrates.some(function(t){if(!e.msid||!e.msid.includes(t.sid))return!1;var n=0;return e.rtp.some(function(e){return e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0)}),n>0&&(e.fmtp.some(function(e){return e.payload===n&&(e.config.includes("x-google-max-bitrate")||(e.config+=";x-google-max-bitrate=".concat(t.maxbr)),!0)})||e.fmtp.push({payload:n,config:"x-google-max-bitrate=".concat(t.maxbr)})),!0})}),this.trackBitrates=[],e.next=26,this.setMungedLocalDescription(i,Ec(o));case 26:this.onOffer(i);case 27:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createAndSetAnswer",value:function(){var e=l(a().mark(function e(){var t,n,r,i=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pc.createAnswer();case 2:return n=e.sent,(r=xc(null!==(t=n.sdp)&&void 0!==t?t:"")).media.forEach(function(e){"audio"===e.type&&Oc(e,i.remoteStereoMids)}),e.next=7,this.setMungedLocalDescription(n,Ec(r));case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setTrackCodecBitrate",value:function(e,t,n){this.trackBitrates.push({sid:e,codec:t,maxbr:n})}},{key:"close",value:function(){this.pc.close()}},{key:"setMungedLocalDescription",value:function(){var e=l(a().mark(function e(t,n){var r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.sdp,t.sdp=n,e.prev=2,$.debug("setting munged local description"),e.next=6,this.pc.setLocalDescription(t);case 6:return e.abrupt("return");case 9:e.prev=9,e.t0=e.catch(2),$.warn("not able to set ".concat(t.type,", falling back to unmodified sdp"),{error:e.t0}),t.sdp=r;case 13:return e.prev=13,e.next=16,this.pc.setLocalDescription(t);case 16:e.next=23;break;case 18:throw e.prev=18,e.t1=e.catch(13),i="unknown error",e.t1 instanceof Error?i=e.t1.message:"string"==typeof e.t1&&(i=e.t1),new Ba(i);case 23:case"end":return e.stop()}},e,this,[[2,9],[13,18]])}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function Oc(e,t){var n=0;e.rtp.some(function(e){return"opus"===e.codec&&(n=e.payload,!0)}),n>0&&(e.rtcpFb||(e.rtcpFb=[]),e.rtcpFb.some(function(e){return e.payload===n&&"nack"===e.type})||e.rtcpFb.push({payload:n,type:"nack"}),t.includes(e.mid)&&e.fmtp.some(function(e){return e.payload===n&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0)}))}function Nc(e){var t,n=[],r=xc(null!==(t=e.sdp)&&void 0!==t?t:""),i=0;return r.media.forEach(function(e){"audio"===e.type&&(e.rtp.some(function(e){return"opus"===e.codec&&(i=e.payload,!0)}),e.fmtp.some(function(t){return t.payload===i&&(t.config.includes("sprop-stereo=1")&&n.push(e.mid),!0)}))}),n}var Ic,Dc="_lossy",Ac="_reliable",Uc=2e3,Lc="leave-reconnect";!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(Ic||(Ic={}));var _c=function(e){p(n,Uo.exports.EventEmitter);var t=f(n);function n(e){var r,i;return x(this,n),r=t.call(this),i=v(r),r.options=e,r.rtcConfig={},r.peerConnectionTimeout=fc.peerConnectionTimeout,r.subscriberPrimary=!1,r.pcState=Ic.New,r._isClosed=!0,r.pendingTrackResolvers={},r.hasPublished=!1,r.reconnectAttempts=0,r.reconnectStart=0,r.fullReconnectOnNext=!1,r.attemptingReconnect=!1,r.joinAttempts=0,r.maxJoinAttempts=1,r.handleDataChannel=function(){var e=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.channel){e.next=3;break}return e.abrupt("return");case 3:if(n.label!==Ac){e.next=7;break}r.reliableDCSub=n,e.next=12;break;case 7:if(n.label!==Dc){e.next=11;break}r.lossyDCSub=n,e.next=12;break;case 11:return e.abrupt("return");case 12:$.debug("on data channel ".concat(n.id,", ").concat(n.label)),n.onmessage=r.handleDataMessage;case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.handleDataMessage=function(){var e=l(a().mark(function e(t){var n,i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.data instanceof ArrayBuffer)){e.next=4;break}o=t.data,e.next=12;break;case 4:if(!(t.data instanceof Blob)){e.next=10;break}return e.next=7,t.data.arrayBuffer();case 7:o=e.sent,e.next=12;break;case 10:return $.error("unsupported data type",t.data),e.abrupt("return");case 12:s=On.decode(new Uint8Array(o)),"speaker"===(null===(n=s.value)||void 0===n?void 0:n.$case)?r.emit(Va.ActiveSpeakersUpdate,s.value.speaker.speakers):"user"===(null===(i=s.value)||void 0===i?void 0:i.$case)&&r.emit(Va.DataPacketReceived,s.value.user,s.kind);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.handleDataError=function(e){var t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent){var n=e.error.error;$.error("DataChannel error on ".concat(t,": ").concat(e.message),n)}else $.error("Unknown DataChannel Error on ".concat(t),e)},r.handleDisconnect=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!i._isClosed){$.debug("".concat(e," disconnected")),0===i.reconnectAttempts&&(i.reconnectStart=Date.now());var n=Date.now()-i.reconnectStart,r=i.getNextRetryDelay({elapsedMs:n,retryCount:i.reconnectAttempts});null!==r?(e===Lc&&(r=0),$.debug("reconnecting in ".concat(r,"ms")),i.reconnectTimeout&&clearTimeout(i.reconnectTimeout),i.reconnectTimeout=setTimeout(function(){return i.attemptReconnect(t)},r)):function(e){$.info("could not recover connection after ".concat(i.reconnectAttempts," attempts, ").concat(e,"ms. giving up")),i.emit(Va.Disconnected),i.close()}(n)}},r.handleBrowserOnLine=function(){r.client.isReconnecting&&(r.reconnectTimeout&&clearTimeout(r.reconnectTimeout),r.attemptReconnect(!0))},r.client=new ac,r.client.signalLatency=r.options.expSignalLatency,r.reconnectPolicy=r.options.reconnectPolicy,r.registerOnLineListener(),r}return O(n,[{key:"isClosed",get:function(){return this._isClosed}},{key:"join",value:function(){var e=l(a().mark(function e(t,n,r,i){var o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.url=t,this.token=n,this.signalOpts=r,e.prev=3,this.joinAttempts+=1,e.next=7,this.client.join(t,n,r,i);case 7:return o=e.sent,this._isClosed=!1,this.subscriberPrimary=o.subscriberPrimary,this.publisher||this.configure(o),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=o.clientConfiguration,e.abrupt("return",o);case 16:if(e.prev=16,e.t0=e.catch(3),!(e.t0 instanceof La)){e.next=23;break}if(1!==e.t0.reason){e.next=23;break}if($.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts)),!(this.joinAttempts<this.maxJoinAttempts)){e.next=23;break}return e.abrupt("return",this.join(t,n,r,i));case 23:throw e.t0;case 24:case"end":return e.stop()}},e,this,[[3,16]])}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=this;this._isClosed=!0,this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),this.publisher&&"closed"!==this.publisher.pc.signalingState&&(this.publisher.pc.getSenders().forEach(function(t){var n,r;try{(null===(n=e.publisher)||void 0===n?void 0:n.pc.removeTrack)&&(null===(r=e.publisher)||void 0===r||r.pc.removeTrack(t))}catch(ou){$.warn("could not removeTrack",{error:ou})}}),this.publisher.close(),this.publisher=void 0),this.subscriber&&(this.subscriber.close(),this.subscriber=void 0),this.client.close()}},{key:"addTrack",value:function(e){var t=this;if(this.pendingTrackResolvers[e.cid])throw new _a("a track with the same ID has already been published");return new Promise(function(n,r){var i=setTimeout(function(){delete t.pendingTrackResolvers[e.cid],r(new La("publication of local track timed out, no response from server"))},1e4);t.pendingTrackResolvers[e.cid]={resolve:function(e){clearTimeout(i),n(e)},reject:function(){clearTimeout(i),r(new Error("Cancelled publication by calling unpublish"))}},t.client.sendAddTrack(e)})}},{key:"removeTrack",value:function(e){var t;if(e.track&&this.pendingTrackResolvers[e.track.id]){var n=this.pendingTrackResolvers[e.track.id].reject;n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{null===(t=this.publisher)||void 0===t||t.pc.removeTrack(e)}catch(ou){$.warn("failed to remove track",{error:ou,method:"removeTrack"})}}},{key:"updateMuteStatus",value:function(e,t){this.client.sendMuteTrack(e,t)}},{key:"dataSubscriberReadyState",get:function(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}},{key:"connectedServerAddress",get:function(){return this.connectedServerAddr}},{key:"configure",value:function(e){var t,n=this;if(!this.publisher&&!this.subscriber){this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;var r=ar({},this.rtcConfig);if(e.iceServers&&!r.iceServers){var i=[];e.iceServers.forEach(function(e){var t={urls:e.urls};e.username&&(t.username=e.username),e.credential&&(t.credential=e.credential),i.push(t)}),r.iceServers=i}e.clientConfiguration&&e.clientConfiguration.forceRelay===Bt.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",this.publisher=new Rc(r),this.subscriber=new Rc(r),this.emit(Va.TransportsCreated,this.publisher,this.subscriber),this.publisher.pc.onicecandidate=function(e){e.candidate&&($.trace("adding ICE candidate for peer",e.candidate),n.client.sendIceCandidate(e.candidate,pi.PUBLISHER))},this.subscriber.pc.onicecandidate=function(e){e.candidate&&n.client.sendIceCandidate(e.candidate,pi.SUBSCRIBER)},this.publisher.onOffer=function(e){n.client.sendOffer(e)};var o=this.publisher.pc,s=this.subscriber.pc;e.subscriberPrimary&&(o=this.subscriber.pc,s=this.publisher.pc,this.subscriber.pc.ondatachannel=this.handleDataChannel),this.primaryPC=o,o.onconnectionstatechange=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if($.debug("primary PC state changed ".concat(o.connectionState)),"connected"!==o.connectionState){e.next=16;break}return e.prev=2,e.next=5,Mc(o);case 5:n.connectedServerAddr=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),$.warn("could not get connected server address",{error:e.t0});case 11:t=n.pcState===Ic.New,n.pcState=Ic.Connected,t&&n.emit(Va.Connected),e.next=17;break;case 16:"failed"===o.connectionState&&n.pcState===Ic.Connected&&(n.pcState=Ic.Disconnected,n.handleDisconnect("primary peerconnection"));case 17:case"end":return e.stop()}},e,null,[[2,8]])})),s.onconnectionstatechange=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$.debug("secondary PC state changed ".concat(s.connectionState)),"failed"===s.connectionState&&n.handleDisconnect("secondary peerconnection");case 2:case"end":return e.stop()}},e)})),this.subscriber.pc.ontrack=function(e){n.emit(Va.MediaTrackAdded,e.track,e.streams[0],e.receiver)},this.createDataChannels(),this.client.onAnswer=function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.publisher){e.next=2;break}return e.abrupt("return");case 2:return $.debug("received server answer",{RTCSdpType:t.type,signalingState:n.publisher.pc.signalingState}),e.next=5,n.publisher.setRemoteDescription(t);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.client.onTrickle=function(e,t){n.publisher&&n.subscriber&&($.trace("got ICE candidate from peer",{candidate:e,target:t}),t===pi.PUBLISHER?n.publisher.addIceCandidate(e):n.subscriber.addIceCandidate(e))},this.client.onOffer=function(){var e=l(a().mark(function e(t){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.subscriber){e.next=2;break}return e.abrupt("return");case 2:return $.debug("received server offer",{RTCSdpType:t.type,signalingState:n.subscriber.pc.signalingState}),e.next=5,n.subscriber.setRemoteDescription(t);case 5:return e.next=7,n.subscriber.createAndSetAnswer();case 7:r=e.sent,n.client.sendAnswer(r);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),this.client.onLocalTrackPublished=function(e){$.debug("received trackPublishedResponse",e);var t=n.pendingTrackResolvers[e.cid].resolve;t?(delete n.pendingTrackResolvers[e.cid],t(e.track)):$.error("missing track resolver for ".concat(e.cid))},this.client.onTokenRefresh=function(e){n.token=e},this.client.onClose=function(){n.handleDisconnect("signal")},this.client.onLeave=function(e){(null==e?void 0:e.canReconnect)?(n.fullReconnectOnNext=!0,n.primaryPC=void 0,n.handleDisconnect(Lc)):(n.emit(Va.Disconnected,null==e?void 0:e.reason),n.close()),$.trace("leave request",{leave:e})}}}},{key:"createDataChannels",value:function(){this.publisher&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.publisher.pc.createDataChannel(Dc,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.publisher.pc.createDataChannel(Ac,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError)}},{key:"setPreferredCodec",value:function(e,t,n){if("getCapabilities"in RTCRtpSender){var r=RTCRtpSender.getCapabilities(t);if(r){$.debug("get capabilities",r);var i=[],a=[],o=[];r.codecs.forEach(function(e){var t=e.mimeType.toLowerCase();"audio/opus"!==t?t==="video/".concat(n)?"h264"!==n?i.push(e):e.sdpFmtpLine&&e.sdpFmtpLine.includes("profile-level-id=42e01f")?i.push(e):a.push(e):o.push(e):i.push(e)}),lo(e)&&e.setCodecPreferences(i.concat(a,o))}}}},{key:"createSender",value:function(){var e=l(a().mark(function e(t,n,r){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!ro()){e.next=2;break}return e.abrupt("return",this.createTransceiverRTCRtpSender(t,n,r));case 2:if(!io()){e.next=5;break}return $.debug("using add-track fallback"),e.abrupt("return",this.createRTCRtpSender(t.mediaStreamTrack));case 5:throw new ja("Required webRTC APIs not supported on this device");case 6:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createSimulcastSender",value:function(){var e=l(a().mark(function e(t,n,r,i){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!ro()){e.next=2;break}return e.abrupt("return",this.createSimulcastTransceiverSender(t,n,r,i));case 2:if(!io()){e.next=5;break}return $.debug("using add-track fallback"),e.abrupt("return",this.createRTCRtpSender(t.mediaStreamTrack));case 5:throw new ja("Cannot stream on this device");case 6:case"end":return e.stop()}},e,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"createTransceiverRTCRtpSender",value:function(){var e=l(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.publisher){e.next=2;break}throw new ja("publisher is closed");case 2:return i={direction:"sendonly"},r&&(i.sendEncodings=r),e.next=6,this.publisher.pc.addTransceiver(t.mediaStreamTrack,i);case 6:return o=e.sent,t.kind===ns.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(o,t.kind,n.videoCodec),t.codec=n.videoCodec),e.abrupt("return",o.sender);case 9:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"createSimulcastTransceiverSender",value:function(){var e=l(a().mark(function e(t,n,r,i){var o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.publisher){e.next=2;break}throw new ja("publisher is closed");case 2:return o={direction:"sendonly"},i&&(o.sendEncodings=i),e.next=6,this.publisher.pc.addTransceiver(n.mediaStreamTrack,o);case 6:if(s=e.sent,r.videoCodec){e.next=9;break}return e.abrupt("return");case 9:return this.setPreferredCodec(s,t.kind,r.videoCodec),t.setSimulcastTrackSender(r.videoCodec,s.sender),e.abrupt("return",s.sender);case 12:case"end":return e.stop()}},e,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"createRTCRtpSender",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.publisher){e.next=2;break}throw new ja("publisher is closed");case 2:return e.abrupt("return",this.publisher.pc.addTrack(t));case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"attemptReconnect",value:function(){var e=l(a().mark(function e(){var t,n,r,i,o,s,c,u=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]&&u[0],!this._isClosed){e.next=3;break}return e.abrupt("return");case 3:if(!this.attemptingReconnect){e.next=5;break}return e.abrupt("return");case 5:if((null===(n=this.clientConfiguration)||void 0===n?void 0:n.resumeConnection)!==Bt.DISABLED&&"closed"!==(null!==(i=null===(r=this.primaryPC)||void 0===r?void 0:r.signalingState)&&void 0!==i?i:"closed")||(this.fullReconnectOnNext=!0),e.prev=6,this.attemptingReconnect=!0,!this.fullReconnectOnNext){e.next=13;break}return e.next=11,this.restartConnection(t);case 11:e.next=15;break;case 13:return e.next=15,this.resumeConnection(t);case 15:this.reconnectAttempts=0,this.fullReconnectOnNext=!1,this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),e.next=29;break;case 20:e.prev=20,e.t0=e.catch(6),this.reconnectAttempts+=1,o=!1,s=!0,c=!1,e.t0 instanceof ja?($.debug("received unrecoverable error",{error:e.t0}),s=!1):e.t0 instanceof Jc||(o=!0),o&&!this.fullReconnectOnNext&&(this.fullReconnectOnNext=!0,c=!0),s?this.handleDisconnect("reconnect",c):($.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up")),this.emit(Va.Disconnected),this.close());case 29:return e.prev=29,this.attemptingReconnect=!1,e.finish(29);case 32:case"end":return e.stop()}},e,this,[[6,20,29,32]])}));return function(){return e.apply(this,arguments)}}()},{key:"getNextRetryDelay",value:function(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(ou){$.warn("encountered error in reconnect policy",{error:ou})}return null}},{key:"restartConnection",value:function(){var e=l(a().mark(function e(){var t,n,r,i,o=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]&&o[0],this.url&&this.token){e.next=3;break}throw new ja("could not reconnect, url or token not saved");case 3:if($.info("reconnecting, attempt: ".concat(this.reconnectAttempts)),(t||0===this.reconnectAttempts)&&this.emit(Va.Restarting),this.client.isConnected&&this.client.sendLeave(),this.client.close(),this.primaryPC=void 0,null===(n=this.publisher)||void 0===n||n.close(),this.publisher=void 0,null===(r=this.subscriber)||void 0===r||r.close(),this.subscriber=void 0,e.prev=12,this.signalOpts){e.next=16;break}throw $.warn("attempted connection restart, without signal options present"),new Jc;case 16:return e.next=18,this.join(this.url,this.token,this.signalOpts);case 18:i=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t0=e.catch(12),new Jc;case 24:return e.next=26,this.waitForPCConnected();case 26:this.client.setReconnected(),this.emit(Va.Restarted,i);case 28:case"end":return e.stop()}},e,this,[[12,21]])}));return function(){return e.apply(this,arguments)}}()},{key:"resumeConnection",value:function(){var e=l(a().mark(function e(){var t,n,r,i=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]&&i[0],this.url&&this.token){e.next=3;break}throw new ja("could not reconnect, url or token not saved");case 3:if(this.publisher&&this.subscriber){e.next=5;break}throw new ja("publisher and subscriber connections unset");case 5:return $.info("resuming signal connection, attempt ".concat(this.reconnectAttempts)),(t||0===this.reconnectAttempts)&&this.emit(Va.Resuming),e.prev=7,e.next=10,this.client.reconnect(this.url,this.token,this.participantSid);case 10:e.next=17;break;case 12:throw e.prev=12,e.t0=e.catch(7),r="",e.t0 instanceof Error&&(r=e.t0.message),new Jc(r);case 17:if(this.emit(Va.SignalResumed),this.subscriber.restartingIce=!0,!this.hasPublished){e.next=22;break}return e.next=22,this.publisher.createAndSendOffer({iceRestart:!0});case 22:return e.next=24,this.waitForPCConnected();case 24:this.client.setReconnected(),"open"===(null===(n=this.reliableDC)||void 0===n?void 0:n.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),this.emit(Va.Resumed);case 27:case"end":return e.stop()}},e,this,[[7,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"waitForPCConnected",value:function(){var e=l(a().mark(function e(){var t,n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Date.now(),r=n,this.pcState=Ic.Reconnecting,$.debug("waiting for peer connection to reconnect");case 4:if(!(r-n<this.peerConnectionTimeout)){e.next=27;break}if(void 0!==this.primaryPC){e.next=9;break}return e.abrupt("break",27);case 9:if(!(r-n>Uc&&"connected"===(null===(t=this.primaryPC)||void 0===t?void 0:t.connectionState))){e.next=20;break}return this.pcState=Ic.Connected,e.prev=11,e.next=14,Mc(this.primaryPC);case 14:this.connectedServerAddr=e.sent,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(11),$.warn("could not get connected server address",{error:e.t0});case 20:if(this.pcState!==Ic.Connected){e.next=22;break}return e.abrupt("return");case 22:return e.next=24,to(100);case 24:r=Date.now(),e.next=4;break;case 27:throw new La("could not establish PC connection");case 28:case"end":return e.stop()}},e,this,[[11,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"sendDataPacket",value:function(){var e=l(a().mark(function e(t,n){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=On.encode(t).finish(),e.next=3,this.ensurePublisherConnected(n);case 3:n===Ft.LOSSY&&this.lossyDC?this.lossyDC.send(r):n===Ft.RELIABLE&&this.reliableDC&&this.reliableDC.send(r);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"ensurePublisherConnected",value:function(){var e=l(a().mark(function e(t){var n,r,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.subscriberPrimary){e.next=2;break}return e.abrupt("return");case 2:if(this.publisher){e.next=4;break}throw new La("publisher connection not set");case 4:if(this.publisher.isICEConnected||"checking"===this.publisher.pc.iceConnectionState||this.negotiate(),"open"!==(null==(i=this.dataChannelForKind(t))?void 0:i.readyState)){e.next=8;break}return e.abrupt("return");case 8:o=(new Date).getTime()+this.peerConnectionTimeout;case 9:if(!((new Date).getTime()<o)){e.next=16;break}if(!this.publisher.isICEConnected||"open"!==(null===(n=this.dataChannelForKind(t))||void 0===n?void 0:n.readyState)){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,to(50);case 14:e.next=9;break;case 16:throw new La("could not establish publisher connection, state ".concat(null===(r=this.publisher)||void 0===r?void 0:r.pc.iceConnectionState));case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"negotiate",value:function(){var e=this;this.publisher&&(this.hasPublished=!0,this.publisher.negotiate(function(t){t instanceof Ba&&(e.fullReconnectOnNext=!0),e.handleDisconnect("negotiation")}))}},{key:"dataChannelForKind",value:function(e,t){if(t){if(e===Ft.LOSSY)return this.lossyDCSub;if(e===Ft.RELIABLE)return this.reliableDCSub}else{if(e===Ft.LOSSY)return this.lossyDC;if(e===Ft.RELIABLE)return this.reliableDC}}},{key:"clearPendingReconnect",value:function(){this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.reconnectAttempts=0}},{key:"registerOnLineListener",value:function(){mo()&&window.addEventListener("online",this.handleBrowserOnLine)}},{key:"deregisterOnLineListener",value:function(){mo()&&window.removeEventListener("online",this.handleBrowserOnLine)}}]),n}();function Mc(e){return jc.apply(this,arguments)}function jc(){return(jc=l(a().mark(function e(t){var n,r,i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="",i=new Map,o=new Map,e.next=5,t.getStats();case 5:if(e.sent.forEach(function(e){switch(e.type){case"transport":r=e.selectedCandidatePairId;break;case"candidate-pair":""===r&&e.selected&&(r=e.id),i.set(e.id,e);break;case"remote-candidate":o.set(e.id,"".concat(e.address,":").concat(e.port))}}),""!==r){e.next=9;break}return e.abrupt("return",void 0);case 9:if(void 0!==(s=null===(n=i.get(r))||void 0===n?void 0:n.remoteCandidateId)){e.next=12;break}return e.abrupt("return",void 0);case 12:return e.abrupt("return",o.get(s));case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Bc,Jc=function(e){p(n,m(Error));var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n)}();exports.ConnectionState=Bc,function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting"}(Bc||(exports.ConnectionState=Bc={}));var $c=Bc;exports.RoomState=$c;var Fc,Vc=function(e){p(n,Uo.exports.EventEmitter);var t=f(n);function n(e){var r,i;return x(this,n),r=t.call(this),i=v(r),r.state=Bc.Disconnected,r.activeSpeakers=[],r.sid="",r.name="",r.metadata=void 0,r._isRecording=!1,r.audioEnabled=!0,r.connect=function(e,t,n){if(r.state===Bc.Connected)return $.info("already connected to room ".concat(r.name)),Promise.resolve();if(r.connectFuture)return r.connectFuture.promise;r.setAndEmitConnectionState(Bc.Connecting);var i=function(){var i=l(a().mark(function i(s,c){var u,d,l,p,f,h,v;return a().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r.abortController&&!r.abortController.signal.aborted||(r.abortController=new AbortController),r.state===Bc.Reconnecting?($.info("Reconnection attempt replaced by new connection attempt"),r.recreateEngine()):r.maybeCreateEngine(),r.acquireAudioContext(),r.connOptions=ar(ar({},fc),n),r.connOptions.rtcConfig&&(r.engine.rtcConfig=r.connOptions.rtcConfig),r.connOptions.peerConnectionTimeout&&(r.engine.peerConnectionTimeout=r.connOptions.peerConnectionTimeout),i.prev=6,i.next=9,r.engine.join(e,t,{autoSubscribe:r.connOptions.autoSubscribe,publishOnly:r.connOptions.publishOnly,adaptiveStream:"object"===L(r.options.adaptiveStream)||r.options.adaptiveStream,maxRetries:r.connOptions.maxRetries},r.abortController.signal);case 9:if(l=i.sent,(p=l.serverInfo)||(p={version:l.serverVersion,region:l.serverRegion}),$.debug("connected to Livekit Server ".concat(Object.entries(p).map(function(e){var t=o(e,2),n=t[0],r=t[1];return"".concat(n,": ").concat(r)}).join(", "))),l.serverVersion){i.next=15;break}throw new Ma("unknown server version");case 15:"0.15.1"===l.serverVersion&&r.options.dynacast&&($.debug("disabling dynacast due to server version"),r.options.dynacast=!1),f=l.participant,r.localParticipant.sid=f.sid,r.localParticipant.identity=f.identity,r.localParticipant.updateInfo(f),r.localParticipant.on(Fa.ParticipantMetadataChanged,r.onLocalParticipantMetadataChanged).on(Fa.TrackMuted,r.onLocalTrackMuted).on(Fa.TrackUnmuted,r.onLocalTrackUnmuted).on(Fa.LocalTrackPublished,r.onLocalTrackPublished).on(Fa.LocalTrackUnpublished,r.onLocalTrackUnpublished).on(Fa.ConnectionQualityChanged,r.onLocalConnectionQualityChanged).on(Fa.MediaDevicesError,r.onMediaDevicesError).on(Fa.ParticipantPermissionsChanged,r.onLocalParticipantPermissionsChanged),l.otherParticipants.forEach(function(e){e.sid!==r.localParticipant.sid&&e.identity!==r.localParticipant.identity?r.getOrCreateParticipant(e.sid,e):$.warn("received info to create local participant as remote participant",{info:e,localParticipant:r.localParticipant})}),r.name=l.room.name,r.sid=l.room.sid,r.metadata=l.room.metadata,r._isRecording!==l.room.activeRecording&&(r._isRecording=l.room.activeRecording,r.emit($a.RecordingStatusChanged,l.room.activeRecording)),r.emit($a.SignalConnected),i.next=35;break;case 29:return i.prev=29,i.t0=i.catch(6),r.recreateEngine(),r.handleDisconnect(r.options.stopLocalTrackOnUnpublish),c(new La("could not establish signal connection")),i.abrupt("return");case 35:h=setTimeout(function(){r.recreateEngine(),r.handleDisconnect(r.options.stopLocalTrackOnUnpublish),c(new La("could not connect PeerConnection after timeout"))},r.connOptions.peerConnectionTimeout),v=function(){$.warn("closing engine"),clearTimeout(h),r.recreateEngine(),r.handleDisconnect(r.options.stopLocalTrackOnUnpublish),c(new La("room connection has been cancelled"))},(null===(u=r.abortController)||void 0===u?void 0:u.signal.aborted)&&v(),null===(d=r.abortController)||void 0===d||d.signal.addEventListener("abort",v),r.engine.once(Va.Connected,function(){var e,t;clearTimeout(h),null===(e=r.abortController)||void 0===e||e.signal.removeEventListener("abort",v),mo()&&(window.addEventListener("beforeunload",r.onBeforeUnload),null===(t=navigator.mediaDevices)||void 0===t||t.addEventListener("devicechange",r.handleDeviceChange)),r.setAndEmitConnectionState(Bc.Connected),r.emit($a.Connected),s()});case 40:case"end":return i.stop()}},i,null,[[6,29]])}));return function(e,t){return i.apply(this,arguments)}}();return r.connectFuture=new Oo(i,function(){r.clearConnectionFutures()}),r.connectFuture.promise},r.disconnect=l(a().mark(function e(){var t,n,r,o,s,c=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(c.length>0&&void 0!==c[0])||c[0],$.info("disconnect from room",{identity:i.localParticipant.identity}),i.state!==Bc.Connecting&&i.state!==Bc.Reconnecting||($.warn("abort connection attempt"),null===(n=i.abortController)||void 0===n||n.abort(),null===(o=null===(r=i.connectFuture)||void 0===r?void 0:r.reject)||void 0===o||o.call(r,new La("Client initiated disconnect")),i.connectFuture=void 0),!(null===(s=i.engine)||void 0===s?void 0:s.client.isConnected)){e.next=6;break}return e.next=6,i.engine.client.sendLeave();case 6:i.engine&&i.engine.close(),i.handleDisconnect(t,Jt.CLIENT_INITIATED),i.engine=void 0;case 9:case"end":return e.stop()}},e)})),r.onBeforeUnload=function(){r.disconnect()},r.handleRestarting=function(){var e,t=D(r.participants.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;r.handleParticipantDisconnected(n.sid,n)}}catch(i){t.e(i)}finally{t.f()}r.setAndEmitConnectionState(Bc.Reconnecting)&&r.emit($a.Reconnecting)},r.handleRestarted=function(){var e=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return $.debug("reconnected to server",{region:t.serverRegion}),r.setAndEmitConnectionState(Bc.Connected),r.emit($a.Reconnected),t.participant&&(r.localParticipant.sid=t.participant.sid,r.handleParticipantUpdates([t.participant])),r.handleParticipantUpdates(t.otherParticipants),n=[],r.localParticipant.tracks.forEach(function(e){e.track&&n.push(e)}),e.next=9,Promise.all(n.map(function(){var e=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r.localParticipant.unpublishTrack(n,!1),n.isMuted){e.next=9;break}if(!(n instanceof ps||n instanceof hs)||n.isUserProvided){e.next=7;break}return $.debug("restarting existing track",{track:t.trackSid}),e.next=7,n.restartTrack();case 7:return e.next=9,r.localParticipant.publishTrack(n,t.options);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.handleParticipantUpdates=function(e){e.forEach(function(e){if(e.sid!==r.localParticipant.sid&&e.identity!==r.localParticipant.identity){var t=r.identityToSid.get(e.identity);t&&t!==e.sid&&r.handleParticipantDisconnected(t,r.participants.get(t));var n=r.participants.get(e.sid),i=!n;n=r.getOrCreateParticipant(e.sid,e),e.state===$t.DISCONNECTED?r.handleParticipantDisconnected(e.sid,n):i||n.updateInfo(e)}else r.localParticipant.updateInfo(e)})},r.handleActiveSpeakersUpdate=function(e){var t=[],n={};e.forEach(function(e){if(n[e.sid]=!0,e.sid===r.localParticipant.sid)r.localParticipant.audioLevel=e.level,r.localParticipant.setIsSpeaking(!0),t.push(r.localParticipant);else{var i=r.participants.get(e.sid);i&&(i.audioLevel=e.level,i.setIsSpeaking(!0),t.push(i))}}),n[r.localParticipant.sid]||(r.localParticipant.audioLevel=0,r.localParticipant.setIsSpeaking(!1)),r.participants.forEach(function(e){n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))}),r.activeSpeakers=t,r.emitWhenConnected($a.ActiveSpeakersChanged,t)},r.handleSpeakersChanged=function(e){var t=new Map;r.activeSpeakers.forEach(function(e){t.set(e.sid,e)}),e.forEach(function(e){var n=r.participants.get(e.sid);e.sid===r.localParticipant.sid&&(n=r.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))});var n=Array.from(t.values());n.sort(function(e,t){return t.audioLevel-e.audioLevel}),r.activeSpeakers=n,r.emitWhenConnected($a.ActiveSpeakersChanged,n)},r.handleStreamStateUpdate=function(e){e.streamStates.forEach(function(e){var t=r.participants.get(e.participantSid);if(t){var n=t.getTrackPublication(e.trackSid);n&&n.track&&(n.track.streamState=ns.streamStateFromProto(e.state),t.emit(Fa.TrackStreamStateChanged,n,n.track.streamState),r.emitWhenConnected($a.TrackStreamStateChanged,n,n.track.streamState,t))}})},r.handleSubscriptionPermissionUpdate=function(e){var t=r.participants.get(e.participantSid);if(t){var n=t.getTrackPublication(e.trackSid);n&&n.setAllowed(e.allowed)}},r.handleDataPacket=function(e,t){var n=r.participants.get(e.participantSid);r.emit($a.DataReceived,e.payload,n,t),null==n||n.emit(Fa.DataReceived,e.payload,t)},r.handleAudioPlaybackStarted=function(){r.canPlaybackAudio||(r.audioEnabled=!0,r.emit($a.AudioPlaybackStatusChanged,!0))},r.handleAudioPlaybackFailed=function(e){$.warn("could not playback audio",e),r.canPlaybackAudio&&(r.audioEnabled=!1,r.emit($a.AudioPlaybackStatusChanged,!1))},r.handleDeviceChange=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.emit($a.MediaDevicesChanged);case 1:case"end":return e.stop()}},e)})),r.handleRoomUpdate=function(e){r._isRecording!==e.activeRecording&&(r._isRecording=e.activeRecording,r.emit($a.RecordingStatusChanged,e.activeRecording)),r.metadata!==e.metadata&&(r.metadata=e.metadata,r.emitWhenConnected($a.RoomMetadataChanged,e.metadata))},r.handleConnectionQualityUpdate=function(e){e.updates.forEach(function(e){if(e.participantSid!==r.localParticipant.sid){var t=r.participants.get(e.participantSid);t&&t.setConnectionQuality(e.quality)}else r.localParticipant.setConnectionQuality(e.quality)})},r.onLocalParticipantMetadataChanged=function(e){r.emit($a.ParticipantMetadataChanged,e,r.localParticipant)},r.onLocalTrackMuted=function(e){r.emit($a.TrackMuted,e,r.localParticipant)},r.onLocalTrackUnmuted=function(e){r.emit($a.TrackUnmuted,e,r.localParticipant)},r.onLocalTrackPublished=function(e){r.emit($a.LocalTrackPublished,e,r.localParticipant)},r.onLocalTrackUnpublished=function(e){r.emit($a.LocalTrackUnpublished,e,r.localParticipant)},r.onLocalConnectionQualityChanged=function(e){r.emit($a.ConnectionQualityChanged,e,r.localParticipant)},r.onMediaDevicesError=function(e){r.emit($a.MediaDevicesError,e)},r.onLocalParticipantPermissionsChanged=function(e){r.emit($a.ParticipantPermissionsChanged,e,r.localParticipant)},r.setMaxListeners(100),r.participants=new Map,r.identityToSid=new Map,r.options=ar(ar({},pc),e),r.options.audioCaptureDefaults=ar(ar({},dc),null==e?void 0:e.audioCaptureDefaults),r.options.videoCaptureDefaults=ar(ar({},lc),null==e?void 0:e.videoCaptureDefaults),r.options.publishDefaults=ar(ar({},uc),null==e?void 0:e.publishDefaults),r.maybeCreateEngine(),r.localParticipant=new nc("","",r.engine,r.options),r}return O(n,[{key:"maybeCreateEngine",value:function(){var e=this;this.engine||(this.engine=new _c(this.options),this.engine.client.onParticipantUpdate=this.handleParticipantUpdates,this.engine.client.onRoomUpdate=this.handleRoomUpdate,this.engine.client.onSpeakersChanged=this.handleSpeakersChanged,this.engine.client.onStreamStateUpdate=this.handleStreamStateUpdate,this.engine.client.onSubscriptionPermissionUpdate=this.handleSubscriptionPermissionUpdate,this.engine.client.onConnectionQuality=this.handleConnectionQualityUpdate,this.engine.on(Va.MediaTrackAdded,function(t,n,r){e.onTrackAdded(t,n,r)}).on(Va.Disconnected,function(t){e.handleDisconnect(e.options.stopLocalTrackOnUnpublish,t)}).on(Va.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Va.DataPacketReceived,this.handleDataPacket).on(Va.Resuming,function(){e.setAndEmitConnectionState(Bc.Reconnecting)&&e.emit($a.Reconnecting)}).on(Va.Resumed,function(){e.setAndEmitConnectionState(Bc.Connected),e.emit($a.Reconnected),e.updateSubscriptions()}).on(Va.SignalResumed,function(){e.state===Bc.Reconnecting&&e.sendSyncState()}).on(Va.Restarting,this.handleRestarting).on(Va.Restarted,this.handleRestarted),this.localParticipant&&this.localParticipant.setupEngine(this.engine))}},{key:"prepareConnection",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http".concat(t.substring(2)),{method:"HEAD"});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getParticipantByIdentity",value:function(e){if(this.localParticipant.identity===e)return this.localParticipant;var t=this.identityToSid.get(e);return t?this.participants.get(t):void 0}},{key:"clearConnectionFutures",value:function(){this.connectFuture=void 0}},{key:"isRecording",get:function(){return this._isRecording}},{key:"simulateScenario",value:function(e){var t,n=this,r=function(){};switch(e){case"signal-reconnect":this.engine.client.close(),this.engine.client.onClose&&this.engine.client.onClose("simulate disconnect");break;case"speaker":t=Na.fromPartial({scenario:{$case:"speakerUpdate",speakerUpdate:3}});break;case"node-failure":t=Na.fromPartial({scenario:{$case:"nodeFailure",nodeFailure:!0}});break;case"server-leave":t=Na.fromPartial({scenario:{$case:"serverLeave",serverLeave:!0}});break;case"migration":t=Na.fromPartial({scenario:{$case:"migration",migration:!0}});break;case"force-tcp":case"force-tls":t=Na.fromPartial({scenario:{$case:"switchCandidateProtocol",switchCandidateProtocol:"force-tls"===e?2:1}}),r=function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t=n.engine.client.onLeave)&&t({reason:Jt.CLIENT_INITIATED,canReconnect:!0});case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}t&&(this.engine.client.sendSimulateScenario(t),r())}},{key:"startAudio",value:function(){var e=l(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.acquireAudioContext(),t=[],this.participants.forEach(function(e){e.audioTracks.forEach(function(e){e.track&&e.track.attachedElements.forEach(function(e){t.push(e)})})}),e.prev=3,e.next=6,Promise.all(t.map(function(e){return e.play()}));case 6:this.handleAudioPlaybackStarted(),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(3),this.handleAudioPlaybackFailed(e.t0),e.t0;case 13:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"canPlaybackAudio",get:function(){return this.audioEnabled}},{key:"switchActiveDevice",value:function(){var e=l(a().mark(function e(t,n){var r,i,o,s,c,u,d,l;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("audioinput"!==t){e.next=15;break}return o=this.options.audioCaptureDefaults.deviceId,this.options.audioCaptureDefaults.deviceId=n,s=Array.from(this.localParticipant.audioTracks.values()).filter(function(e){return e.source===ns.Source.Microphone}),e.prev=4,e.next=7,Promise.all(s.map(function(e){var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(n)}));case 7:e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(4),this.options.audioCaptureDefaults.deviceId=o,e.t0;case 13:e.next=47;break;case 15:if("videoinput"!==t){e.next=30;break}return c=this.options.videoCaptureDefaults.deviceId,this.options.videoCaptureDefaults.deviceId=n,u=Array.from(this.localParticipant.videoTracks.values()).filter(function(e){return e.source===ns.Source.Camera}),e.prev=19,e.next=22,Promise.all(u.map(function(e){var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(n)}));case 22:e.next=28;break;case 24:throw e.prev=24,e.t1=e.catch(19),this.options.videoCaptureDefaults.deviceId=c,e.t1;case 28:e.next=47;break;case 30:if("audiooutput"!==t){e.next=47;break}if(co()){e.next=33;break}throw new Error("cannot switch audio output, setSinkId not supported");case 33:return null!==(r=(i=this.options).audioOutput)&&void 0!==r||(i.audioOutput={}),d=this.options.audioOutput.deviceId,this.options.audioOutput.deviceId=n,l=[],this.participants.forEach(function(e){l.push(e.setAudioOutput({deviceId:n}))}),e.prev=38,e.next=41,Promise.all(l);case 41:e.next=47;break;case 43:throw e.prev=43,e.t2=e.catch(38),this.options.audioOutput.deviceId=d,e.t2;case 47:case"end":return e.stop()}},e,this,[[4,9],[19,24],[38,43]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"recreateEngine",value:function(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.participants.clear(),this.maybeCreateEngine()}},{key:"onTrackAdded",value:function(e,t,n){var r=this;if(this.state===Bc.Connecting||this.state===Bc.Reconnecting){var i=function(){r.onTrackAdded(e,t,n),a()},a=function e(){r.off($a.Reconnected,i),r.off($a.Connected,i),r.off($a.Disconnected,e)};return this.once($a.Reconnected,i),this.once($a.Connected,i),void this.once($a.Disconnected,a)}if(this.state!==Bc.Disconnected){var o=eo(t.id),s=o[0],c=o[1];if(c&&""!==c||(c=e.id),s!==this.localParticipant.sid){var u,d=this.getOrCreateParticipant(s);this.options.adaptiveStream&&(u="object"===L(this.options.adaptiveStream)?this.options.adaptiveStream:{}),d.addSubscribedMediaTrack(e,c,t,n,u)}else $.warn("tried to create RemoteParticipant for local participant")}else $.warn("skipping incoming track after Room disconnected")}},{key:"handleDisconnect",value:function(){var e,t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1?arguments[1]:void 0;this.state!==Bc.Disconnected&&(this.participants.forEach(function(e){e.tracks.forEach(function(t){e.unpublishTrack(t.trackSid)})}),this.localParticipant.tracks.forEach(function(e){var r,i;e.track&&t.localParticipant.unpublishTrack(e.track,n),n&&(null===(r=e.track)||void 0===r||r.detach(),null===(i=e.track)||void 0===i||i.stop())}),this.localParticipant.off(Fa.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Fa.TrackMuted,this.onLocalTrackMuted).off(Fa.TrackUnmuted,this.onLocalTrackUnmuted).off(Fa.LocalTrackPublished,this.onLocalTrackPublished).off(Fa.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Fa.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Fa.MediaDevicesError,this.onMediaDevicesError).off(Fa.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&(this.audioContext.close(),this.audioContext=void 0),mo()&&(window.removeEventListener("beforeunload",this.onBeforeUnload),null===(e=navigator.mediaDevices)||void 0===e||e.removeEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(Bc.Disconnected),this.emit($a.Disconnected,r))}},{key:"handleParticipantDisconnected",value:function(e,t){this.participants.delete(e),t&&(this.identityToSid.delete(t.identity),t.tracks.forEach(function(e){t.unpublishTrack(e.trackSid,!0)}),this.emitWhenConnected($a.ParticipantDisconnected,t))}},{key:"acquireAudioContext",value:function(){var e=this;this.audioContext&&this.audioContext.close();var t=ls();t&&(this.audioContext=t,this.options.expWebAudioMix&&this.participants.forEach(function(t){return t.setAudioContext(e.audioContext)}))}},{key:"createParticipant",value:function(e,t){var n;return n=t?tc.fromParticipantInfo(this.engine.client,t):new tc(this.engine.client,e,"",void 0,void 0),this.options.expWebAudioMix&&n.setAudioContext(this.audioContext),n}},{key:"getOrCreateParticipant",value:function(e,t){var n=this;if(this.participants.has(e))return this.participants.get(e);var r=this.createParticipant(e,t);return this.participants.set(e,r),t&&(this.identityToSid.set(t.identity,t.sid),this.emitWhenConnected($a.ParticipantConnected,r)),r.on(Fa.TrackPublished,function(e){n.emitWhenConnected($a.TrackPublished,e,r)}).on(Fa.TrackSubscribed,function(e,t){e.kind===ns.Kind.Audio&&(e.on(qa.AudioPlaybackStarted,n.handleAudioPlaybackStarted),e.on(qa.AudioPlaybackFailed,n.handleAudioPlaybackFailed)),n.emit($a.TrackSubscribed,e,t,r)}).on(Fa.TrackUnpublished,function(e){n.emitWhenConnected($a.TrackUnpublished,e,r)}).on(Fa.TrackUnsubscribed,function(e,t){n.emit($a.TrackUnsubscribed,e,t,r)}).on(Fa.TrackSubscriptionFailed,function(e){n.emit($a.TrackSubscriptionFailed,e,r)}).on(Fa.TrackMuted,function(e){n.emitWhenConnected($a.TrackMuted,e,r)}).on(Fa.TrackUnmuted,function(e){n.emitWhenConnected($a.TrackUnmuted,e,r)}).on(Fa.ParticipantMetadataChanged,function(e){n.emitWhenConnected($a.ParticipantMetadataChanged,e,r)}).on(Fa.ConnectionQualityChanged,function(e){n.emitWhenConnected($a.ConnectionQualityChanged,e,r)}).on(Fa.ParticipantPermissionsChanged,function(e){n.emitWhenConnected($a.ParticipantPermissionsChanged,e,r)}).on(Fa.TrackSubscriptionStatusChanged,function(e,t){n.emitWhenConnected($a.TrackSubscriptionStatusChanged,e,t,r)}).on(Fa.TrackSubscriptionPermissionChanged,function(e,t){n.emitWhenConnected($a.TrackSubscriptionPermissionChanged,e,t,r)}),t&&r.updateInfo(t),r}},{key:"sendSyncState",value:function(){var e,t;if(void 0!==this.engine.subscriber&&null!==this.engine.subscriber.pc.localDescription){var n=this.engine.subscriber.pc.localDescription,r=this.engine.subscriber.pc.remoteDescription,i=null===(t=null===(e=this.connOptions)||void 0===e?void 0:e.autoSubscribe)||void 0===t||t,a=new Array;this.participants.forEach(function(e){e.tracks.forEach(function(e){e.isDesired!==i&&a.push(e.trackSid)})}),this.engine.client.sendSyncState({answer:sc({sdp:n.sdp,type:n.type}),offer:r?sc({sdp:r.sdp,type:r.type}):void 0,subscription:{trackSids:a,subscribe:!i,participantTracks:[]},publishTracks:this.localParticipant.publishedTracksInfo(),dataChannels:this.localParticipant.dataChannelsInfo()})}}},{key:"updateSubscriptions",value:function(){var e,t=D(this.participants.values());try{for(t.s();!(e=t.n()).done;){var n,r=D(e.value.videoTracks.values());try{for(r.s();!(n=r.n()).done;){var i=n.value;i.isSubscribed&&i instanceof ec&&i.emitTrackUpdate()}}catch(a){r.e(a)}finally{r.f()}}}catch(a){t.e(a)}finally{t.f()}}},{key:"setAndEmitConnectionState",value:function(e){return e!==this.state&&(this.state=e,this.emit($a.ConnectionStateChanged,this.state),!0)}},{key:"emitWhenConnected",value:function(e){if(this.state===Bc.Connected){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.emit.apply(this,[e].concat(n))}return!1}},{key:"emit",value:function(e){for(var t,i=arguments.length,a=new Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];return e!==$a.ActiveSpeakersChanged&&$.debug("room event ".concat(e),{event:e,args:a}),(t=r(S(n.prototype),"emit",this)).call.apply(t,[this,e].concat(a))}}],[{key:"getLocalDevices",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Do.getInstance().getDevices(e,t)}}]),n}();function qc(e){return Wc.apply(this,arguments)}function Wc(){return(Wc=l(a().mark(function e(t){var n,r,i,o,s,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null!=t||(t={}),null!==(n=t.audio)&&void 0!==n||(t.audio=!0),null!==(r=t.video)&&void 0!==r||(t.video=!0),i=os(t,dc,lc),o=cs(i),s=navigator.mediaDevices.getUserMedia(o),t.audio&&(Do.userMediaPromiseMap.set("audioinput",s),s.catch(function(){return Do.userMediaPromiseMap.delete("audioinput")})),t.video&&(Do.userMediaPromiseMap.set("videoinput",s),s.catch(function(){return Do.userMediaPromiseMap.delete("videoinput")})),e.next=10,s;case 10:return c=e.sent,e.abrupt("return",c.getTracks().map(function(e){var n,r="audio"===e.kind;r?t.audio:t.video;var i=r?o.audio:o.video;"boolean"!=typeof i&&(n=i);var a=Bs(e,n);return a.kind===ns.Kind.Video?a.source=ns.Source.Camera:a.kind===ns.Kind.Audio&&(a.source=ns.Source.Microphone),a.mediaStream=c,a}));case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Gc(e){return Qc.apply(this,arguments)}function Qc(){return(Qc=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qc({audio:!1,video:t});case 2:return n=e.sent,e.abrupt("return",n[0]);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zc(e){return Hc.apply(this,arguments)}function Hc(){return(Hc=l(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qc({audio:t,video:!1});case 2:return n=e.sent,e.abrupt("return",n[0]);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Zc(e){return Kc.apply(this,arguments)}function Kc(){return(Kc=l(a().mark(function e(t){var n,r,i,o,s,c,u;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={}),void 0===t.resolution&&(t.resolution=Ds.h1080.resolution),r=!0,t.resolution&&(r={width:t.resolution.width,height:t.resolution.height}),e.next=6,navigator.mediaDevices.getDisplayMedia({audio:null!==(n=t.audio)&&void 0!==n&&n,video:r});case 6:if(i=e.sent,0!==(o=i.getVideoTracks()).length){e.next=10;break}throw new _a("no video track found");case 10:return(s=new hs(o[0],void 0,!1)).source=ns.Source.ScreenShare,c=[s],i.getAudioTracks().length>0&&((u=new ps(i.getAudioTracks()[0],void 0,!1)).source=ns.Source.ScreenShareAudio,c.push(u)),e.abrupt("return",c);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}exports.Room=Vc,function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(Fc||(Fc={}));var Yc=function(e){p(n,Uo.exports.EventEmitter);var t=f(n);function n(e,r){var i;x(this,n);var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(i=t.call(this)).status=Fc.IDLE,i.logs=[],i.errorsAsWarnings=!1,i.url=e,i.token=r,i.name=i.constructor.name,i.room=new Vc(a.roomOptions),i.connectOptions=a.connectOptions,a.errorsAsWarnings&&(i.errorsAsWarnings=a.errorsAsWarnings),i}return O(n,[{key:"run",value:function(){var e=l(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===Fc.IDLE){e.next=2;break}throw Error("check is running already");case 2:return this.setStatus(Fc.RUNNING),this.appendMessage("".concat(this.name," started.")),e.prev=4,e.next=7,this.perform();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),e.t0 instanceof Error&&(this.errorsAsWarnings?this.appendWarning(e.t0.message):this.appendError(e.t0.message));case 12:return e.next=14,this.disconnect();case 14:return e.next=16,new Promise(function(e){return setTimeout(e,500)});case 16:return this.status!==Fc.SKIPPED&&this.setStatus(this.isSuccess()?Fc.SUCCESS:Fc.FAILED),t&&t(),e.abrupt("return",this.getInfo());case 19:case"end":return e.stop()}},e,this,[[4,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"isSuccess",value:function(){return!this.logs.some(function(e){return"error"===e.level})}},{key:"connect",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.room.state!==Bc.Connected){e.next=2;break}return e.abrupt("return",this.room);case 2:return e.next=4,this.room.connect(this.url,this.token);case 4:return e.abrupt("return",this.room);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.room||this.room.state===Bc.Disconnected){e.next=5;break}return e.next=3,this.room.disconnect();case 3:return e.next=5,new Promise(function(e){return setTimeout(e,500)});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"skip",value:function(){this.setStatus(Fc.SKIPPED)}},{key:"appendMessage",value:function(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}},{key:"appendWarning",value:function(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}},{key:"appendError",value:function(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}},{key:"setStatus",value:function(e){this.status=e,this.emit("update",this.getInfo())}},{key:"engine",get:function(){var e;return null===(e=this.room)||void 0===e?void 0:e.engine}},{key:"getInfo",value:function(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}]),n}(),Xc=function(e){p(n,Yc);var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n,[{key:"description",get:function(){return"Can publish audio"}},{key:"perform",value:function(){var e=l(a().mark(function e(){var t,n,r,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect();case 2:return n=e.sent,e.next=5,zc();case 5:return r=e.sent,n.localParticipant.publishTrack(r),e.next=9,new Promise(function(e){return setTimeout(e,3e3)});case 9:return e.next=11,null===(t=r.sender)||void 0===t?void 0:t.getStats();case 11:if(i=e.sent){e.next=14;break}throw new Error("Could not get RTCStats");case 14:if(o=0,i.forEach(function(e){"outbound-rtp"===e.type&&"audio"===e.mediaType&&(o=e.packetsSent)}),0!==o){e.next=18;break}throw new Error("Could not determine packets are sent");case 18:this.appendMessage("published ".concat(o," audio packets"));case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(),eu=function(e){p(n,Yc);var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n,[{key:"description",get:function(){return"Can publish video"}},{key:"perform",value:function(){var e=l(a().mark(function e(){var t,n,r,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect();case 2:return n=e.sent,e.next=5,Gc();case 5:return r=e.sent,n.localParticipant.publishTrack(r),e.next=9,new Promise(function(e){return setTimeout(e,3e3)});case 9:return e.next=11,null===(t=r.sender)||void 0===t?void 0:t.getStats();case 11:if(i=e.sent){e.next=14;break}throw new Error("Could not get RTCStats");case 14:if(o=0,i.forEach(function(e){"outbound-rtp"===e.type&&"video"===e.mediaType&&(o=e.packetsSent)}),0!==o){e.next=18;break}throw new Error("Could not determine packets are sent");case 18:this.appendMessage("published ".concat(o," video packets"));case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(),tu=function(e){p(n,Yc);var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n,[{key:"description",get:function(){return"Resuming connection after interruption"}},{key:"perform",value:function(){var e=l(a().mark(function e(){var t,n,r,i,o,s,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect();case 2:return n=e.sent,r=!1,i=!1,s=new Promise(function(e){setTimeout(e,5e3),o=e}),n.on($a.Reconnecting,function(){r=!0}).on($a.Reconnected,function(){i=!0,o(!0)}),null===(t=n.engine.client.ws)||void 0===t||t.close(),(c=n.engine.client.onClose)&&c(""),e.next=12,s;case 12:if(r){e.next=16;break}throw new Error("Did not attempt to reconnect");case 16:if(i&&n.state===Bc.Connected){e.next=19;break}throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect");case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(),nu=function(e){p(n,Yc);var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n,[{key:"description",get:function(){return"Can connect via TURN"}},{key:"perform",value:function(){var e=l(a().mark(function e(){var t,n,r,i,o,s,c,u,d,l,p,f,h;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new ac,e.next=3,r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0});case 3:i=e.sent,o=!1,s=!1,c=!1,u=D(i.iceServers);try{for(u.s();!(d=u.n()).done;){l=d.value,p=D(l.urls);try{for(p.s();!(f=p.n()).done;)(h=f.value).startsWith("turn:")?(s=!0,c=!0):h.startsWith("turns:")&&(s=!0,c=!0,o=!0),h.startsWith("stun:")&&(c=!0)}catch(a){p.e(a)}finally{p.f()}}}catch(a){u.e(a)}finally{u.f()}if(c?s&&!o&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),r.close(),!((null===(n=null===(t=this.connectOptions)||void 0===t?void 0:t.rtcConfig)||void 0===n?void 0:n.iceServers)||s)){e.next=16;break}return e.next=14,this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}});case 14:e.next=20;break;case 16:return this.appendWarning("No TURN servers configured."),this.skip(),e.next=20,new Promise(function(e){return setTimeout(e,0)});case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(),ru=function(e){p(n,Yc);var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n,[{key:"description",get:function(){return"Establishing WebRTC connection"}},{key:"perform",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("initiating room connection"),e.next=4,this.connect();case 4:this.room=e.sent,console.log("now the room is connected"),e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),this.appendWarning("ports need to be open on firewall in order to connect."),e.t0;case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()}]),n}(),iu=function(e){p(n,Yc);var t=f(n);function n(){return x(this,n),t.apply(this,arguments)}return O(n,[{key:"description",get:function(){return"Connecting to signal connection via WebSocket"}},{key:"perform",value:function(){var e=l(a().mark(function e(){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it"),t=new ac,e.next=4,t.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0});case 4:n=e.sent,this.appendMessage("Connected to server, version ".concat(n.serverVersion,".")),t.close();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}(),au=function(e){p(n,Uo.exports);var t=f(n);function n(e,r){var i;return x(this,n),(i=t.call(this)).checkResults=new Map,i.url=e,i.token=r,i}return O(n,[{key:"getNextCheckId",value:function(){var e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Fc.IDLE,name:"",description:""}),e}},{key:"updateCheck",value:function(e,t){this.checkResults.set(e,t),this.emit("checkUpdate",e,t)}},{key:"isSuccess",value:function(){return Array.from(this.checkResults.values()).every(function(e){return e.status!==Fc.FAILED})}},{key:"getResults",value:function(){return Array.from(this.checkResults.values())}},{key:"createAndRunCheck",value:function(){var e=l(a().mark(function e(t){var n,r,i,o,s=this;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getNextCheckId(),r=new t(this.url,this.token),i=function(e){s.updateCheck(n,e)},r.on("update",i),e.next=6,r.run();case 6:return o=e.sent,r.off("update",i),e.abrupt("return",o);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"checkWebsocket",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createAndRunCheck(iu));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkWebRTC",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createAndRunCheck(ru));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkTURN",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createAndRunCheck(nu));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkReconnect",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createAndRunCheck(tu));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkPublishAudio",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createAndRunCheck(Xc));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"checkPublishVideo",value:function(){var e=l(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createAndRunCheck(eu));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),n}();exports.ConnectionCheck=au;
},{"buffer":"aMB2"}],"B6dB":[function(require,module,exports) {
"use strict";var t,e,n=require("livekit-client");function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=i(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){u=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(u)throw a}}}}function o(t){return u(t)||c(t)||i(t)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function u(t){if(Array.isArray(t))return s(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(){d=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(C){u=function(t,e,n){return t[e]=n}}function s(t,e,n,o){var a=e&&e.prototype instanceof p?e:p,i=Object.create(a.prototype),c=new P(o||[]);return r(i,"_invoke",{value:E(t,n,c)}),i}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(C){return{type:"throw",arg:C}}}t.wrap=s;var v={};function p(){}function h(){}function m(){}var y={};u(y,a,function(){return this});var b=Object.getPrototypeOf,g=b&&b(b(M([])));g&&g!==e&&n.call(g,a)&&(y=g);var w=m.prototype=p.prototype=Object.create(y);function k(t){["next","throw","return"].forEach(function(e){u(t,e,function(t){return this._invoke(e,t)})})}function S(t,e){var o;r(this,"_invoke",{value:function(r,a){function i(){return new e(function(o,i){!function r(o,a,i,c){var u=f(t[o],t,a);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==l(d)&&n.call(d,"__await")?e.resolve(d.__await).then(function(t){r("next",t,i,c)},function(t){r("throw",t,i,c)}):e.resolve(d).then(function(t){s.value=t,i(s)},function(t){return r("throw",t,i,c)})}c(u.arg)}(r,a,o,i)})}return o=o?o.then(i,i):i()}})}function E(t,e,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return R()}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var c=L(i,n);if(c){if(c===v)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function L(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=f(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,v;var a=o.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,v):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function M(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return h.prototype=m,r(w,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:h,configurable:!0}),h.displayName=u(m,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},k(S.prototype),u(S.prototype,i,function(){return this}),t.AsyncIterator=S,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new S(s(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},k(w),u(w,c,"Generator"),u(w,a,function(){return this}),u(w,"toString",function(){return"[object Generator]"}),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=M,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),x(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;x(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:M(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),v}},t}function f(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(s){return void n(s)}c.done?e(u):Promise.resolve(u).then(r,o)}function v(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(t){f(a,r,o,i,c,"next",t)}function c(t){f(a,r,o,i,c,"throw",t)}i(void 0)})}}var p,h,m=function(t){return document.getElementById(t)},y={isFrontFacing:!1,encoder:new TextEncoder,decoder:new TextDecoder,defaultDevices:new Map,bitrateInterval:void 0},b=new URLSearchParams(window.location.search),g=null!==(t=b.get("url"))&&void 0!==t?t:"ws://localhost:7880",w=null!==(e=b.get("token"))&&void 0!==e?e:"";function k(t,e){var n=new URLSearchParams({url:t,token:e});window.history.replaceState(null,"","".concat(window.location.pathname,"?").concat(n.toString()))}m("url").value=g,m("token").value=w;var S={connectWithFormInput:function(){var t=v(d().mark(function t(){var e,r,o,a,i,c,u,s,l,f;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=m("url").value,r=m("token").value,o=m("simulcast").checked,a=m("dynacast").checked,i=m("force-turn").checked,c=m("adaptive-stream").checked,u=m("publish-option").checked,s=m("preferred-codec").value,(0,n.setLogLevel)(n.LogLevel.debug),k(e,r),l={adaptiveStream:c,dynacast:a,publishDefaults:{simulcast:o,videoSimulcastLayers:[n.VideoPresets.h90,n.VideoPresets.h216],videoCodec:s||"vp8"},videoCaptureDefaults:{resolution:n.VideoPresets.h720.resolution}},f={autoSubscribe:!0},i&&(f.rtcConfig={iceTransportPolicy:"relay"}),t.next=15,S.connectToRoom(e,r,l,f,u);case 15:y.bitrateInterval=setInterval(C,1e3);case 16:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),connectToRoom:function(){var t=v(d().mark(function t(e,r,o,a,i){var c,u,s,l;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c=new n.Room(o),h=Date.now(),t.next=4,c.prepareConnection(e);case 4:return u=Date.now()-h,P("prewarmed connection in ".concat(u,"ms")),c.on(n.RoomEvent.ParticipantConnected,L).on(n.RoomEvent.ParticipantDisconnected,T).on(n.RoomEvent.DataReceived,E).on(n.RoomEvent.Disconnected,x).on(n.RoomEvent.Reconnecting,function(){return P("Reconnecting to room")}).on(n.RoomEvent.Reconnected,function(){P("Successfully reconnected. server",c.engine.connectedServerAddress)}).on(n.RoomEvent.LocalTrackPublished,function(){M(c.localParticipant),V(),R(c)}).on(n.RoomEvent.LocalTrackUnpublished,function(){M(c.localParticipant),V(),R(c)}).on(n.RoomEvent.RoomMetadataChanged,function(t){P("new metadata for room",t)}).on(n.RoomEvent.MediaDevicesChanged,O).on(n.RoomEvent.AudioPlaybackStatusChanged,function(){var t,e;c.canPlaybackAudio?null===(t=m("start-audio-button"))||void 0===t||t.setAttribute("disabled","true"):null===(e=m("start-audio-button"))||void 0===e||e.removeAttribute("disabled")}).on(n.RoomEvent.MediaDevicesError,function(t){P("media device failure",n.MediaDeviceFailure.getFailure(t))}).on(n.RoomEvent.ConnectionQualityChanged,function(t,e){P("connection quality changed",null==e?void 0:e.identity,t)}).on(n.RoomEvent.TrackSubscribed,function(t,e,n){P("subscribed to track",e.trackSid,n.identity),M(n),R(c)}).on(n.RoomEvent.TrackUnsubscribed,function(t,e,n){P("unsubscribed from track",e.trackSid),M(n),R(c)}).on(n.RoomEvent.SignalConnected,v(d().mark(function t(){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Date.now()-h,P("signal connection established in ".concat(e,"ms")),!i){t.next=6;break}return t.next=5,Promise.all([c.localParticipant.setCameraEnabled(!0),c.localParticipant.setMicrophoneEnabled(!0)]);case 5:V();case 6:case"end":return t.stop()}},t)}))),t.prev=7,t.next=10,c.connect(e,r,a);case 10:s=Date.now()-h,P("successfully connected to ".concat(c.name," in ").concat(Math.round(s),"ms"),c.engine.connectedServerAddress),t.next=20;break;case 14:return t.prev=14,t.t0=t.catch(7),l=t.t0,t.t0.message&&(l=t.t0.message),P("could not connect:",l),t.abrupt("return");case 20:return p=c,window.currentRoom=c,H(!0),c.participants.forEach(function(t){L(t)}),L(c.localParticipant),t.abrupt("return",c);case 26:case"end":return t.stop()}},t,null,[[7,14]])}));return function(e,n,r,o,a){return t.apply(this,arguments)}}(),toggleAudio:function(){var t=v(d().mark(function t(){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p){t.next=2;break}return t.abrupt("return");case 2:return e=p.localParticipant.isMicrophoneEnabled,j("toggle-audio-button",!0),P(e?"disabling audio":"enabling audio"),t.next=7,p.localParticipant.setMicrophoneEnabled(!e);case 7:j("toggle-audio-button",!1),V();case 9:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),toggleVideo:function(){var t=v(d().mark(function t(){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p){t.next=2;break}return t.abrupt("return");case 2:return j("toggle-video-button",!0),P((e=p.localParticipant.isCameraEnabled)?"disabling video":"enabling video"),t.next=7,p.localParticipant.setCameraEnabled(!e);case 7:j("toggle-video-button",!1),M(p.localParticipant),V();case 10:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),flipVideo:function(){var t,e,r=null===(t=p)||void 0===t?void 0:t.localParticipant.getTrack(n.Track.Source.Camera);if(r){y.isFrontFacing?D("flip-video-button","Front Camera",!1):D("flip-video-button","Back Camera",!1),y.isFrontFacing=!y.isFrontFacing;var o={resolution:n.VideoPresets.h720.resolution,facingMode:y.isFrontFacing?"user":"environment"};null===(e=r.videoTrack)||void 0===e||e.restartTrack(o)}},shareScreen:function(){var t=v(d().mark(function t(){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(p){t.next=2;break}return t.abrupt("return");case 2:return e=p.localParticipant.isScreenShareEnabled,P("".concat(e?"stopping":"starting"," screen share")),j("share-screen-button",!0),t.next=7,p.localParticipant.setScreenShareEnabled(!e,{audio:!0});case 7:j("share-screen-button",!1),V();case 9:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),startAudio:function(){var t;null===(t=p)||void 0===t||t.startAudio()},enterText:function(){if(p){var t=m("entry");if(t.value){var e=y.encoder.encode(t.value);p.localParticipant.publishData(e,n.DataPacket_Kind.RELIABLE),m("chat").value+="".concat(p.localParticipant.identity," (me): ").concat(t.value,"\n"),t.value=""}}},disconnectRoom:function(){p&&p.disconnect(),y.bitrateInterval&&clearInterval(y.bitrateInterval)},handleScenario:function(t){var e,n=t.target.value;if("subscribe-all"===n)null===(e=p)||void 0===e||e.participants.forEach(function(t){t.tracks.forEach(function(t){return t.setSubscribed(!0)})});else if("unsubscribe-all"===n){var r;null===(r=p)||void 0===r||r.participants.forEach(function(t){t.tracks.forEach(function(t){return t.setSubscribed(!1)})})}else if(""!==n){var o;null===(o=p)||void 0===o||o.simulateScenario(n),t.target.value=""}},handleDeviceSelected:function(){var t=v(d().mark(function t(e){var n,r,o;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.target.value,r=e.target.id,o=I[r]){t.next=5;break}return t.abrupt("return");case 5:if(y.defaultDevices.set(o,n),!p){t.next=9;break}return t.next=9,p.switchActiveDevice(o,n);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),handlePreferredQuality:function(t){var e=t.target.value,r=n.VideoQuality.HIGH;switch(e){case"low":r=n.VideoQuality.LOW;break;case"medium":r=n.VideoQuality.MEDIUM;break;case"high":r=n.VideoQuality.HIGH}p&&p.participants.forEach(function(t){t.tracks.forEach(function(t){t.setVideoQuality(r)})})},handlePreferredFPS:function(t){var e=+t.target.value;p&&p.participants.forEach(function(t){t.tracks.forEach(function(t){t.setVideoFPS(e)})})}};function E(t,e){var n=y.decoder.decode(t),r=m("chat"),o="server";e&&(o=e.identity),r.value+="".concat(o,": ").concat(n,"\n")}function L(t){P("participant",t.identity,"connected",t.metadata),t.on(n.ParticipantEvent.TrackMuted,function(e){P("track was muted",e.trackSid,t.identity),M(t)}).on(n.ParticipantEvent.TrackUnmuted,function(e){P("track was unmuted",e.trackSid,t.identity),M(t)}).on(n.ParticipantEvent.IsSpeakingChanged,function(){M(t)}).on(n.ParticipantEvent.ConnectionQualityChanged,function(){M(t)})}function T(t){P("participant",t.sid,"disconnected"),M(t,!0)}function x(t){if(p){P("disconnected from room",{reason:t}),H(!1),M(p.localParticipant,!0),p.participants.forEach(function(t){M(t,!0)}),R(p);var e=m("participants-area");e&&(e.innerHTML=""),m("chat").value="",p=void 0,window.currentRoom=void 0}}function P(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=m("log"),o=0;o<arguments.length;o+=1)"object"===l(e[o])?r.innerHTML+="".concat(JSON&&JSON.stringify?JSON.stringify(e[o],void 0,2):e[o]," "):r.innerHTML+="".concat(e[o]," ");r.innerHTML+="\n",r.scrollTop=r.scrollHeight}function M(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=m("participants-area");if(r){var o=t.identity,a=m("participant-".concat(o));if(!a&&!e){(a=document.createElement("div")).id="participant-".concat(o),a.className="participant",a.innerHTML='\n      <video id="video-'.concat(o,'"></video>\n      <audio id="audio-').concat(o,'"></audio>\n      <div class="info-bar">\n        <div id="name-').concat(o,'" class="name">\n        </div>\n        <div style="text-align: center;">\n          <span id="codec-').concat(o,'" class="codec">\n          </span>\n          <span id="size-').concat(o,'" class="size">\n          </span>\n          <span id="bitrate-').concat(o,'" class="bitrate">\n          </span>\n        </div>\n        <div class="right">\n          <span id="signal-').concat(o,'"></span>\n          <span id="mic-').concat(o,'" class="mic-on"></span>\n        </div>\n      </div>\n      ').concat(t instanceof n.RemoteParticipant&&'<div class="volume-control">\n        <input id="volume-'.concat(o,'" type="range" min="0" max="1" step="0.1" value="1" orient="vertical" />\n      </div>'),"\n\n    "),r.appendChild(a);var i=m("size-".concat(o)),c=m("video-".concat(o));c.onresize=function(){A(c,i)}}var u,s=m("video-".concat(o)),l=m("audio-".concat(o));if(e)return null===(u=a)||void 0===u||u.remove(),s&&(s.srcObject=null,s.src=""),void(l&&(l.srcObject=null,l.src=""));m("name-".concat(o)).innerHTML=t.identity,t instanceof n.LocalParticipant&&(m("name-".concat(o)).innerHTML+=" (you)");var d=m("mic-".concat(o)),f=m("signal-".concat(o)),v=t.getTrack(n.Track.Source.Camera),p=t.getTrack(n.Track.Source.Microphone);if(t.isSpeaking?a.classList.add("speaking"):a.classList.remove("speaking"),t instanceof n.RemoteParticipant)m("volume-".concat(o)).addEventListener("input",function(e){t.setVolume(Number.parseFloat(e.target.value))});if(v&&v.isSubscribed&&!v.isMuted){var y,b;if(t instanceof n.LocalParticipant)s.style.transform="scale(-1, 1)";else if(null==v||null===(y=v.videoTrack)||void 0===y||!y.attachedElements.includes(s)){var g=Date.now();s.onloadeddata=function(){var e=Date.now()-g,n=0;t.joinedAt&&t.joinedAt.getTime()<h&&(n=Date.now()-h),P("RemoteVideoTrack ".concat(null==v?void 0:v.trackSid," (").concat(s.videoWidth,"x").concat(s.videoHeight,") rendered in ").concat(e,"ms"),n>0?", ".concat(n,"ms from start"):"")}}null==v||null===(b=v.videoTrack)||void 0===b||b.attach(s)}else{var w;if(m("size-".concat(o)).innerHTML="",null!=v&&v.videoTrack)null===(w=v.videoTrack)||void 0===w||w.detach(s);else s.src="",s.srcObject=null}if(p&&p.isSubscribed&&!p.isMuted){var k;if(!(t instanceof n.LocalParticipant))l.onloadeddata=function(){if(t.joinedAt&&t.joinedAt.getTime()<h){var e=Date.now()-h;P("RemoteAudioTrack ".concat(null==p?void 0:p.trackSid," played ").concat(e,"ms from start"))}},null==p||null===(k=p.audioTrack)||void 0===k||k.attach(l);d.className="mic-on",d.innerHTML='<i class="fas fa-microphone"></i>'}else d.className="mic-off",d.innerHTML='<i class="fas fa-microphone-slash"></i>';switch(t.connectionQuality){case n.ConnectionQuality.Excellent:case n.ConnectionQuality.Good:case n.ConnectionQuality.Poor:f.className="connection-".concat(t.connectionQuality),f.innerHTML='<i class="fas fa-circle"></i>';break;default:f.innerHTML=""}}}function R(t){var e=m("screenshare-area");if(t.state===n.ConnectionState.Connected){var r,o,a=t.localParticipant.getTrack(n.Track.Source.ScreenShare);if(a?r=t.localParticipant:t.participants.forEach(function(t){if(!a){r=t;var e=t.getTrack(n.Track.Source.ScreenShare);null!=e&&e.isSubscribed&&(a=e);var i=t.getTrack(n.Track.Source.ScreenShareAudio);null!=i&&i.isSubscribed&&(o=i)}}),a&&r){var i;e.style.display="block";var c,u=m("screenshare-video");if(null===(i=a.videoTrack)||void 0===i||i.attach(u),o)null===(c=o.audioTrack)||void 0===c||c.attach(u);u.onresize=function(){A(u,m("screenshare-resolution"))},m("screenshare-info").innerHTML="Screenshare from ".concat(r.identity)}else e.style.display="none"}else e.style.display="none"}function C(){if(p&&p.state===n.ConnectionState.Connected){var t=o(p.participants.values());t.push(p.localParticipant);var e,a=r(t);try{for(a.s();!(e=a.n()).done;){var i,c=e.value,u=m("bitrate-".concat(c.identity)),s=0,l=r(c.tracks.values());try{for(l.s();!(i=l.n()).done;){var d,f=i.value;if(f.track&&(s+=f.track.currentBitrate),f.source===n.Track.Source.Camera)if(f.videoTrack instanceof n.RemoteVideoTrack)m("codec-".concat(c.identity)).innerHTML=null!==(d=f.videoTrack.getDecoderImplementation())&&void 0!==d?d:""}}catch(h){l.e(h)}finally{l.f()}var v="";s>0&&(v="".concat(Math.round(s/1024).toLocaleString()," kbps")),u&&(u.innerHTML=v)}}catch(h){a.e(h)}finally{a.f()}}}function A(t,e){e.innerHTML="(".concat(t.videoWidth,"x").concat(t.videoHeight,")")}function D(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=m(t);o&&(void 0!==r&&(o.disabled=r),o.innerHTML=e,n?o.classList.add("active"):o.classList.remove("active"))}function j(t,e){m(t).disabled=e}function H(t){var e=["toggle-video-button","toggle-audio-button","share-screen-button","disconnect-ws-button","disconnect-room-button","flip-video-button","send-button"],n=["connect-button"],r=t?n:e;(t?e:n).forEach(function(t){var e;return null===(e=m(t))||void 0===e?void 0:e.removeAttribute("disabled")}),r.forEach(function(t){var e;return null===(e=m(t))||void 0===e?void 0:e.setAttribute("disabled","true")})}window.appActions=S,setTimeout(O,100);var I={"video-input":"videoinput","audio-input":"audioinput","audio-output":"audiooutput"};function O(){return F.apply(this,arguments)}function F(){return(F=v(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Promise.all(Object.keys(I).map(function(){var t=v(d().mark(function t(e){var r,o;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=I[e]){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,n.Room.getLocalDevices(r);case 5:o=t.sent,N(m(e),o,y.defaultDevices.get(r));case 8:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}function N(t,e,n){t.innerHTML="";var o,a=r(e);try{for(a.s();!(o=a.n()).done;){var i=o.value,c=document.createElement("option");c.text=i.label,c.value=i.deviceId,i.deviceId===n&&(c.selected=!0),t.appendChild(c)}}catch(u){a.e(u)}finally{a.f()}}function V(){if(p){var t=p.localParticipant;D("toggle-video-button","".concat(t.isCameraEnabled?"Disable":"Enable"," Video"),t.isCameraEnabled),D("toggle-audio-button","".concat(t.isMicrophoneEnabled?"Disable":"Enable"," Audio"),t.isMicrophoneEnabled),D("share-screen-button",t.isScreenShareEnabled?"Stop Screen Share":"Share Screen",t.isScreenShareEnabled)}}function _(){return Q.apply(this,arguments)}function Q(){return(Q=v(d().mark(function t(){return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:O();case 1:case"end":return t.stop()}},t)}))).apply(this,arguments)}_();
},{"livekit-client":"gvqF"}]},{},["B6dB"], null)
//# sourceMappingURL=/csb-giidd0/src.62b5b0f5.js.map